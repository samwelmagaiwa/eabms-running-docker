"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[5830],{1127:function(e,r,s){s.d(r,{h:function(){return i}});s(4114);var t=s(5796),o=s(1387),a=s(14),n=s(9553);function i(){const e=(0,o.rd)(),r=(0,a.useAuthStore)(),i=(0,t.EW)(()=>r.user),u=(0,t.EW)(()=>r.token),c=(0,t.EW)(()=>r.isAuthenticated),l=(0,t.EW)(()=>r.userPermissions),d=(0,t.EW)(()=>r.userRole),g=(0,t.EW)(()=>r.userRoles),h=(0,t.EW)(()=>r.isLoading),f=(0,t.EW)(()=>r.error),m=(0,t.EW)(()=>r.isAdmin),b=(0,t.EW)(()=>r.isStaff),p=(0,t.EW)(()=>r.isApprover),E=(0,t.EW)(()=>i.value?.name||"User"),A=async t=>{try{const{authService:o}=await s.e(981).then(s.bind(s,981)),a=await o.login(t);if(a.success){const{user:s,token:t}=a.data;r.setAuthData({user:s,token:t});let o=(0,n.getDefaultDashboard)(r.userRole)||"/user-dashboard";s?.needs_onboarding&&"admin"!==r.userRole&&(o="/onboarding");const i=e.currentRoute.value.query.redirect;return i&&"string"===typeof i&&(o=i),await e.push(o),{success:!0,user:s}}{let e=a.message||"Login failed";if(a.errors&&"object"===typeof a.errors){const r=["email","password"];for(const s of r){const r=a.errors[s];if(Array.isArray(r)&&r.length>0){e=r[0];break}}}return console.error("❌ Login failed:",e),r.setError(e),{success:!1,message:e}}}catch(f){return console.error("❌ Login error in composable:",f),r.setError(f.message||"Login failed"),{success:!1,message:f.message||"Login failed"}}},k=async()=>{try{const{authService:t}=await s.e(981).then(s.bind(s,981));return await t.logout(),r.clearAuth(),await e.push("/login"),{success:!0}}catch(f){return r.clearAuth(),await e.push("/login"),{success:!0}}},w=async()=>{try{const{authService:t}=await s.e(981).then(s.bind(s,981)),o=await t.logoutAll();return r.clearAuth(),await e.push("/login"),o.success?o:{success:!0}}catch(f){return r.clearAuth(),await e.push("/login"),{success:!0}}},x=e=>{r.updateUser(e)},y=()=>{r.clearError()},R=e=>r.hasPermission(e),v=e=>r.hasRole(e),L=e=>!e.meta?.roles||v(e.meta.roles),D=e=>{if(!v(e)){const r=Array.isArray(e)?e.join(", "):e;throw new Error(`Access denied. Required role(s): ${r}`)}},I=e=>{if(!e)return"User";const r={[n.gg.ADMIN]:"Administrator",[n.gg.DIVISIONAL_DIRECTOR]:"Divisional Director",[n.gg.HEAD_OF_DEPARTMENT]:"Head of Department",[n.gg.ICT_DIRECTOR]:"ICT Director",[n.gg.HEAD_OF_IT]:"Head of IT",[n.gg.STAFF]:"D. IN MEDICINE",[n.gg.ICT_OFFICER]:"ICT Officer",[n.gg.SECRETARY_ICT]:"Secretary ICT"};return r[e]||e};return{user:i,userName:E,token:u,isAuthenticated:c,userPermissions:l,userRole:d,userRoles:g,isLoading:h,error:f,isAdmin:m,isStaff:b,isApprover:p,login:A,logout:k,logoutAll:w,updateUser:x,clearError:y,hasPermission:R,hasRole:v,canAccessRoute:L,requireRole:D,getRoleDisplayName:I,ROLES:n.gg}}},5830:function(e,r,s){s.r(r),s.d(r,{default:function(){return m}});var t=s(5796);const o={class:"min-h-screen bg-blue-900 flex items-center justify-center p-4"},a={class:"w-full max-w-2xl"},n={class:"bg-blue-800/40 border border-blue-400/40 rounded-2xl p-8 text-center shadow-2xl"},i={class:"flex flex-wrap gap-3 justify-center"};function u(e,r,s,u,c,l){return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.Lk)("div",a,[(0,t.Lk)("div",n,[r[4]||(r[4]=(0,t.Lk)("div",{class:"mb-4"},[(0,t.Lk)("i",{class:"fas fa-exclamation-triangle text-5xl text-yellow-400"})],-1)),r[5]||(r[5]=(0,t.Lk)("h1",{class:"text-3xl md:text-4xl font-extrabold text-white mb-2"},"Unable to Load Page",-1)),r[6]||(r[6]=(0,t.Lk)("p",{class:"text-blue-200 text-base md:text-lg mb-6"}," The requested page could not be found. It may have been moved or the URL is incorrect. ",-1)),(0,t.Lk)("div",i,[(0,t.Lk)("button",{onClick:r[0]||(r[0]=(...e)=>u.goBack&&u.goBack(...e)),class:"px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold"},[...r[2]||(r[2]=[(0,t.Lk)("i",{class:"fas fa-undo mr-2"},null,-1),(0,t.eW)(" Retry/Back ",-1)])]),(0,t.Lk)("button",{onClick:r[1]||(r[1]=(...e)=>u.goHome&&u.goHome(...e)),class:"px-5 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold"},[...r[3]||(r[3]=[(0,t.Lk)("i",{class:"fas fa-home mr-2"},null,-1),(0,t.eW)(" Back to Dashboard ",-1)])])])])])])}s(4114);var c=s(1387),l=s(1127),d=s(9553),g={name:"NotFound",setup(){const e=(0,c.rd)(),{userRole:r}=(0,l.h)(),s=()=>{window.history.length>1?e.go(-1):t()},t=()=>{const s=(0,d.getDefaultDashboard)(r.value);s?e.push(s):e.push("/")};return{goBack:s,goHome:t}}},h=s(1241);const f=(0,h.A)(g,[["render",u]]);var m=f}}]);
//# sourceMappingURL=5830.1763320c.js.map