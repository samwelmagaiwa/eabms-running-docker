"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[4710,6156],{1468:function(e,t,s){s.r(t),s.d(t,{default:function(){return ht}});var a=s(5796);const r={class:"flex flex-col h-screen"},l={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-2 overflow-y-auto relative bg-blue-900",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"}},i={class:"absolute inset-0 overflow-hidden"},n={class:"absolute inset-0 opacity-5"},d={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},c={class:"max-w-full mx-auto relative z-10 px-4"},u={class:"medical-glass-card rounded-t-3xl p-6 mb-0 border-b border-blue-300/30"},p={class:"flex items-center justify-between"},m={class:"flex items-center"},b={class:"flex items-center space-x-4"},g=["disabled"],f={class:"medical-glass-card rounded-none border-t-0 border-b border-blue-300/30"},h={class:"p-4"},v={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},x={class:"flex-1 max-w-xl"},k={class:"relative"},y={class:"flex flex-wrap gap-3 items-center"},w={class:"relative"},L={class:"relative"},_={class:"relative"},R={key:0,class:"mt-3 flex flex-wrap gap-2"},q={key:0,class:"inline-flex items-center px-2 py-1 bg-green-600/30 text-green-200 text-base rounded-md border border-green-400/30 font-medium"},C={key:1,class:"inline-flex items-center px-2 py-1 bg-blue-600/30 text-blue-200 text-sm rounded-md border border-blue-400/30"},S={key:2,class:"inline-flex items-center px-2 py-1 bg-purple-600/30 text-purple-200 text-sm rounded-md border border-purple-400/30"},D={key:3,class:"inline-flex items-center px-2 py-1 bg-yellow-600/30 text-yellow-200 text-sm rounded-md border border-yellow-400/30"},A={key:0,class:"medical-glass-card rounded-none border-t-0 border-b border-blue-300/30"},E={class:"px-4 py-2 bg-blue-600/10"},F={class:"flex items-center justify-between text-lg"},T={class:"text-blue-300 font-medium"},I={key:0,class:"text-yellow-300 ml-2"},X={key:0,class:"text-blue-300 font-medium"},j={class:"medical-glass-card rounded-b-3xl overflow-hidden"},P={class:"p-6"},W={key:0,class:"text-center py-12"},M={key:1,class:"text-center py-12"},Q={key:2,class:"text-center py-12"},U={key:3,class:"overflow-hidden rounded-xl border border-blue-300/20"},N={class:"overflow-x-auto"},$={class:"w-full"},H={class:"divide-y divide-blue-300/10"},K={class:"px-6 py-4 whitespace-nowrap"},O={class:"flex items-center"},V={class:"text-base font-medium text-white"},B={class:"px-6 py-4"},z={class:"text-lg font-medium text-white"},G={class:"text-base text-blue-300"},J={class:"px-6 py-4"},Y={class:"flex flex-wrap gap-1"},Z={class:"px-6 py-4 whitespace-nowrap"},ee={class:"px-6 py-4 whitespace-nowrap text-lg text-gray-300 font-medium"},te={class:"px-6 py-4 whitespace-nowrap text-center"},se={key:0,class:"inline-flex items-center"},ae={key:1,class:"inline-flex items-center"},re={class:"px-6 py-4 whitespace-nowrap text-center"},le={class:"flex items-center justify-center space-x-2"},oe=["onClick","title"],ie=["onClick","title"],ne=["onClick","title"],de={key:4,class:"mt-8 flex justify-center"},ce={class:"flex items-center space-x-2"},ue=["disabled"],pe={class:"text-base text-white mx-4"},me=["disabled"],be={class:"flex items-center justify-between p-6 border-b border-blue-300/20"},ge={class:"flex items-center space-x-3"},fe={class:"text-xl font-bold text-white"},he={class:"text-sm text-blue-300"},ve={class:"p-6 space-y-6"},xe={class:"bg-blue-600/10 border border-blue-400/20 rounded-lg p-4"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},ye={class:"space-y-2"},we={class:"flex justify-between"},Le={class:"flex justify-between"},_e={class:"text-white font-medium"},Re={key:0,class:"flex justify-between"},qe={class:"text-white font-medium"},Ce={class:"space-y-2"},Se={class:"flex justify-between"},De={class:"text-white font-medium"},Ae={class:"flex justify-between"},Ee={class:"flex flex-wrap gap-1"},Fe={key:0,class:"bg-gradient-to-r from-teal-600/20 to-cyan-600/20 border border-teal-400/30 rounded-lg p-4"},Te={class:"flex items-start space-x-3"},Ie={class:"flex-1"},Xe={class:"flex items-center space-x-2 mb-3"},je={class:"text-sm text-teal-300"},Pe={class:"bg-teal-900/20 rounded-lg p-3 mb-3"},We={class:"text-white leading-relaxed whitespace-pre-line"},Me={class:"text-sm text-teal-300"},Qe={key:1,class:"bg-purple-600/10 border border-purple-400/20 rounded-lg p-4"},Ue={class:"space-y-3"},Ne={key:0,class:"space-y-2"},$e={class:"flex flex-wrap gap-2"},He={key:1,class:"space-y-2"},Ke={class:"flex flex-wrap gap-2"},Oe={key:2,class:"space-y-2"},Ve={class:"flex flex-wrap gap-2"},Be={class:"flex items-center justify-between p-6 border-b border-blue-300/20"},ze={class:"flex items-center space-x-3"},Ge={class:"text-sm text-green-300"},Je={class:"p-6 space-y-4"},Ye={key:0,class:"bg-green-600/20 border border-green-500/30 rounded-lg p-4"},Ze={class:"text-white text-base leading-relaxed"},et={key:0,class:"mt-2"},tt={class:"text-sm text-green-300"},st={class:"space-y-4"},at=["placeholder"],rt={class:"flex justify-end space-x-3 pt-4"},lt=["disabled"],ot={key:0,class:"fas fa-spinner fa-spin mr-2"},it={key:1,class:"fas fa-paper-plane mr-2"};function nt(e,t,s,nt,dt,ct){const ut=(0,a.g2)("Header"),pt=(0,a.g2)("ModernSidebar"),mt=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(ut),(0,a.Lk)("div",l,[(0,a.bF)(pt),(0,a.Lk)("main",o,[(0,a.Lk)("div",i,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",p,[(0,a.Lk)("div",m,[(0,a.bF)(mt,{to:"/hod-dashboard",class:"mr-4 p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 transition-colors"},{default:(0,a.k6)(()=>[...t[28]||(t[28]=[(0,a.Lk)("i",{class:"fas fa-arrow-left text-blue-300 hover:text-white"},null,-1)])]),_:1}),t[29]||(t[29]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-3xl font-bold text-blue-100 tracking-wide drop-shadow-md"},[(0,a.Lk)("i",{class:"fas fa-comments text-blue-400 mr-3"}),(0,a.eW)(" Divisional Recommendations ")]),(0,a.Lk)("p",{class:"text-base text-teal-300 mt-1"}," Comments and suggestions from Divisional Directors ")],-1))]),(0,a.Lk)("div",b,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>nt.refreshRecommendations&&nt.refreshRecommendations(...e)),disabled:nt.loading,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-base font-medium"},[(0,a.Lk)("i",{class:(0,a.C4)(["fas fa-sync-alt mr-2",{"animate-spin":nt.loading}])},null,2),t[30]||(t[30]=(0,a.eW)(" Refresh ",-1))],8,g)])])]),(0,a.Lk)("div",f,[(0,a.Lk)("div",h,[(0,a.Lk)("div",v,[(0,a.Lk)("div",x,[(0,a.Lk)("div",k,[t[32]||(t[32]=(0,a.Lk)("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-search text-blue-300"})],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>nt.searchQuery=e),onInput:t[2]||(t[2]=(...e)=>nt.debouncedSearch&&nt.debouncedSearch(...e)),type:"text",placeholder:"Search by staff name, PF number, or request ID...",class:"w-full pl-10 pr-4 py-2.5 bg-white/10 border border-blue-300/30 rounded-lg focus:border-blue-400 focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-colors text-base"},null,544),[[a.Jo,nt.searchQuery]]),nt.searchQuery?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[3]||(t[3]=(...e)=>nt.clearSearch&&nt.clearSearch(...e)),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-blue-300 hover:text-white"},[...t[31]||(t[31]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",y,[(0,a.Lk)("div",w,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>nt.statusFilter=e),onChange:t[5]||(t[5]=(...e)=>nt.applyFilters&&nt.applyFilters(...e)),class:"appearance-none bg-white/10 border border-blue-300/30 rounded-lg px-4 py-2.5 pr-10 text-white text-base focus:border-blue-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[33]||(t[33]=[(0,a.Fv)('<option value="" class="bg-blue-900 text-white" data-v-0d0cb6db>All Statuses</option><option value="divisional_approved" class="bg-blue-900 text-white" data-v-0d0cb6db> Approved by Divisional </option><option value="divisional_rejected" class="bg-blue-900 text-white" data-v-0d0cb6db> Rejected by Divisional </option><option value="pending_ict_director" class="bg-blue-900 text-white" data-v-0d0cb6db> Under ICT Review </option><option value="dict_approved" class="bg-blue-900 text-white" data-v-0d0cb6db> Approved by ICT </option><option value="dict_rejected" class="bg-blue-900 text-white" data-v-0d0cb6db> Rejected by ICT </option><option value="rejected" class="bg-blue-900 text-white" data-v-0d0cb6db> Final Rejection </option>',7)])],544),[[a.u1,nt.statusFilter]]),t[34]||(t[34]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-blue-300"})],-1))]),(0,a.Lk)("div",L,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>nt.requestTypeFilter=e),onChange:t[7]||(t[7]=(...e)=>nt.applyFilters&&nt.applyFilters(...e)),class:"appearance-none bg-white/10 border border-blue-300/30 rounded-lg px-4 py-2.5 pr-10 text-white text-base focus:border-blue-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[35]||(t[35]=[(0,a.Lk)("option",{value:"",class:"bg-blue-900 text-white"},"All Request Types",-1),(0,a.Lk)("option",{value:"jeeva_access",class:"bg-blue-900 text-white"}," Jeeva Access ",-1),(0,a.Lk)("option",{value:"wellsoft",class:"bg-blue-900 text-white"},"Wellsoft",-1),(0,a.Lk)("option",{value:"internet_access_request",class:"bg-blue-900 text-white"}," Internet Access ",-1)])],544),[[a.u1,nt.requestTypeFilter]]),t[36]||(t[36]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-blue-300"})],-1))]),(0,a.Lk)("div",_,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>nt.commentsFilter=e),onChange:t[9]||(t[9]=(...e)=>nt.applyFilters&&nt.applyFilters(...e)),class:"appearance-none bg-white/10 border border-blue-300/30 rounded-lg px-4 py-2.5 pr-10 text-white text-base focus:border-blue-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[37]||(t[37]=[(0,a.Lk)("option",{value:"",class:"bg-blue-900 text-white"},"All Requests",-1),(0,a.Lk)("option",{value:"with_comments",class:"bg-blue-900 text-white"}," With Comments ",-1),(0,a.Lk)("option",{value:"without_comments",class:"bg-blue-900 text-white"}," Without Comments ",-1)])],544),[[a.u1,nt.commentsFilter]]),t[38]||(t[38]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-blue-300"})],-1))]),nt.hasActiveFilters?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[10]||(t[10]=(...e)=>nt.clearAllFilters&&nt.clearAllFilters(...e)),class:"px-3 py-2.5 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors border border-red-400/30 text-base flex items-center font-medium",title:"Clear all filters"},[...t[39]||(t[39]=[(0,a.Lk)("i",{class:"fas fa-times mr-1"},null,-1),(0,a.eW)(" Clear ",-1)])])):(0,a.Q3)("",!0)])]),nt.hasActiveFilters?((0,a.uX)(),(0,a.CE)("div",R,[t[44]||(t[44]=(0,a.Lk)("span",{class:"text-base text-blue-300 mr-2 font-medium"},"Active filters:",-1)),nt.statusFilter?((0,a.uX)(),(0,a.CE)("span",q,[(0,a.eW)(" Status: "+(0,a.v_)(nt.getStatusLabel(nt.statusFilter))+" ",1),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>nt.clearStatusFilter&&nt.clearStatusFilter(...e)),class:"ml-1 text-green-300 hover:text-white"},[...t[40]||(t[40]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0),nt.requestTypeFilter?((0,a.uX)(),(0,a.CE)("span",C,[(0,a.eW)(" Type: "+(0,a.v_)(nt.getRequestTypeLabel(nt.requestTypeFilter))+" ",1),(0,a.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>nt.clearRequestTypeFilter&&nt.clearRequestTypeFilter(...e)),class:"ml-1 text-blue-300 hover:text-white"},[...t[41]||(t[41]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0),nt.commentsFilter?((0,a.uX)(),(0,a.CE)("span",S,[(0,a.eW)(" Comments: "+(0,a.v_)("with_comments"===nt.commentsFilter?"With Comments":"Without Comments")+" ",1),(0,a.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>nt.clearCommentsFilter&&nt.clearCommentsFilter(...e)),class:"ml-1 text-purple-300 hover:text-white"},[...t[42]||(t[42]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0),nt.searchQuery?((0,a.uX)(),(0,a.CE)("span",D,[(0,a.eW)(' Search: "'+(0,a.v_)(nt.searchQuery)+'" ',1),(0,a.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>nt.clearSearch&&nt.clearSearch(...e)),class:"ml-1 text-yellow-300 hover:text-white"},[...t[43]||(t[43]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])]),nt.loading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",A,[(0,a.Lk)("div",E,[(0,a.Lk)("div",F,[(0,a.Lk)("div",T,[t[46]||(t[46]=(0,a.Lk)("i",{class:"fas fa-list-ul mr-1"},null,-1)),(0,a.eW)(" Showing "+(0,a.v_)(nt.filteredRecommendations.length)+" of "+(0,a.v_)(nt.totalRecommendations)+" recommendations ",1),nt.hasActiveFilters?((0,a.uX)(),(0,a.CE)("span",I,[...t[45]||(t[45]=[(0,a.Lk)("i",{class:"fas fa-filter mr-1"},null,-1),(0,a.eW)("Filtered ",-1)])])):(0,a.Q3)("",!0)]),nt.filteredRecommendations.length>0?((0,a.uX)(),(0,a.CE)("div",X,[...t[47]||(t[47]=[(0,a.Lk)("i",{class:"fas fa-sort mr-1"},null,-1),(0,a.eW)(" Sorted by date (newest first) ",-1)])])):(0,a.Q3)("",!0)])])])),(0,a.Lk)("div",j,[(0,a.Lk)("div",P,[nt.loading&&0===nt.recommendations.length?((0,a.uX)(),(0,a.CE)("div",W,[...t[48]||(t[48]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-400 mb-4"},null,-1),(0,a.Lk)("p",{class:"text-white text-xl font-medium"},"Loading divisional recommendations...",-1)])])):nt.loading||0!==nt.filteredRecommendations.length||nt.hasActiveFilters?!nt.loading&&0===nt.filteredRecommendations.length&&nt.hasActiveFilters?((0,a.uX)(),(0,a.CE)("div",Q,[t[54]||(t[54]=(0,a.Fv)('<div class="mb-6" data-v-0d0cb6db><i class="fas fa-search text-6xl text-gray-400 mb-4" data-v-0d0cb6db></i></div><h3 class="text-2xl font-semibold text-white mb-2" data-v-0d0cb6db>No Results Found</h3><p class="text-gray-300 max-w-md mx-auto mb-4 text-base" data-v-0d0cb6db> No recommendations match your current search and filter criteria. </p><div class="space-y-2" data-v-0d0cb6db><p class="text-base text-blue-300 font-medium" data-v-0d0cb6db>Try:</p><ul class="text-base text-gray-400 space-y-1 max-w-sm mx-auto" data-v-0d0cb6db><li data-v-0d0cb6db>â€¢ Clearing your search terms</li><li data-v-0d0cb6db>â€¢ Adjusting your filters</li><li data-v-0d0cb6db>â€¢ Checking different status options</li></ul></div>',4)),(0,a.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>nt.clearAllFilters&&nt.clearAllFilters(...e)),class:"mt-6 px-6 py-3 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors border border-red-400/30 text-base font-medium"},[...t[53]||(t[53]=[(0,a.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,a.eW)(" Clear All Filters ",-1)])])])):((0,a.uX)(),(0,a.CE)("div",U,[(0,a.Lk)("div",N,[(0,a.Lk)("table",$,[t[61]||(t[61]=(0,a.Lk)("thead",{class:"bg-gradient-to-r from-blue-600/20 to-indigo-600/20 border-b border-blue-300/20"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-hashtag mr-2"}),(0,a.eW)("Request ID ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-user mr-2"}),(0,a.eW)("Staff Details ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-layer-group mr-2"}),(0,a.eW)("Request Type ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,a.eW)("Status ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-calendar mr-2"}),(0,a.eW)("Date ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-comment mr-2"}),(0,a.eW)("Has Comments ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-center text-base font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-cogs mr-2"}),(0,a.eW)("Actions ")])])],-1)),(0,a.Lk)("tbody",H,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(nt.filteredRecommendations,(e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:(0,a.C4)(["hover:bg-blue-600/10 transition-colors duration-200",s%2===0?"bg-blue-950/20":"bg-blue-950/10"])},[(0,a.Lk)("td",K,[(0,a.Lk)("div",O,[t[55]||(t[55]=(0,a.Lk)("div",{class:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center mr-3"},[(0,a.Lk)("i",{class:"fas fa-file-alt text-white text-sm"})],-1)),(0,a.Lk)("div",V,(0,a.v_)(nt.formatRequestId(e.id)),1)])]),(0,a.Lk)("td",B,[(0,a.Lk)("div",z,(0,a.v_)(e.staff_name),1),(0,a.Lk)("div",G,(0,a.v_)(e.pf_number),1)]),(0,a.Lk)("td",J,[(0,a.Lk)("div",Y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.request_type,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"inline-flex px-2 py-1 text-base font-medium rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/20"},(0,a.v_)(nt.getRequestTypeLabel(e)),1))),128))])]),(0,a.Lk)("td",Z,[(0,a.Lk)("span",{class:(0,a.C4)(["inline-flex px-2 py-1 text-base font-medium rounded-md border",nt.getStatusClass(e.status)])},(0,a.v_)(nt.getStatusLabel(e.status)),3)]),(0,a.Lk)("td",ee,(0,a.v_)(nt.formatDate(e.divisional_approved_at||e.updated_at)),1),(0,a.Lk)("td",te,[e.divisional_director_comments?((0,a.uX)(),(0,a.CE)("div",se,[...t[56]||(t[56]=[(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full mr-2"},null,-1),(0,a.Lk)("span",{class:"text-sm text-green-400 font-medium"},"Yes",-1)])])):((0,a.uX)(),(0,a.CE)("div",ae,[...t[57]||(t[57]=[(0,a.Lk)("div",{class:"w-2 h-2 bg-gray-500 rounded-full mr-2"},null,-1),(0,a.Lk)("span",{class:"text-sm text-gray-400"},"No",-1)])]))]),(0,a.Lk)("td",re,[(0,a.Lk)("div",le,[(0,a.Lk)("button",{onClick:t=>nt.viewRequestDetails(e),class:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/30 hover:bg-blue-600/50 transition-colors duration-200",title:`View details for ${nt.formatRequestId(e.id)}`},[...t[58]||(t[58]=[(0,a.Lk)("i",{class:"fas fa-eye mr-1"},null,-1),(0,a.eW)(" View ",-1)])],8,oe),nt.canResubmitRequest(e.status)?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t=>nt.resubmitRequest(e.id),class:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-orange-600/30 text-orange-200 border border-orange-400/30 hover:bg-orange-600/50 transition-colors duration-200",title:`Resubmit ${nt.formatRequestId(e.id)}`},[...t[59]||(t[59]=[(0,a.Lk)("i",{class:"fas fa-redo mr-1"},null,-1),(0,a.eW)(" Resubmit ",-1)])],8,ie)):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t=>nt.openResponseModal(e),class:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-green-600/30 text-green-200 border border-green-400/30 hover:bg-green-600/50 transition-colors duration-200",title:`Respond to ${nt.formatRequestId(e.id)}`},[...t[60]||(t[60]=[(0,a.Lk)("i",{class:"fas fa-reply mr-1"},null,-1),(0,a.eW)(" Respond ",-1)])],8,ne))])])],2))),128))])])])])):((0,a.uX)(),(0,a.CE)("div",M,[t[50]||(t[50]=(0,a.Lk)("div",{class:"mb-6"},[(0,a.Lk)("i",{class:"fas fa-comment-slash text-6xl text-gray-400 mb-4"})],-1)),t[51]||(t[51]=(0,a.Lk)("h3",{class:"text-2xl font-semibold text-white mb-2"},"No Recommendations Found",-1)),t[52]||(t[52]=(0,a.Lk)("p",{class:"text-gray-300 max-w-md mx-auto text-base"}," There are currently no recommendations or comments from Divisional Directors for requests in your department. ",-1)),(0,a.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>nt.refreshRecommendations&&nt.refreshRecommendations(...e)),class:"mt-6 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-base font-medium"},[...t[49]||(t[49]=[(0,a.Lk)("i",{class:"fas fa-sync-alt mr-2"},null,-1),(0,a.eW)(" Check Again ",-1)])])])),nt.pagination.total>nt.pagination.per_page?((0,a.uX)(),(0,a.CE)("div",de,[(0,a.Lk)("div",ce,[(0,a.Lk)("button",{onClick:t[17]||(t[17]=e=>nt.changePage(nt.pagination.current_page-1)),disabled:nt.pagination.current_page<=1,class:"px-3 py-2 bg-blue-600/30 hover:bg-blue-600/50 text-blue-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...t[62]||(t[62]=[(0,a.Lk)("i",{class:"fas fa-chevron-left"},null,-1)])],8,ue),(0,a.Lk)("span",pe," Page "+(0,a.v_)(nt.pagination.current_page)+" of "+(0,a.v_)(nt.pagination.last_page),1),(0,a.Lk)("button",{onClick:t[18]||(t[18]=e=>nt.changePage(nt.pagination.current_page+1)),disabled:nt.pagination.current_page>=nt.pagination.last_page,class:"px-3 py-2 bg-blue-600/30 hover:bg-blue-600/50 text-blue-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...t[63]||(t[63]=[(0,a.Lk)("i",{class:"fas fa-chevron-right"},null,-1)])],8,me)])])):(0,a.Q3)("",!0)])])])])]),nt.showDetailsModal?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:t[21]||(t[21]=(...e)=>nt.closeDetailsModal&&nt.closeDetailsModal(...e))},[(0,a.Lk)("div",{class:"backdrop-blur-md rounded-2xl border-2 border-blue-400/30 max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"},onClick:t[20]||(t[20]=(0,a.D$)(()=>{},["stop"]))},[(0,a.Lk)("div",be,[(0,a.Lk)("div",ge,[t[64]||(t[64]=(0,a.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-file-alt text-white"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("h3",fe,(0,a.v_)(nt.formatRequestId(nt.selectedRequest?.id)),1),(0,a.Lk)("p",he,(0,a.v_)(nt.selectedRequest?.staff_name)+" ("+(0,a.v_)(nt.selectedRequest?.pf_number)+") ",1)])]),(0,a.Lk)("button",{onClick:t[19]||(t[19]=(...e)=>nt.closeDetailsModal&&nt.closeDetailsModal(...e)),class:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-300 hover:text-white transition-colors"},[...t[65]||(t[65]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])]),(0,a.Lk)("div",ve,[(0,a.Lk)("div",xe,[t[71]||(t[71]=(0,a.Lk)("h4",{class:"font-semibold text-blue-200 mb-3 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,a.eW)(" Request Overview ")],-1)),(0,a.Lk)("div",ke,[(0,a.Lk)("div",ye,[(0,a.Lk)("div",we,[t[66]||(t[66]=(0,a.Lk)("span",{class:"text-gray-300"},"Status:",-1)),(0,a.Lk)("span",{class:(0,a.C4)(["px-2 py-1 text-sm rounded-md border",nt.getStatusClass(nt.selectedRequest?.status)])},(0,a.v_)(nt.getStatusLabel(nt.selectedRequest?.status)),3)]),(0,a.Lk)("div",Le,[t[67]||(t[67]=(0,a.Lk)("span",{class:"text-gray-300"},"Access Type:",-1)),(0,a.Lk)("span",_e,(0,a.v_)(nt.selectedRequest?.access_type||"N/A"),1)]),nt.selectedRequest?.temporary_until?((0,a.uX)(),(0,a.CE)("div",Re,[t[68]||(t[68]=(0,a.Lk)("span",{class:"text-gray-300"},"Valid Until:",-1)),(0,a.Lk)("span",qe,(0,a.v_)(nt.formatDate(nt.selectedRequest?.temporary_until)),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Ce,[(0,a.Lk)("div",Se,[t[69]||(t[69]=(0,a.Lk)("span",{class:"text-gray-300"},"Purpose:",-1)),(0,a.Lk)("span",De,(0,a.v_)(nt.selectedRequest?.module_requested_for||"Use"),1)]),(0,a.Lk)("div",Ae,[t[70]||(t[70]=(0,a.Lk)("span",{class:"text-gray-300"},"Request Types:",-1)),(0,a.Lk)("div",Ee,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(nt.selectedRequest?.request_type,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-2 py-1 text-sm rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/20"},(0,a.v_)(nt.getRequestTypeLabel(e)),1))),128))])])])])]),nt.selectedRequest?.divisional_director_comments?((0,a.uX)(),(0,a.CE)("div",Fe,[(0,a.Lk)("div",Te,[t[74]||(t[74]=(0,a.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-teal-500 to-cyan-600 rounded-full flex items-center justify-center flex-shrink-0"},[(0,a.Lk)("i",{class:"fas fa-user-tie text-white"})],-1)),(0,a.Lk)("div",Ie,[(0,a.Lk)("div",Xe,[t[72]||(t[72]=(0,a.Lk)("h4",{class:"font-semibold text-teal-200"},"Divisional Director Comments",-1)),(0,a.Lk)("span",je,(0,a.v_)(nt.selectedRequest?.divisional_director_name||"Divisional Director"),1)]),(0,a.Lk)("div",Pe,[(0,a.Lk)("p",We,(0,a.v_)(nt.selectedRequest?.divisional_director_comments),1)]),(0,a.Lk)("div",Me,[t[73]||(t[73]=(0,a.Lk)("i",{class:"fas fa-calendar mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(nt.formatDate(nt.selectedRequest?.divisional_approved_at||nt.selectedRequest?.updated_at)),1)])])])])):(0,a.Q3)("",!0),nt.hasModules(nt.selectedRequest)?((0,a.uX)(),(0,a.CE)("div",Qe,[t[78]||(t[78]=(0,a.Lk)("h4",{class:"font-semibold text-purple-200 mb-3 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-cube mr-2"}),(0,a.eW)(" Modules & Services Requested ")],-1)),(0,a.Lk)("div",Ue,[nt.selectedRequest?.wellsoft_modules_selected?.length?((0,a.uX)(),(0,a.CE)("div",Ne,[t[75]||(t[75]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Wellsoft Modules:",-1)),(0,a.Lk)("div",$e,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(nt.selectedRequest.wellsoft_modules_selected,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-yellow-600/30 text-yellow-200 text-sm rounded-lg border border-yellow-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0),nt.selectedRequest?.jeeva_modules_selected?.length?((0,a.uX)(),(0,a.CE)("div",He,[t[76]||(t[76]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Jeeva Modules:",-1)),(0,a.Lk)("div",Ke,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(nt.selectedRequest.jeeva_modules_selected,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-purple-600/30 text-purple-200 text-sm rounded-lg border border-purple-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0),nt.selectedRequest?.internet_purposes?.length?((0,a.uX)(),(0,a.CE)("div",Oe,[t[77]||(t[77]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Internet Access Purposes:",-1)),(0,a.Lk)("div",Ve,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(nt.selectedRequest.internet_purposes,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-green-600/30 text-green-200 text-sm rounded-lg border border-green-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0),nt.showResponseModal?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:t[27]||(t[27]=(...e)=>nt.closeResponseModal&&nt.closeResponseModal(...e))},[(0,a.Lk)("div",{class:"backdrop-blur-md rounded-2xl border-2 border-blue-400/30 max-w-2xl w-full shadow-2xl",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"},onClick:t[26]||(t[26]=(0,a.D$)(()=>{},["stop"]))},[(0,a.Lk)("div",Be,[(0,a.Lk)("div",ze,[t[80]||(t[80]=(0,a.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-reply text-white"})],-1)),(0,a.Lk)("div",null,[t[79]||(t[79]=(0,a.Lk)("h3",{class:"text-xl font-bold text-white"},"Respond to Divisional Director",-1)),(0,a.Lk)("p",Ge,(0,a.v_)(nt.formatRequestId(nt.selectedRequest?.id))+" - "+(0,a.v_)(nt.selectedRequest?.staff_name),1)])]),(0,a.Lk)("button",{onClick:t[22]||(t[22]=(...e)=>nt.closeResponseModal&&nt.closeResponseModal(...e)),class:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-300 hover:text-white transition-colors"},[...t[81]||(t[81]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])]),(0,a.Lk)("div",Je,[nt.selectedRequest?.hod_response_to_divisional?((0,a.uX)(),(0,a.CE)("div",Ye,[t[83]||(t[83]=(0,a.Lk)("h4",{class:"text-sm font-semibold text-green-300 mb-2"},"Your Previous Response:",-1)),(0,a.Lk)("p",Ze,(0,a.v_)(nt.selectedRequest.hod_response_to_divisional),1),nt.selectedRequest.hod_response_date?((0,a.uX)(),(0,a.CE)("div",et,[(0,a.Lk)("span",tt,[t[82]||(t[82]=(0,a.Lk)("i",{class:"fas fa-clock mr-1"},null,-1)),(0,a.eW)(" Sent: "+(0,a.v_)(nt.formatDate(nt.selectedRequest.hod_response_date)),1)])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),(0,a.Lk)("div",st,[(0,a.Lk)("div",null,[t[84]||(t[84]=(0,a.Lk)("label",{class:"block text-base font-medium text-green-200 mb-2"}," Your Response to Divisional Director ",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[23]||(t[23]=e=>nt.responseText=e),rows:"6",class:"w-full px-4 py-3 bg-white/10 border border-green-400/30 rounded-lg focus:border-green-400 focus:outline-none text-white placeholder-green-200/60 backdrop-blur-sm resize-none",placeholder:`Write your response regarding Request #${nt.selectedRequest?.id}...`},null,8,at),[[a.Jo,nt.responseText]])]),(0,a.Lk)("div",rt,[(0,a.Lk)("button",{onClick:t[24]||(t[24]=(...e)=>nt.closeResponseModal&&nt.closeResponseModal(...e)),class:"px-4 py-2 bg-gray-600/30 hover:bg-gray-600/50 text-gray-200 text-sm rounded-lg transition-colors border border-gray-400/30"}," Cancel "),(0,a.Lk)("button",{onClick:t[25]||(t[25]=(...e)=>nt.submitModalResponse&&nt.submitModalResponse(...e)),disabled:!nt.responseText.trim()||nt.submittingModalResponse,class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center"},[nt.submittingModalResponse?((0,a.uX)(),(0,a.CE)("i",ot)):((0,a.uX)(),(0,a.CE)("i",it)),(0,a.eW)(" "+(0,a.v_)(nt.submittingModalResponse?"Sending...":"Send Response"),1)],8,lt)])])])])])):(0,a.Q3)("",!0)])}s(4114),s(8111),s(2489);var dt=s(8728),ct=s(5498),ut=s(8966),pt=s(1127),mt=s(9423),bt={name:"DivisionalRecommendations",components:{Header:ct.A,ModernSidebar:ut.A},setup(){const e=(0,dt.rd)(),{requireRole:t,ROLES:s}=(0,pt.h)(),r=(0,a.KR)(!1),l=(0,a.KR)([]),o=(0,a.KR)({current_page:1,last_page:1,per_page:10,total:0}),i=(0,a.KR)(""),n=(0,a.KR)(""),d=(0,a.KR)(""),c=(0,a.KR)(""),u=(0,a.KR)(null),p=(0,a.KR)(!1),m=(0,a.KR)(!1),b=(0,a.KR)(null),g=(0,a.KR)(""),f=(0,a.KR)(!1),h={jeeva_access:"Jeeva Access",wellsoft:"Wellsoft",internet_access_request:"Internet Access"},v={pending:"Pending",pending_hod:"Pending HOD",hod_approved:"HOD Approved",pending_divisional:"Pending Divisional",divisional_approved:"Approved by Divisional Director",divisional_rejected:"Rejected by Divisional Director",pending_ict_director:"Under ICT Director Review",dict_approved:"Approved by ICT Director",dict_rejected:"Rejected by ICT Director",implemented:"Implemented",rejected:"Rejected"},x=async(e=1)=>{try{r.value=!0;const t=await mt.A.get("/hod/divisional-recommendations",{params:{page:e,per_page:10}});t.data.success?(l.value=t.data.data,o.value=t.data.pagination||{current_page:1,last_page:1,per_page:10,total:t.data.data.length}):console.error("Failed to fetch recommendations:",t.data.message)}catch(t){console.error("Error fetching divisional recommendations:",t),l.value=[]}finally{r.value=!1}},k=()=>{x(o.value.current_page)},y=e=>{e>=1&&e<=o.value.last_page&&x(e)},w=e=>h[e]||e,L=e=>v[e]||e,_=e=>{const t={pending:"bg-yellow-600/30 text-yellow-200 border-yellow-400/30",pending_hod:"bg-orange-600/30 text-orange-200 border-orange-400/30",hod_approved:"bg-blue-600/30 text-blue-200 border-blue-400/30",pending_divisional:"bg-purple-600/30 text-purple-200 border-purple-400/30",divisional_approved:"bg-green-600/30 text-green-200 border-green-400/30",divisional_rejected:"bg-red-600/30 text-red-200 border-red-400/30",pending_ict_director:"bg-indigo-600/30 text-indigo-200 border-indigo-400/30",dict_approved:"bg-teal-600/30 text-teal-200 border-teal-400/30",dict_rejected:"bg-red-600/30 text-red-200 border-red-400/30",implemented:"bg-green-700/30 text-green-100 border-green-500/30",rejected:"bg-red-600/30 text-red-200 border-red-400/30"};return t[e]||"bg-gray-600/30 text-gray-200 border-gray-400/30"},R=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}},q=e=>e?`REQ-${e.toString().padStart(6,"0")}`:"N/A",C=e=>e.wellsoft_modules_selected&&e.wellsoft_modules_selected.length>0||e.jeeva_modules_selected&&e.jeeva_modules_selected.length>0||e.internet_purposes&&e.internet_purposes.length>0,S=t=>{e.push(`/both-service-form/${t}`)},D=t=>{e.push(`/hod-dashboard/approve-request/${t}`)},A=e=>"divisional_rejected"===e,E=e=>"divisional_rejected"===e,F=t=>{e.push(`/hod-dashboard/resubmit-request/${t}`)},T=e=>{b.value=e,p.value=!0},I=()=>{p.value=!1,b.value=null},X=e=>{b.value=e,g.value="",m.value=!0},j=()=>{m.value=!1,b.value=null,g.value=""},P=async()=>{if(g.value.trim()&&!f.value&&b.value)try{f.value=!0,b.value.id,g.value;const e=await mt.A.post(`/hod/respond-to-divisional/${b.value.id}`,{response:g.value,hod_response_date:(new Date).toISOString()});e.data.success?(g.value="",alert("Response sent successfully!"),j(),k()):(console.warn("âš ï¸ Response submission failed:",e.data.message),alert("Failed to send response: "+(e.data.message||"Unknown error")))}catch(e){console.error("ðŸ’¥ Error sending response:",e),alert("Failed to send response. Please try again.\n\nError: "+e.message)}finally{f.value=!1}},W=(0,a.EW)(()=>l.value.length),M=(0,a.EW)(()=>{let e=[...l.value];if(i.value){const t=i.value.toLowerCase().trim();e=e.filter(e=>(e.staff_name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.id||"").toString().includes(t)||`#${e.id}`.toLowerCase().includes(t)||q(e.id).toLowerCase().includes(t))}return n.value&&(e=e.filter(e=>e.status===n.value)),d.value&&(e=e.filter(e=>{const t=Array.isArray(e.request_type)?e.request_type:[e.request_type];return t.includes(d.value)})),"with_comments"===c.value?e=e.filter(e=>e.divisional_director_comments&&""!==e.divisional_director_comments.trim()):"without_comments"===c.value&&(e=e.filter(e=>!e.divisional_director_comments||""===e.divisional_director_comments.trim())),e.sort((e,t)=>{const s=new Date(e.divisional_approved_at||e.updated_at||e.created_at||0),a=new Date(t.divisional_approved_at||t.updated_at||t.created_at||0);return a-s})}),Q=(0,a.EW)(()=>!!(i.value||n.value||d.value||c.value)),U=()=>{u.value&&clearTimeout(u.value),u.value=setTimeout(()=>{i.value},300)},N=()=>{n.value,d.value,c.value},$=()=>{i.value=""},H=()=>{i.value="",n.value="",d.value="",c.value=""},K=()=>{n.value="",N()},O=()=>{d.value="",N()},V=()=>{c.value="",N()};return(0,a.sV)(()=>{t([s.HEAD_OF_DEPARTMENT]),x()}),{loading:r,recommendations:l,pagination:o,refreshRecommendations:k,changePage:y,getRequestTypeLabel:w,getStatusLabel:L,getStatusClass:_,formatDate:R,formatRequestId:q,hasModules:C,viewFullRequest:S,respondToRecommendation:D,isRejectedByDivisional:A,canResubmitRequest:E,resubmitRequest:F,searchQuery:i,statusFilter:n,requestTypeFilter:d,commentsFilter:c,filteredRecommendations:M,totalRecommendations:W,hasActiveFilters:Q,debouncedSearch:U,applyFilters:N,clearSearch:$,clearAllFilters:H,clearStatusFilter:K,clearRequestTypeFilter:O,clearCommentsFilter:V,showDetailsModal:p,showResponseModal:m,selectedRequest:b,responseText:g,submittingModalResponse:f,viewRequestDetails:T,closeDetailsModal:I,openResponseModal:X,closeResponseModal:j,submitModalResponse:P}}},gt=s(1241);const ft=(0,gt.A)(bt,[["render",nt],["__scopeId","data-v-0d0cb6db"]]);var ht=ft},2068:function(e,t,s){s.r(t),s.d(t,{default:function(){return he}});var a=s(5796);const r={class:"flex flex-col h-screen"},l={class:"flex flex-1 overflow-hidden"},o={class:"sidebar-narrow"},i={class:"flex-1 p-4 bg-blue-900 overflow-y-auto"},n={class:"max-w-full mx-auto"},d={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},c={class:"grid grid-cols-4 gap-4 mb-6"},u={class:"bg-yellow-600/25 border border-yellow-400/40 p-4 rounded-lg"},p={class:"text-white text-3xl font-bold"},m={class:"bg-green-600/25 border border-green-400/40 p-4 rounded-lg"},b={class:"text-white text-3xl font-bold"},g={class:"bg-red-600/25 border border-red-400/40 p-4 rounded-lg"},f={class:"text-white text-3xl font-bold"},h={class:"bg-blue-600/25 border border-blue-400/40 p-4 rounded-lg"},v={class:"text-white text-3xl font-bold"},x={class:"bg-white/10 rounded-lg p-4 mb-6"},k={class:"flex gap-4"},y={class:"bg-white/10 rounded-lg overflow-visible relative"},w={class:"w-full"},L={class:"px-4 py-3"},_={class:"text-white font-bold text-sm"},R={class:"text-purple-300 text-xs"},q={class:"px-4 py-4"},C={class:"flex flex-wrap gap-1"},S={key:0,class:"px-2 py-1 rounded text-xs font-bold bg-blue-100 text-blue-800"},D={key:1,class:"px-2 py-1 rounded text-xs font-bold bg-green-100 text-green-800"},A={key:2,class:"px-2 py-1 rounded text-xs font-bold bg-cyan-100 text-cyan-800"},E={class:"px-4 py-3"},F={class:"text-white font-bold text-sm"},T={class:"text-blue-300 text-xs"},I={key:0,class:"text-teal-300 text-xs"},X={class:"text-blue-200 text-xs"},j={class:"px-4 py-3"},P={class:"text-white font-bold text-sm"},W={class:"text-blue-300 text-xs"},M={class:"px-4 py-4"},Q={class:"flex flex-col"},U={key:0,class:"mb-1 rounded text-xs font-semibold inline-block bg-red-900/30 text-red-300 border border-red-500/40 px-2 py-0.5",style:{width:"fit-content"}},N={key:1,class:"mt-1 px-1.5 py-0.5 rounded text-[10px] font-semibold bg-emerald-900/30 text-emerald-300 border border-emerald-500/40 w-fit"},$={class:"px-4 py-4"},H={class:"flex items-center space-x-2"},K=["onClick","disabled"],O={key:0},V={key:1},B={key:1,class:"text-xs text-blue-200 ml-1"},z={class:"px-4 py-3 text-center relative"},G={class:"flex justify-center three-dot-menu"},J=["onClick","data-request-id","aria-label"],Y={key:0,class:"text-center py-12"},Z={class:"text-blue-300 text-lg"},ee={key:1,class:"px-4 py-3 border-t border-blue-300/30"},te={class:"text-blue-300 text-lg font-bold"},se={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ae={key:1,class:"dropdown-portal"},re={class:"py-2"},le={key:5,class:"border-t border-gray-100 my-1"};function oe(e,t,s,oe,ie,ne){const de=(0,a.g2)("Header"),ce=(0,a.g2)("ModernSidebar"),ue=(0,a.g2)("AppFooter"),pe=(0,a.g2)("RequestTimeline");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(de),(0,a.Lk)("div",l,[(0,a.Lk)("div",o,[(0,a.bF)(ce)]),(0,a.Lk)("main",i,[(0,a.Lk)("div",n,[ie.error?((0,a.uX)(),(0,a.CE)("div",d,[t[12]||(t[12]=(0,a.Lk)("h3",{class:"font-bold"},"Error",-1)),(0,a.Lk)("p",null,(0,a.v_)(ie.error),1),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>ne.fetchRequests&&ne.fetchRequests(...e)),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Retry ")])):(0,a.Q3)("",!0),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[t[13]||(t[13]=(0,a.Lk)("h3",{class:"text-yellow-200 text-lg font-bold"},"Pending HOD Approval",-1)),(0,a.Lk)("p",p,(0,a.v_)(ie.stats.pendingHod),1)]),(0,a.Lk)("div",m,[t[14]||(t[14]=(0,a.Lk)("h3",{class:"text-green-200 text-lg font-bold"},"HOD Approved",-1)),(0,a.Lk)("p",b,(0,a.v_)(ie.stats.hodApproved),1)]),(0,a.Lk)("div",g,[t[15]||(t[15]=(0,a.Lk)("h3",{class:"text-red-200 text-lg font-bold"},"HOD Rejected",-1)),(0,a.Lk)("p",f,(0,a.v_)(ie.stats.hodRejected),1)]),(0,a.Lk)("div",h,[t[16]||(t[16]=(0,a.Lk)("h3",{class:"text-blue-200 text-lg font-bold"},"Total Requests",-1)),(0,a.Lk)("p",v,(0,a.v_)(ie.stats.total),1)])]),(0,a.Lk)("div",x,[(0,a.Lk)("div",k,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>ie.searchQuery=e),type:"text",placeholder:"Search by staff name, PF number, or department...",class:"flex-1 px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white placeholder-blue-200/60 text-base"},null,512),[[a.Jo,ie.searchQuery]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>ie.statusFilter=e),class:"px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white text-base status-select"},[...t[17]||(t[17]=[(0,a.Fv)('<option value="" data-v-e16291d8>All Statuses</option><option value="pending" data-v-e16291d8>Pending Submission</option><option value="pending_hod" data-v-e16291d8>Pending HOD</option><option value="hod_approved" data-v-e16291d8>HOD Approved</option><option value="hod_rejected" data-v-e16291d8>HOD Rejected</option><option value="divisional_approved" data-v-e16291d8>Divisional Approved</option><option value="divisional_rejected" data-v-e16291d8>Divisional Rejected</option><option value="approved" data-v-e16291d8>Fully Approved</option><option value="implemented" data-v-e16291d8>Implemented</option><option value="completed" data-v-e16291d8>Completed</option><option value="cancelled" data-v-e16291d8>Cancelled</option>',11)])],512),[[a.u1,ie.statusFilter]]),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>ne.refreshRequests&&ne.refreshRequests(...e)),class:"px-6 py-3 bg-teal-600 text-white rounded hover:bg-teal-700 text-base font-bold"}," Refresh ")])]),(0,a.Lk)("div",y,[(0,a.Lk)("table",w,[t[20]||(t[20]=(0,a.Lk)("thead",{class:"bg-blue-800/50"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"Request ID"),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"Request Type"),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," Personal Information "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," Submission Date "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," Current Status "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"SMS Status"),(0,a.Lk)("th",{class:"px-4 py-3 text-center text-blue-100 text-sm font-bold"},"Actions")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(ne.filteredRequests,e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:"border-t border-blue-300/20 hover:bg-blue-700/30"},[(0,a.Lk)("td",L,[(0,a.Lk)("div",_,(0,a.v_)(e.request_id||`REQ-${e.id.toString().padStart(6,"0")}`),1),(0,a.Lk)("div",R,"ID: "+(0,a.v_)(e.id),1)]),(0,a.Lk)("td",q,[(0,a.Lk)("div",C,[ne.hasService(e,"jeeva")?((0,a.uX)(),(0,a.CE)("span",S," Jeeva ")):(0,a.Q3)("",!0),ne.hasService(e,"wellsoft")?((0,a.uX)(),(0,a.CE)("span",D," Wellsoft ")):(0,a.Q3)("",!0),ne.hasService(e,"internet")?((0,a.uX)(),(0,a.CE)("span",A," Internet ")):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",E,[(0,a.Lk)("div",F,(0,a.v_)(e.staff_name||e.full_name||"Unknown User"),1),(0,a.Lk)("div",T,(0,a.v_)(e.phone||e.phone_number||"No phone"),1),e.pf_number?((0,a.uX)(),(0,a.CE)("div",I," PF: "+(0,a.v_)(e.pf_number),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",X," Dept: "+(0,a.v_)(e.department||"Unknown"),1)]),(0,a.Lk)("td",j,[(0,a.Lk)("div",P,(0,a.v_)(ne.formatDate(e.created_at||e.submission_date)),1),(0,a.Lk)("div",W,(0,a.v_)(ne.formatTime(e.created_at||e.submission_date)),1)]),(0,a.Lk)("td",M,[(0,a.Lk)("div",Q,["skipped"===e.divisional_status?((0,a.uX)(),(0,a.CE)("span",U," No Divisional Director â€” Stage Skipped ")):(0,a.Q3)("",!0),(0,a.Lk)("span",{class:(0,a.C4)([ne.getStatusBadgeClass(e.hod_status||e.status||"pending_hod"),"rounded text-sm font-bold inline-block"]),style:{padding:"4px 8px",width:"fit-content"}},(0,a.v_)(ne.getStatusText(e.hod_status||e.status||"pending_hod")),3),e.has_signature||e.signature?((0,a.uX)(),(0,a.CE)("span",N," Digitally signed ")):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",$,[(0,a.Lk)("div",H,[(0,a.Lk)("div",{class:(0,a.C4)(["w-3 h-3 rounded-full",ne.getSmsStatusColor(ne.getRelevantSmsStatus(e))])},null,2),(0,a.Lk)("span",{class:(0,a.C4)(["text-sm font-medium",ne.getSmsStatusTextColor(ne.getRelevantSmsStatus(e))])},(0,a.v_)(ne.getSmsStatusText(ne.getRelevantSmsStatus(e))),3),["failed","pending"].includes(ne.getRelevantSmsStatus(e))?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:(0,a.D$)(t=>ne.retrySendSms(e),["stop"]),disabled:ne.isRetrying(e.id),class:"ml-2 px-2 py-1 text-xs rounded border border-blue-300/50 text-blue-100 hover:bg-blue-700/40 disabled:opacity-50",title:"Retry sending SMS"},[ne.isRetrying(e.id)?((0,a.uX)(),(0,a.CE)("span",V,[...t[18]||(t[18]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),(0,a.eW)("Retrying",-1)])])):((0,a.uX)(),(0,a.CE)("span",O,"Retry"))],8,K)):(0,a.Q3)("",!0),ne.getRetryAttempts(e.id)>0?((0,a.uX)(),(0,a.CE)("span",B," ("+(0,a.v_)(ne.getRetryAttempts(e.id))+") ",1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",z,[(0,a.Lk)("div",G,[(0,a.Lk)("button",{onClick:(0,a.D$)(t=>ne.toggleDropdown(e.id),["stop"]),"data-request-id":e.id,class:(0,a.C4)(["three-dot-button p-2 text-white hover:bg-blue-600/40 rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:scale-105 active:scale-95",{"bg-blue-600/40 shadow-lg":ie.activeDropdown===e.id}]),"aria-label":"Actions for request "+(e.request_id||"REQ-"+e.id.toString().padStart(6,"0"))},[...t[19]||(t[19]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[(0,a.Lk)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],10,J)])])]))),128))])]),0===ne.filteredRequests.length?((0,a.uX)(),(0,a.CE)("div",Y,[t[21]||(t[21]=(0,a.Lk)("h3",{class:"text-white text-2xl font-bold mb-2"},"No requests found",-1)),(0,a.Lk)("p",Z,(0,a.v_)(ie.searchQuery||ie.statusFilter?"Try adjusting your filters":"No combined access requests have been submitted yet."),1)])):(0,a.Q3)("",!0),ne.filteredRequests.length>0?((0,a.uX)(),(0,a.CE)("div",ee,[(0,a.Lk)("div",te," Showing "+(0,a.v_)(ne.filteredRequests.length)+" of "+(0,a.v_)(ie.requests.length)+" requests ",1)])):(0,a.Q3)("",!0)]),(0,a.bF)(ue)])])]),ie.isLoading?((0,a.uX)(),(0,a.CE)("div",se,[...t[22]||(t[22]=[(0,a.Lk)("div",{class:"rounded-xl shadow-2xl p-8 text-center border border-blue-400/40",style:{background:"linear-gradient(90deg, #0b3a82, #0a2f6f, #0b3a82)"}},[(0,a.Lk)("div",{class:"flex justify-center mb-4"},[(0,a.Lk)("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"})]),(0,a.Lk)("p",{class:"text-blue-100 font-medium"},"Loading requests...")],-1)])])):(0,a.Q3)("",!0),(0,a.bF)(pe,{show:ie.showTimeline,"request-id":ie.selectedRequestId,onClose:ne.closeTimeline,onUpdated:ne.handleTimelineUpdate},null,8,["show","request-id","onClose","onUpdated"]),ie.activeDropdown?((0,a.uX)(),(0,a.CE)("div",ae,[(0,a.Lk)("div",{class:"fixed w-56 origin-top-right bg-white rounded-xl shadow-2xl border border-gray-200/50 focus:outline-none backdrop-blur-sm dropdown-menu",style:(0,a.Tr)(ne.getGlobalDropdownStyle()),onClick:t[11]||(t[11]=(0,a.D$)(()=>{},["stop"]))},[(0,a.Lk)("div",re,[ne.activeRequest?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[ne.isCancelledByUser(ne.activeRequest)||ne.isRequestApproved(ne.activeRequest)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[4]||(t[4]=e=>ne.viewAndProcessRequest(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-green-700 hover:bg-gradient-to-r hover:from-green-50 hover:to-green-100 hover:text-green-800 transition-all duration-200 font-semibold"},[...t[23]||(t[23]=[(0,a.Lk)("i",{class:"fas fa-check-circle mr-3 text-green-600 group-hover:text-green-700 text-xl"},null,-1),(0,a.eW)(" Approve ",-1)])])),ne.isCancelledByUser(ne.activeRequest)||ne.isRequestApproved(ne.activeRequest)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[5]||(t[5]=e=>ne.editRequestForReview(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-blue-700 hover:bg-gradient-to-r hover:from-blue-50 hover:to-blue-100 hover:text-blue-800 transition-all duration-200 font-semibold"},[...t[24]||(t[24]=[(0,a.Lk)("i",{class:"fas fa-edit mr-3 text-blue-500 group-hover:text-blue-600 text-xl"},null,-1),(0,a.eW)(" Edit Request ",-1)])])),ne.isRequestApproved(ne.activeRequest)?((0,a.uX)(),(0,a.CE)("button",{key:2,onClick:t[6]||(t[6]=e=>ne.viewApprovedRequest(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-purple-700 hover:bg-gradient-to-r hover:from-purple-50 hover:to-purple-100 hover:text-purple-800 transition-all duration-200 font-semibold"},[...t[25]||(t[25]=[(0,a.Lk)("i",{class:"fas fa-eye mr-3 text-purple-600 group-hover:text-purple-700 text-xl"},null,-1),(0,a.eW)(" View Approved Request ",-1)])])):(0,a.Q3)("",!0),ne.isCancelledByUser(ne.activeRequest)?((0,a.uX)(),(0,a.CE)("button",{key:3,onClick:t[7]||(t[7]=e=>ne.deleteRequest(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-gray-700 hover:bg-gradient-to-r hover:from-red-50 hover:to-red-100 hover:text-red-700 transition-all duration-200 font-semibold"},[...t[26]||(t[26]=[(0,a.Lk)("i",{class:"fas fa-trash mr-3 text-red-500 group-hover:text-red-600 text-xl"},null,-1),(0,a.eW)(" Delete ",-1)])])):(0,a.Q3)("",!0),ne.canEdit(ne.activeRequest)?((0,a.uX)(),(0,a.CE)("button",{key:4,onClick:t[8]||(t[8]=e=>ne.editRequest(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-gray-700 hover:bg-gradient-to-r hover:from-amber-50 hover:to-amber-100 hover:text-amber-700 transition-all duration-200 font-semibold"},[...t[27]||(t[27]=[(0,a.Lk)("i",{class:"fas fa-edit mr-3 text-amber-500 group-hover:text-amber-600 text-xl"},null,-1),(0,a.eW)(" Edit ",-1)])])):(0,a.Q3)("",!0),ne.canCancel(ne.activeRequest)&&!ne.isRequestApproved(ne.activeRequest)?((0,a.uX)(),(0,a.CE)("div",le)):(0,a.Q3)("",!0),ne.canCancel(ne.activeRequest)&&!ne.isRequestApproved(ne.activeRequest)?((0,a.uX)(),(0,a.CE)("button",{key:6,onClick:t[9]||(t[9]=e=>ne.cancelRequest(ne.activeRequest.id)),class:"group flex items-center w-full px-4 py-3 text-xl text-gray-700 hover:bg-gradient-to-r hover:from-red-50 hover:to-red-100 hover:text-red-700 transition-all duration-200 font-semibold"},[...t[28]||(t[28]=[(0,a.Lk)("i",{class:"fas fa-ban mr-3 text-red-500 group-hover:text-red-600 text-xl"},null,-1),(0,a.eW)(" Cancel ",-1)])])):(0,a.Q3)("",!0),t[30]||(t[30]=(0,a.Lk)("div",{class:"border-t border-gray-100 my-1"},null,-1)),(0,a.Lk)("button",{onClick:t[10]||(t[10]=e=>ne.viewTimeline(ne.activeRequest)),class:"group flex items-center w-full px-4 py-3 text-xl text-gray-700 hover:bg-gradient-to-r hover:from-indigo-50 hover:to-indigo-100 hover:text-indigo-700 transition-all duration-200 font-semibold"},[...t[29]||(t[29]=[(0,a.Lk)("i",{class:"fas fa-history mr-3 text-indigo-500 group-hover:text-indigo-600 text-xl"},null,-1),(0,a.eW)(" View Timeline ",-1)])])],64)):(0,a.Q3)("",!0)])],4)])):(0,a.Q3)("",!0)])}s(4114),s(8111),s(2489),s(116),s(7588),s(3579);var ie=s(5498),ne=s(8966),de=s(9101),ce=s(373),ue=s(460),pe=s(2398),me=s(4710),be={name:"HodRequestList",components:{Header:ie.A,ModernSidebar:ne.A,AppFooter:de.A,RequestTimeline:ce.A},setup(){return{}},data(){return{requests:[],searchQuery:"",statusFilter:"",isLoading:!1,stats:{pendingHod:0,hodApproved:0,hodRejected:0,total:0},error:null,activeDropdown:null,enableBackgroundFX:!1,enableTransitions:!1,showTimeline:!1,selectedRequestId:null,$statusUtils:pe.Ay,fetchTimeout:null,isFetchingData:!1,retryAttempts:{},retryTimers:{},maxRetryAttempts:5,retryDelays:[3e3,7e3,15e3,3e4,6e4]}},computed:{filteredRequests(){if(!Array.isArray(this.requests))return console.warn("HodRequestList: requests is not an array:",this.requests),[];let e=this.requests;if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter(e=>(e.staff_name||e.full_name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t)||(e.request_id||"").toLowerCase().includes(t))}return this.statusFilter&&(e=e.filter(e=>(e.hod_status||e.status||"pending_hod")===this.statusFilter)),e.sort((e,t)=>{const s=e.hod_status||e.status||"pending_hod",a=t.hod_status||t.status||"pending_hod",r="pending_hod"===s||"pending"===s,l="pending_hod"===a||"pending"===a;if(r&&!l)return-1;if(!r&&l)return 1;const o=new Date(e.created_at||e.submission_date||0),i=new Date(t.created_at||t.submission_date||0);return o-i})},activeRequest(){return this.getActiveRequest()}},async mounted(){try{const e=localStorage.getItem("auth_token");e?await this.fetchRequests():(this.isLoading=!0,window.addEventListener("auth-ready",this.onAuthReady,{once:!0})),this._poller=setInterval(()=>this.fetchRequests({silent:!0}),3e4),document.addEventListener("click",this.closeDropdowns)}catch(e){console.error("HodRequestList: Error during mount:",e),this.error="Failed to initialize component: "+e.message,this.isLoading=!1}},beforeUnmount(){document.removeEventListener("click",this.closeDropdowns),this._poller&&clearInterval(this._poller),window.removeEventListener("auth-ready",this.onAuthReady)},methods:{onAuthReady(){this.fetchRequests()},toggleDropdown(e){const t=String(e);this.activeDropdown,String(this.activeDropdown)===t?this.activeDropdown=null:(this.activeDropdown=t,this.$nextTick(()=>{this.$forceUpdate()}))},closeDropdowns(e){e&&e.target.closest(".relative")||(this.activeDropdown=null)},getDropdownStyle(e){if(this.activeDropdown!==e)return{display:"none"};const t=String(e),s=document.querySelector(`[data-request-id="${t}"]`),a=document.getElementById("dropdown-"+t);let r={top:50,bottom:60,right:window.innerWidth-10};s&&(r=s.getBoundingClientRect());const l=window.innerHeight,o=a?a.offsetHeight:240,i=Math.min(o||240,l-20);let n=r.bottom+8,d=Math.max(10,window.innerWidth-r.right);return n+i>l&&(n=Math.max(10,r.top-i-8)),n<10&&(n=10),{position:"fixed",top:n+"px",right:d+"px",zIndex:99999}},getActiveRequest(){return this.activeDropdown?this.filteredRequests.find(e=>String(e.id)===String(this.activeDropdown)):null},getGlobalDropdownStyle(){if(!this.activeDropdown)return{display:"none"};const e=String(this.activeDropdown),t=document.querySelector(`[data-request-id="${e}"]`),s=224,a={position:"fixed",top:"50px",left:"10px",zIndex:99999};if(!t)return a;const r=t.getBoundingClientRect(),l=window.innerHeight,o=window.innerWidth,i=240;let n=r.bottom+8,d=Math.min(r.left,o-s-10);return n+i>l&&(n=Math.max(10,r.top-i-8)),d<10&&(d=10),n<10&&(n=10),{position:"fixed",top:n+"px",left:d+"px",zIndex:99999}},async fetchRequests(e={silent:!1}){if(!this.isFetchingData){this.isFetchingData=!0,e?.silent||(this.isLoading=!0,this.error=null);try{const e=await ue.A.getHodRequests({search:this.searchQuery||void 0,status:this.statusFilter||void 0,per_page:50});if(!e.success)throw new Error(e.error||"Failed to fetch requests");{const t=e.data?.data||e.data||{};this.requests=Array.isArray(t.data)?t.data:Array.isArray(t)?t:[],this.requests.length,e.data,await this.fetchStatistics(),this.initAutoRetryForList()}}catch(t){if("Request aborted"===t.message||t.message?.includes("aborted")||t.message?.includes("canceled"))return this.isFetchingData=!1,void(e?.silent||(this.isLoading=!1));console.error("Error fetching requests:",t),e?.silent||(this.error="Unable to load combined access requests. Please check your connection and try again."),this.requests=[],this.calculateStats()}finally{this.isFetchingData=!1,e?.silent||(this.isLoading=!1)}}},async fetchStatistics(){try{const e=await ue.A.getHodStatistics();e.success?this.stats=e.data:this.calculateStats()}catch(e){console.error("Error fetching statistics:",e),this.calculateStats()}},calculateStats(){const e=Array.isArray(this.requests)?this.requests:[];this.stats={pendingHod:e.filter(e=>"pending_hod"===(e.hod_status||e.status)).length,hodApproved:e.filter(e=>"hod_approved"===(e.hod_status||e.status)).length,hodRejected:e.filter(e=>"hod_rejected"===(e.hod_status||e.status)).length,approved:e.filter(e=>"approved"===(e.hod_status||e.status)).length,implemented:e.filter(e=>"implemented"===(e.hod_status||e.status)).length,completed:e.filter(e=>"completed"===(e.hod_status||e.status)).length,cancelled:e.filter(e=>"cancelled"===(e.hod_status||e.status)).length,total:e.length}},async refreshRequests(){this.fetchTimeout&&clearTimeout(this.fetchTimeout),this.fetchTimeout=setTimeout(()=>{this.fetchRequests()},300)},viewAndProcessRequest(e){this.closeDropdowns(),this.$router.push({path:`/hod-combined-requests/both-service-form/${e}`,query:{mode:"readonly"}})},editRequestForReview(e){this.closeDropdowns(),this.$router.push({path:`/hod-combined-requests/both-service-form/${e}`,query:{mode:"edit",role:"hod"}})},editRequest(e){this.closeDropdowns(),this.$router.push(`/both-service-form/${e}/edit`)},async cancelRequest(e){this.closeDropdowns();try{const t=confirm("Are you sure you want to cancel this request? This action cannot be undone.");if(!t)return;const s=prompt("Please provide a reason for cancellation:");if(!s||""===s.trim())return void alert("Cancellation reason is required");const a=await ue.A.cancelRequest(e,s);if(!a.success)throw new Error(a.error||"Failed to cancel request");{const t=this.requests.findIndex(t=>t.id===e);-1!==t&&(this.requests[t].hod_status="cancelled",this.requests[t].status="cancelled"),this.calculateStats(),alert("Request cancelled successfully!")}}catch(t){console.error("Error cancelling request:",t),alert("Error cancelling request: "+t.message)}},hasService(e,t){return e.services&&e.services.includes(t)||e.request_types&&e.request_types.some(e=>"jeeva"===t&&"jeeva_access"===e||"wellsoft"===t&&"wellsoft"===e||"internet"===t&&"internet_access_request"===e)},canEdit(e){return"pending_hod"===(e.hod_status||e.status)},canCancel(e){const t=e.hod_status||e.status;return"hod_rejected"!==t&&"cancelled"!==t},formatDate(e){if(!e)return"N/A";const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},formatTime(e){if(!e)return"N/A";const t=new Date(e);return t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},getStatusBadgeClass(e){return this.$statusUtils.getStatusBadgeClass(e)},getStatusIcon(e){return this.$statusUtils.getStatusIcon(e)},getStatusText(e){return this.$statusUtils.getStatusText(e,"HodRequestList")},viewTimeline(e){e.id,this.activeDropdown=null,this.selectedRequestId=e.id,this.showTimeline=!0},closeTimeline(){this.showTimeline=!1,this.selectedRequestId=null},async handleTimelineUpdate(){await this.fetchRequests()},isCancelledByUser(e){const t=e.hod_status||e.status;if("cancelled"!==t)return!1;if("undefined"!==typeof e.cancelled_by_user)return!!e.cancelled_by_user;const s=!!e.cancelled_by&&!!e.user_id&&e.cancelled_by===e.user_id,a=(e.cancellation_reason||"").toString().toLowerCase().includes("cancelled by user");return s||a},async deleteRequest(e){this.closeDropdowns();const t=confirm("Delete this cancelled request from your list?");if(t)try{const t=await ue.A.deleteCancelledRequest(e);if(!t.success)throw new Error(t.error);this.requests=this.requests.filter(t=>t.id!==e),this.calculateStats(),alert("Request deleted.")}catch(s){console.error("HOD delete failed:",s),alert("Failed to delete request: "+s.message)}},isRequestApproved(e){const t=e.hod_status||e.status;return"hod_approved"===t||"approved"===t||"divisional_approved"===t||"ict_director_approved"===t||"head_it_approved"===t||"implemented"===t||"completed"===t},viewApprovedRequest(e){this.closeDropdowns(),this.$router.push({path:`/hod-combined-requests/both-service-form/${e}`,query:{mode:"view",readonly:"true"}})},getRetryAttempts(e){return this.retryAttempts[e]||0},isRetrying(e){return!!this.retryTimers[e]},async retrySendSms(e){if(!e)return;const t=e.id;if(this.retryAttempts[t]||(this.retryAttempts[t]=0),!this.isRetrying(t))try{this.retryTimers[t]=setTimeout(()=>{},0),await me["default"].resendSmsGeneric({requestId:t,role:"hod",target:"divisional_director"}),setTimeout(async()=>{await this.fetchRequests({silent:!0}),clearTimeout(this.retryTimers[t]),delete this.retryTimers[t];const s=(this.requests||[]).find(e=>e.id===t)||e,a=this.getRelevantSmsStatus(s);"sent"!==a?this.scheduleNextRetry(t,e):this.retryAttempts[t]=0},1200)}catch(s){clearTimeout(this.retryTimers[t]),delete this.retryTimers[t],this.scheduleNextRetry(t,e)}},scheduleNextRetry(e,t){if(this.retryAttempts[e]=(this.retryAttempts[e]||0)+1,this.retryAttempts[e]>this.maxRetryAttempts)return;const s=this.retryDelays[Math.min(this.retryAttempts[e]-1,this.retryDelays.length-1)];this.retryTimers[e]=setTimeout(async()=>{clearTimeout(this.retryTimers[e]),delete this.retryTimers[e],await this.retrySendSms(t)},s)},initAutoRetryForList(){(this.requests||[]).forEach(e=>{const t=this.getRelevantSmsStatus(e);["failed","pending"].includes(t)&&(this.retryTimers[e.id]||0!==(this.retryAttempts[e.id]||0)||this.scheduleNextRetry(e.id,e))})},getRelevantSmsStatus(e){const t=e.hod_status||e.status;return e.id,e.hod_status,e.sms_to_divisional_status,("hod_approved"===t||"approved"===t||"divisional_approved"===t||"implemented"===t)&&e.sms_to_divisional_status||"pending"},getSmsStatusText(e){const t={sent:"Delivered",pending:"Pending",failed:"Failed"};return t[e]||"Pending"},getSmsStatusColor(e){const t={sent:"bg-green-500",pending:"bg-yellow-500",failed:"bg-red-500"};return t[e]||"bg-gray-400"},getSmsStatusTextColor(e){const t={sent:"text-green-400",pending:"text-yellow-400",failed:"text-red-400"};return t[e]||"text-gray-400"}}},ge=s(1241);const fe=(0,ge.A)(be,[["render",oe],["__scopeId","data-v-e16291d8"]]);var he=fe},4710:function(e,t,s){s.r(t);s(4603),s(7566),s(8721);var a=s(4373);const r="/api",l=a.A.create({baseURL:r,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),o=a.A.create({baseURL:r,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),i=!1,n=e=>{e.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))};n(l),n(o);const d=e=>{e.interceptors.request.use(e=>{if(e.method&&"get"===e.method.toLowerCase())try{const t=new URL(e.url,e.baseURL);t.searchParams.set("_cb",String(Date.now())),e.url=t.pathname+t.search}catch(t){const s=(e.url||"").includes("?")?"&":"?";e.url=`${e.url}${s}_cb=${Date.now()}`}return e},e=>Promise.reject(e))};d(l),d(o);const c={data:null,timestamp:null,maxAge:15e3},u="true"===String({NODE_ENV:"production",VUE_APP_API_URL:"/api",VUE_APP_NAME:"Mnh Access Management System",VUE_APP_VERSION:"1.0.0",VUE_APP_DEBUG:"false",VUE_APP_LOG_LEVEL:"debug",VUE_APP_API_TIMEOUT:"30000",BASE_URL:"/"}.VUE_APP_ENABLE_SMS_RESEND||"false").toLowerCase(),p={isResendEnabled(){return u},async resendSmsGeneric({requestId:e,role:t=null,target:s=null,phone:a=null,channel:r="sms"}){if(!u)return{success:!1,message:"SMS resend not supported by backend; skipped"};const l=e=>{if(!e)return null;const t=String(e).trim(),s=t.startsWith("+"),a=t.replace(/[^\d]/g,"");return s?`+${a}`:a},i=a||null,n=l(i),d={request_id:e,role:t,target:s,notification_type:"generic_sms",resend_only:!0,force:!0,force_resend:!0,resend_sms:!0,send_sms:!0,notification_channel:r,phone:i||void 0,phone_number:n||void 0,recipient_phone:n||void 0,destination_phone:n||void 0,msisdn:n||void 0,contact_phone:n||void 0,requester_phone:i||void 0,requester_phone_number:i||void 0,staff_phone:i||void 0,staff_phone_number:i||void 0},c=[];let p,m;for(let u=0;u<c.length;u++)try{return p=await o.post(c[u],d),{success:!!p.data?.success,data:p.data?.data,message:p.data?.message}}catch(b){m=b;continue}return{success:!1,message:m?.response?.data?.message||m?.message||"No resend endpoints configured"}},async getPendingRequestsCount(e=!1){if(!e&&c.data&&c.timestamp){const e=Date.now()-c.timestamp;if(e<c.maxAge)return i&&Math.round(e/1e3),c.data}let t=null;const s=2;for(let r=1;r<=s;r++)try{const e=await o.get("/notifications/pending-count");if(e.data.success)return c.data=e.data.data,c.timestamp=Date.now(),e.data.data;console.error("âŒ NotificationService: Failed to load pending count:",e.data.message),t=new Error(e.data.message||"Failed to load pending requests count")}catch(a){if(r===s&&i&&console.error("âŒ NotificationService: Error fetching pending count:",a?.message||a),a.response&&(console.error("Response status:",a.response.status),console.error("Response data:",a.response.data),console.error("Response headers:",a.response.headers)),t=a,401===a.response?.status||403===a.response?.status)break;if(500===a.response?.status&&r>=2)break;r<s&&await new Promise(e=>setTimeout(e,1e3*r))}if(t){if(c.data)return console.warn("âš ï¸ NotificationService: Using stale cached data due to API failure"),c.data;i&&(console.error("ðŸš« NotificationService: All retry attempts failed"),console.error("Last error details:",{message:t.message,status:t.response?.status,data:t.response?.data})),i&&console.warn("ðŸ”„ NotificationService: Providing fallback data to prevent UI breakage");const e={total_pending:0,requires_attention:!1,details:null};return c.data=e,c.timestamp=Date.now(),e}return{total_pending:0,requires_attention:!1,details:null}},async getPendingRequestsBreakdown(){try{const e=await o.get("/notifications/breakdown");if(e.data.success)return e.data.data;throw console.error("âŒ NotificationService: Failed to load breakdown:",e.data.message),new Error(e.data.message||"Failed to load breakdown")}catch(e){console.error("âŒ NotificationService: Error fetching breakdown:",e);let t="Network error while loading breakdown";throw e.response?t=e.response.data?.message||"Failed to load breakdown":"ECONNABORTED"===e.code?t="Request timed out - server may be slow":e.message.includes("Network Error")&&(t="Network connection error"),new Error(t)}},clearCache(){c.data=null,c.timestamp=null},getRoleNotificationConfig(e){const t={head_of_department:{routePattern:"/hod-dashboard",menuItems:["/hod-dashboard/request-list"],description:"New requests awaiting HOD approval"},divisional_director:{routePattern:"/divisional-dashboard",menuItems:["/divisional-dashboard/combined-requests"],description:"HOD-approved requests awaiting divisional approval"},ict_director:{routePattern:"/dict-dashboard",menuItems:["/dict-dashboard/combined-requests"],description:"Divisional-approved requests awaiting ICT Director approval"},head_of_it:{routePattern:"/head_of_it-dashboard",menuItems:["/head_of_it-dashboard/combined-requests"],description:"ICT Director-approved requests awaiting Head of IT approval"},ict_officer:{routePattern:"/ict-dashboard",menuItems:["/ict-dashboard/access-requests"],description:"Requests requiring implementation (excludes implemented/completed)"},admin:{routePattern:"/admin-dashboard",menuItems:["/admin-dashboard","/service-users"],description:"System-wide pending requests"}};return t[e]||{routePattern:"/user-dashboard",menuItems:[],description:"No pending approval tasks"}},shouldShowNotificationForRoute(e,t){const s=this.getRoleNotificationConfig(t);return s.menuItems.includes(e)}};t["default"]=p},7479:function(e,t,s){s.r(t),s.d(t,{default:function(){return G}});s(4114);var a=s(5796);const r={class:"flex flex-col h-screen"},l={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-6 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 overflow-y-auto relative"},i={class:"absolute inset-0 overflow-hidden"},n={class:"absolute inset-0 opacity-5"},d={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},c={class:"max-w-4xl mx-auto relative z-10"},u={class:"medical-glass-card rounded-t-3xl p-6 mb-0 border-b border-blue-300/30"},p={class:"flex items-center justify-between"},m={class:"flex items-center"},b={class:"medical-glass-card rounded-b-3xl overflow-hidden"},g={class:"p-6"},f={key:0,class:"text-center py-12"},h={key:1,class:"text-center py-12"},v={class:"text-red-300 max-w-md mx-auto mb-6"},x={key:2,class:"space-y-8"},k={class:"bg-gradient-to-r from-blue-600/20 to-cyan-600/20 border border-blue-400/30 rounded-xl p-6"},y={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},w={class:"text-white font-medium ml-2"},L={class:"text-white font-medium ml-2"},_={class:"text-white font-medium ml-2"},R={class:"text-white font-medium ml-2"},q={class:"bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-400/30 rounded-xl p-6"},C={class:"space-y-3"},S={class:"text-white font-medium ml-2"},D={class:"text-white font-medium ml-2"},A={class:"bg-red-600/20 rounded-lg p-4 border border-red-400/20"},E={class:"text-white leading-relaxed"},F={class:"space-y-4"},T=["disabled"],I={class:"space-y-2"},X=["disabled"],j={class:"flex items-center justify-end space-x-4 mt-8 pt-6 border-t border-green-400/20"},P=["disabled"],W=["disabled"],M={key:0,class:"flex items-center"},Q={key:1,class:"flex items-center"};function U(e,t,s,U,N,$){const H=(0,a.g2)("Header"),K=(0,a.g2)("ModernSidebar"),O=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(H),(0,a.Lk)("div",l,[(0,a.bF)(K),(0,a.Lk)("main",o,[(0,a.Lk)("div",i,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",p,[(0,a.Lk)("div",m,[(0,a.bF)(O,{to:"/hod-dashboard/divisional-recommendations",class:"mr-4 p-2 rounded-lg bg-blue-600/20 hover:bg-blue-600/30 transition-colors"},{default:(0,a.k6)(()=>[...t[5]||(t[5]=[(0,a.Lk)("i",{class:"fas fa-arrow-left text-blue-300 hover:text-white"},null,-1)])]),_:1}),t[6]||(t[6]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{class:"text-xl font-bold text-blue-100 tracking-wide drop-shadow-md"},[(0,a.Lk)("i",{class:"fas fa-redo text-orange-400 mr-2"}),(0,a.eW)(" Resubmit Request ")]),(0,a.Lk)("p",{class:"text-sm text-teal-300 mt-1"}," Address divisional director feedback and resubmit request ")],-1))])])]),(0,a.Lk)("div",b,[(0,a.Lk)("div",g,[U.loading?((0,a.uX)(),(0,a.CE)("div",f,[...t[7]||(t[7]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-4xl text-blue-400 mb-4"},null,-1),(0,a.Lk)("p",{class:"text-white text-lg"},"Loading request details...",-1)])])):U.error?((0,a.uX)(),(0,a.CE)("div",h,[t[9]||(t[9]=(0,a.Lk)("div",{class:"mb-6"},[(0,a.Lk)("i",{class:"fas fa-exclamation-triangle text-6xl text-red-400 mb-4"})],-1)),t[10]||(t[10]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-white mb-2"},"Error Loading Request",-1)),(0,a.Lk)("p",v,(0,a.v_)(U.error),1),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>U.fetchRequestDetails&&U.fetchRequestDetails(...e)),class:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors"},[...t[8]||(t[8]=[(0,a.Lk)("i",{class:"fas fa-sync-alt mr-2"},null,-1),(0,a.eW)(" Try Again ",-1)])])])):U.requestDetails?((0,a.uX)(),(0,a.CE)("div",x,[(0,a.Lk)("div",k,[t[15]||(t[15]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-white mb-4 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-file-alt text-blue-400 mr-3"}),(0,a.eW)(" Request Information ")],-1)),(0,a.Lk)("div",y,[(0,a.Lk)("div",null,[t[11]||(t[11]=(0,a.Lk)("span",{class:"text-blue-300"},"Request ID:",-1)),(0,a.Lk)("span",w,"#"+(0,a.v_)(U.requestDetails.id),1)]),(0,a.Lk)("div",null,[t[12]||(t[12]=(0,a.Lk)("span",{class:"text-blue-300"},"Staff:",-1)),(0,a.Lk)("span",L,(0,a.v_)(U.requestDetails.staff_name),1)]),(0,a.Lk)("div",null,[t[13]||(t[13]=(0,a.Lk)("span",{class:"text-blue-300"},"PF Number:",-1)),(0,a.Lk)("span",_,(0,a.v_)(U.requestDetails.pf_number),1)]),(0,a.Lk)("div",null,[t[14]||(t[14]=(0,a.Lk)("span",{class:"text-blue-300"},"Department:",-1)),(0,a.Lk)("span",R,(0,a.v_)(U.requestDetails.department),1)])])]),(0,a.Lk)("div",q,[t[19]||(t[19]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-white mb-4 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-user-tie text-red-400 mr-3"}),(0,a.eW)(" Divisional Director Feedback ")],-1)),(0,a.Lk)("div",C,[(0,a.Lk)("div",null,[t[16]||(t[16]=(0,a.Lk)("span",{class:"text-red-300 text-sm"},"Reviewer:",-1)),(0,a.Lk)("span",S,(0,a.v_)(U.requestDetails.divisional_feedback.name),1)]),(0,a.Lk)("div",null,[t[17]||(t[17]=(0,a.Lk)("span",{class:"text-red-300 text-sm"},"Date:",-1)),(0,a.Lk)("span",D,(0,a.v_)(U.formatDate(U.requestDetails.divisional_feedback.reviewed_at)),1)]),(0,a.Lk)("div",A,[t[18]||(t[18]=(0,a.Lk)("span",{class:"text-red-300 text-sm block mb-2"},"Comments/Recommendations:",-1)),(0,a.Lk)("p",E,(0,a.v_)(U.requestDetails.divisional_feedback.comments),1)])])]),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,a.D$)((...e)=>U.submitResubmission&&U.submitResubmission(...e),["prevent"])),class:"bg-gradient-to-r from-green-600/20 to-emerald-600/20 border border-green-400/30 rounded-xl p-6"},[t[27]||(t[27]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-white mb-4 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-edit text-green-400 mr-3"}),(0,a.eW)(" Resubmission Details ")],-1)),(0,a.Lk)("div",F,[(0,a.Lk)("div",null,[t[20]||(t[20]=(0,a.Lk)("label",{class:"block text-green-200 text-sm font-medium mb-2"},[(0,a.eW)(" Response to Divisional Director's Feedback "),(0,a.Lk)("span",{class:"text-red-400"},"*")],-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>U.resubmissionForm.resubmission_notes=e),disabled:U.submitting,rows:"6",class:"w-full px-4 py-3 bg-white/10 border border-green-400/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500/50 focus:border-green-400/50 disabled:opacity-50 disabled:cursor-not-allowed",placeholder:"Please explain how you have addressed the divisional director's feedback and recommendations. Be specific about changes made to the request...",required:""},null,8,T),[[a.Jo,U.resubmissionForm.resubmission_notes]]),t[21]||(t[21]=(0,a.Lk)("p",{class:"text-green-300 text-xs mt-1"}," Minimum 50 characters required to ensure detailed response ",-1))]),(0,a.Lk)("div",null,[t[23]||(t[23]=(0,a.Lk)("label",{class:"block text-green-200 text-sm font-medium mb-2"}," Update HOD Signature (Optional) ",-1)),(0,a.Lk)("div",I,[(0,a.Lk)("input",{type:"file",ref:"signatureInput",onChange:t[2]||(t[2]=(...e)=>U.handleSignatureUpload&&U.handleSignatureUpload(...e)),disabled:U.submitting,accept:".jpg,.jpeg,.png,.pdf",class:"block w-full text-base text-gray-300 bg-white/10 border border-green-400/30 rounded-lg cursor-pointer focus:outline-none focus:ring-2 focus:ring-green-500/50 disabled:opacity-50 disabled:cursor-not-allowed"},null,40,X),t[22]||(t[22]=(0,a.Lk)("p",{class:"text-green-300 text-xs"}," Upload a new signature if needed. Accepted formats: JPG, PNG, PDF (max 2MB) ",-1))])])]),(0,a.Lk)("div",j,[(0,a.Lk)("button",{type:"button",onClick:t[3]||(t[3]=t=>e.$router.push("/hod-dashboard/divisional-recommendations")),disabled:U.submitting,class:"px-6 py-3 bg-gray-600/30 hover:bg-gray-600/50 text-gray-200 rounded-lg transition-colors border border-gray-400/30 disabled:opacity-50 disabled:cursor-not-allowed"},[...t[24]||(t[24]=[(0,a.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,a.eW)(" Cancel ",-1)])],8,P),(0,a.Lk)("button",{type:"submit",disabled:!U.canSubmit||U.submitting,class:"px-8 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed relative"},[U.submitting?((0,a.uX)(),(0,a.CE)("span",M,[...t[25]||(t[25]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),(0,a.eW)(" Submitting... ",-1)])])):((0,a.uX)(),(0,a.CE)("span",Q,[...t[26]||(t[26]=[(0,a.Lk)("i",{class:"fas fa-paper-plane mr-2"},null,-1),(0,a.eW)(" Resubmit Request ",-1)])]))],8,W)])],32)])):(0,a.Q3)("",!0)])])])])])])}var N=s(8728),$=s(5498),H=s(8966),K=s(1127),O=s(9423),V={name:"RequestResubmission",components:{Header:$.A,ModernSidebar:H.A},setup(){const e=(0,N.rd)(),t=(0,N.lq)(),{requireRole:s,ROLES:r}=(0,K.h)(),l=(0,a.KR)(!1),o=(0,a.KR)(!1),i=(0,a.KR)(null),n=(0,a.KR)(null),d=(0,a.KR)(null),c=(0,a.KR)({resubmission_notes:"",hod_signature:null}),u=(0,a.EW)(()=>t.params.id),p=(0,a.EW)(()=>c.value.resubmission_notes.trim().length>=50),m=async()=>{try{l.value=!0,i.value=null;const e=await O.A.get(`/hod/divisional-recommendations/${u.value}/details`);if(e.data.success){if(n.value=e.data.data,!n.value.can_resubmit)return void(i.value="This request cannot be resubmitted. Only requests rejected by divisional director can be resubmitted.")}else i.value=e.data.message||"Failed to fetch request details"}catch(e){console.error("Error fetching request details:",e),i.value=e.response?.data?.message||"Failed to fetch request details"}finally{l.value=!1}},b=e=>{const t=e.target.files[0];if(t){if(t.size>2097152)return alert("File size must be less than 2MB"),void(d.value.value="");const e=["image/jpeg","image/jpg","image/png","application/pdf"];if(!e.includes(t.type))return alert("Only JPG, PNG, and PDF files are allowed"),void(d.value.value="");c.value.hod_signature=t}},g=async()=>{try{o.value=!0,i.value=null;const t=new FormData;t.append("resubmission_notes",c.value.resubmission_notes.trim()),c.value.hod_signature&&t.append("hod_signature",c.value.hod_signature);const s=await O.A.post(`/hod/divisional-recommendations/${u.value}/resubmit`,t,{headers:{"Content-Type":"multipart/form-data"}});s.data.success?(alert("Request resubmitted successfully! The divisional director will review your response."),e.push("/hod-dashboard/divisional-recommendations")):i.value=s.data.message||"Failed to resubmit request"}catch(t){console.error("Error resubmitting request:",t),i.value=t.response?.data?.message||"Failed to resubmit request"}finally{o.value=!1}},f=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(i){return e}};return(0,a.sV)(()=>{s([r.HEAD_OF_DEPARTMENT]),m()}),{loading:l,submitting:o,error:i,requestDetails:n,resubmissionForm:c,signatureInput:d,canSubmit:p,fetchRequestDetails:m,handleSignatureUpload:b,submitResubmission:g,formatDate:f}}},B=s(1241);const z=(0,B.A)(V,[["render",U],["__scopeId","data-v-1ac7cf77"]]);var G=z},9423:function(e,t,s){var a=s(4373);const r="/api",l=a.A.create({baseURL:r,timeout:parseInt("30000")||1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}});l.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("session_data"),window.location.href="/login"),Promise.reject(e))),t.A=l}}]);
//# sourceMappingURL=hod.cb70f97f.js.map