"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[1819],{4512:function(e,s,r){r.r(s),r.d(s,{default:function(){return N}});var a=r(5796);const l={class:"flex flex-col h-screen"},t={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-6 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 overflow-y-auto relative"},n={class:"absolute inset-0 overflow-hidden"},i={class:"absolute inset-0 opacity-5"},d={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},u={class:"max-w-9xl mx-auto relative z-10"},c={class:"bg-blue-900 rounded-2xl shadow-2xl overflow-hidden border border-blue-500/40"},m={class:"bg-blue-800 p-6 rounded-t-2xl border-b border-blue-500/30 flex items-center justify-between"},b={key:0,class:"px-6 pt-4 bg-blue-900"},p={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},f={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},x={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},v={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},w={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},g={class:"md:col-span-2"},h={class:"flex flex-col md:flex-row md:items-stretch md:space-x-0"},k={class:"flex-1 md:pr-4 md:border-r md:border-blue-500/40 mb-4 md:mb-0"},y={class:"w-full px-4 py-3 rounded-lg bg-blue-900/40 border border-blue-400/60 text-blue-100 flex items-center justify-between"},L={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},_={class:"md:col-span-2"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},C={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},X={key:0,class:"mt-1 text-xs text-red-300 flex items-center"},F={class:"flex flex-col md:flex-row md:items-center md:justify-between pt-2"},P=["disabled"],W={key:0,class:"fas fa-spinner fa-spin mr-2"},A={key:1,class:"fas fa-save mr-2"};function j(e,s,r,j,D,O){const R=(0,a.g2)("Header"),U=(0,a.g2)("ModernSidebar");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(R),(0,a.Lk)("div",t,[(0,a.bF)(U),(0,a.Lk)("main",o,[(0,a.Lk)("div",n,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",u,[(0,a.Lk)("div",c,[(0,a.Lk)("div",m,[s[13]||(s[13]=(0,a.Fv)('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-teal-500 rounded-xl flex items-center justify-center shadow-lg border border-blue-300/60"><i class="fas fa-user-plus text-white"></i></div><div><h1 class="text-xl md:text-2xl font-bold text-white">Create New Staff User</h1><p class="text-sm text-blue-100"> Heads of Department can register new staff for their department. New users are automatically given the <span class="font-semibold">Staff</span> role. </p></div></div>',1)),(0,a.Lk)("button",{type:"button",onClick:s[0]||(s[0]=(...e)=>j.goBack&&j.goBack(...e)),class:"hidden md:inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm font-medium shadow-lg hover:shadow-xl transition-all duration-200"},[...s[12]||(s[12]=[(0,a.Lk)("i",{class:"fas fa-arrow-left mr-2"},null,-1),(0,a.eW)(" Back to Dashboard ",-1)])])]),j.message?((0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("div",{class:(0,a.C4)(["px-4 py-3 rounded-lg text-sm flex items-center space-x-2","success"===j.messageType?"bg-green-600/20 text-green-100 border border-green-400/60":"bg-red-600/20 text-red-100 border border-red-400/60"])},[(0,a.Lk)("i",{class:(0,a.C4)("success"===j.messageType?"fas fa-check-circle":"fas fa-exclamation-circle")},null,2),(0,a.Lk)("span",null,(0,a.v_)(j.message),1)],2)])):(0,a.Q3)("",!0),(0,a.Lk)("form",{onSubmit:s[11]||(s[11]=(0,a.D$)((...e)=>j.submit&&j.submit(...e),["prevent"])),class:"px-6 pb-6 pt-4 space-y-6 bg-blue-900",autocomplete:"off"},[(0,a.Lk)("div",p,[(0,a.Lk)("div",null,[s[15]||(s[15]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Full Name ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>j.form.name=e),type:"text",class:"w-full px-4 py-3 rounded-lg bg-white/10 border text-white placeholder-blue-200/60 border-blue-300/40 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Enter staff full name"},null,512),[[a.Jo,j.form.name]]),j.errors.name?((0,a.uX)(),(0,a.CE)("p",f,[s[14]||(s[14]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.name),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[s[17]||(s[17]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," PF Number ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>j.form.pf_number=e),type:"text",class:"w-full px-4 py-3 rounded-lg bg-white/10 border text-white placeholder-blue-200/60 border-blue-300/40 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"e.g. PF12345"},null,512),[[a.Jo,j.form.pf_number]]),j.errors.pf_number?((0,a.uX)(),(0,a.CE)("p",x,[s[16]||(s[16]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.pf_number),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[s[19]||(s[19]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Email Address ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>j.form.email=e),type:"email",name:"email",autocomplete:"new-email",onInput:s[4]||(s[4]=e=>j.validateField("email")),class:"w-full px-4 py-3 rounded-lg bg-white/10 border text-white placeholder-blue-200/60 border-blue-300/40 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"staff@example.com"},null,544),[[a.Jo,j.form.email]]),j.errors.email?((0,a.uX)(),(0,a.CE)("p",v,[s[18]||(s[18]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.email),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[s[21]||(s[21]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Phone Number ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>j.form.phone=e),type:"tel",class:"w-full px-4 py-3 rounded-lg bg-white/10 border text-white placeholder-blue-200/60 border-blue-300/40 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"e.g. 0712345678 or +255712345678"},null,512),[[a.Jo,j.form.phone]]),j.errors.phone?((0,a.uX)(),(0,a.CE)("p",w,[s[20]||(s[20]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.phone),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",g,[(0,a.Lk)("div",h,[(0,a.Lk)("div",k,[s[24]||(s[24]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Department ",-1)),(0,a.Lk)("div",y,[(0,a.Lk)("span",null,(0,a.v_)(j.departmentLabel),1),s[22]||(s[22]=(0,a.Lk)("span",{class:"px-3 py-1 rounded-full text-xs font-semibold bg-blue-500/30 border border-blue-300/60"}," Assigned automatically ",-1))]),s[25]||(s[25]=(0,a.Lk)("p",{class:"mt-1 text-xs text-blue-200/80"}," New users are linked to one of your departments. Only Heads of Department can perform this action. ",-1)),j.errors.department_id?((0,a.uX)(),(0,a.CE)("p",L,[s[23]||(s[23]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.department_id),1)])):(0,a.Q3)("",!0)]),s[26]||(s[26]=(0,a.Fv)('<div class="flex-1 md:pl-4"><label class="block text-sm font-semibold text-blue-100 mb-2"> Role </label><div class="w-full px-4 py-3 rounded-lg bg-blue-900/40 border border-blue-400/60 text-blue-100 flex items-center justify-between"><span class="flex items-center space-x-2"><i class="fas fa-id-badge text-blue-200"></i><span class="font-semibold">Staff (default)</span></span><span class="px-3 py-1 rounded-full text-xs font-semibold bg-blue-500/30 border border-blue-300/60"> Fixed role </span></div><p class="mt-1 text-xs text-blue-200/80"> Role is fixed to <strong>Staff</strong> for users created by Heads of Department. Admins can later adjust roles if needed. </p></div>',1))])]),(0,a.Lk)("div",_,[(0,a.Lk)("div",E,[(0,a.Lk)("div",null,[s[28]||(s[28]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Password ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>j.form.password=e),type:"password",name:"password",autocomplete:"new-password",onInput:s[7]||(s[7]=e=>j.validateField("password")),class:"w-full px-4 py-3 rounded-lg bg-blue-900/40 border border-blue-400/60 text-blue-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Minimum 8 characters"},null,544),[[a.Jo,j.form.password]]),j.errors.password?((0,a.uX)(),(0,a.CE)("p",C,[s[27]||(s[27]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.password),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",null,[s[30]||(s[30]=(0,a.Lk)("label",{class:"block text-sm font-semibold text-blue-100 mb-2"}," Confirm Password ",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[8]||(s[8]=e=>j.form.password_confirmation=e),type:"password",name:"password_confirmation",autocomplete:"new-password",onInput:s[9]||(s[9]=e=>j.validateField("password_confirmation")),class:"w-full px-4 py-3 rounded-lg bg-blue-900/40 border border-blue-400/60 text-blue-100 placeholder-blue-200/70 focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"Re-enter password"},null,544),[[a.Jo,j.form.password_confirmation]]),j.errors.password_confirmation?((0,a.uX)(),(0,a.CE)("p",X,[s[29]||(s[29]=(0,a.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(j.errors.password_confirmation),1)])):(0,a.Q3)("",!0)])])])]),(0,a.Lk)("div",F,[(0,a.Lk)("button",{type:"button",onClick:s[10]||(s[10]=(...e)=>j.goBack&&j.goBack(...e)),class:"mb-3 md:mb-0 inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 text-sm font-medium shadow-md hover:shadow-lg transition-all duration-200"},[...s[31]||(s[31]=[(0,a.Lk)("i",{class:"fas fa-arrow-left mr-2"},null,-1),(0,a.eW)(" Back ",-1)])]),(0,a.Lk)("button",{type:"submit",disabled:j.submitting,class:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-60 disabled:cursor-not-allowed border border-blue-300/60 text-sm md:text-base transition-all duration-200"},[j.submitting?((0,a.uX)(),(0,a.CE)("i",W)):((0,a.uX)(),(0,a.CE)("i",A)),(0,a.eW)(" "+(0,a.v_)(j.submitting?"Creating User...":"Create User"),1)],8,P)])],32)])])])])])}r(4114),r(8111),r(7588);var D=r(8728),O=r(5498),R=r(8966),U=r(1127),S={name:"HodCreateUser",components:{Header:O.A,ModernSidebar:R.A},setup(){const e=(0,D.rd)(),{user:s,ROLES:l,requireRole:t}=(0,U.h)(),o=(0,a.KR)({name:"",email:"",phone:"",pf_number:"",password:"",password_confirmation:""}),n=(0,a.KR)({}),i=(0,a.KR)(""),d=(0,a.KR)("success"),u=(0,a.KR)(!1),c=(0,a.EW)(()=>{const e=s.value,r=e?.department;return r&&r.id?r.id:e?.department_id||null}),m=(0,a.EW)(()=>{const e=s.value,r=e?.department;return r?r.display_name||r.full_name||r.name||(r.code?`${r.name} (${r.code})`:r.code):e?.department_display_name||e?.department_full_name||e?.department_name||e?.department_code||"Not specified"}),b=(e,s="success")=>{i.value=e,d.value=s},p=e=>{if(!e)return"";let s=String(e).trim().replace(/\s|-/g,"");return s.startsWith("+255")?s:s.startsWith("255")?"+"+s:s.startsWith("0")?"+255"+s.slice(1):s},f=e=>{if(n.value[e]){const s={...n.value};delete s[e],n.value=s}"email"===e&&(o.value.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.value.email.trim())||(n.value={...n.value,email:"Enter a valid email address."}):n.value={...n.value,email:"Email is required."}),"password"===e&&(o.value.password?o.value.password.length<8&&(n.value={...n.value,password:"Password must be at least 8 characters."}):n.value={...n.value,password:"Password is required."},o.value.password_confirmation&&f("password_confirmation")),"password_confirmation"===e&&(o.value.password_confirmation?o.value.password!==o.value.password_confirmation&&(n.value={...n.value,password_confirmation:"Passwords do not match."}):n.value={...n.value,password_confirmation:"Please confirm the password."})},x=()=>{const e={};return o.value.name.trim()||(e.name="Full name is required."),o.value.pf_number.trim()||(e.pf_number="PF number is required."),o.value.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.value.email.trim())||(e.email="Enter a valid email address."):e.email="Email is required.",o.value.phone=p(o.value.phone),o.value.phone.trim()?/^\+255\d{9}$/.test(o.value.phone)||(e.phone="Phone must be in the format +255XXXXXXXXX."):e.phone="Phone number is required.",o.value.password?o.value.password.length<8&&(e.password="Password must be at least 8 characters."):e.password="Password is required.",o.value.password_confirmation?o.value.password!==o.value.password_confirmation&&(e.password_confirmation="Passwords do not match."):e.password_confirmation="Please confirm the password.",c.value||(e.department_id="Your department is not set. Please contact the system administrator."),n.value=e,0===Object.keys(e).length},v=async()=>{if(x()){u.value=!0,b("");try{const e={name:o.value.name.trim(),email:o.value.email.trim().toLowerCase(),phone:p(o.value.phone.trim()),pf_number:o.value.pf_number.trim(),password:o.value.password,password_confirmation:o.value.password_confirmation,department_id:c.value},{default:s}=await r.e(5493).then(r.bind(r,5493)),a=await s.createUser(e);if(a.success)b("Staff user created successfully.","success"),o.value={name:"",email:"",phone:"",pf_number:"",password:"",password_confirmation:""},n.value={};else{const e=a.errors||{};if(Object.keys(e).length){const s={};Object.entries(e).forEach(([e,r])=>{s[e]=Array.isArray(r)?r[0]:r}),n.value={...n.value,...s};const r=Object.keys(s)[0];b(r?s[r]:a.message||"Failed to create user.","error")}else b(a.message||"Failed to create user.","error")}}catch(e){if(422===e.response?.status&&e.response.data?.errors){const s=e.response.data.errors,r={};Object.entries(s).forEach(([e,s])=>{r[e]=Array.isArray(s)?s[0]:s}),n.value=r;const a=Object.keys(r)[0];b(r[a]||"Validation failed.","error")}else console.error("Error creating HOD staff user:",e),b("An unexpected error occurred while creating the user.","error")}finally{u.value=!1}}else b("Please correct the highlighted errors and try again.","error")},w=()=>{e.push("/hod-dashboard")};return(0,a.sV)(()=>{t([l.HEAD_OF_DEPARTMENT,l.HEAD_OF_IT])}),{form:o,errors:n,message:i,messageType:d,submitting:u,departmentLabel:m,submit:v,goBack:w,validateField:f}}},H=r(1241);const q=(0,H.A)(S,[["render",j]]);var N=q}}]);
//# sourceMappingURL=1819.fa28acd0.js.map