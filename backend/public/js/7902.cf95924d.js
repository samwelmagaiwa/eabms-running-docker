"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[624,1075,7902],{1075:function(e,t,a){a.r(t);var r=a(4373);const o="/api";class i{constructor(){this.api=r.A.create({baseURL:o,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),this.api.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))}async sign(e){const t=await this.api.post("/documents/sign",{document_id:e});return{success:!0,data:t.data}}async list(e){const t=await this.api.get(`/documents/${e}/signatures`);return{success:!0,data:t.data.data}}async verify(e){const t=await this.api.get(`/signatures/${e}/verify`);return{success:t.data.success,data:t.data}}}t["default"]=new i},1127:function(e,t,a){a.d(t,{h:function(){return n}});a(4114);var r=a(5796),o=a(8728),i=a(14),s=a(9553);function n(){const e=(0,o.rd)(),t=(0,i.useAuthStore)(),n=(0,r.EW)(()=>t.user),l=(0,r.EW)(()=>t.token),d=(0,r.EW)(()=>t.isAuthenticated),c=(0,r.EW)(()=>t.userPermissions),u=(0,r.EW)(()=>t.userRole),m=(0,r.EW)(()=>t.userRoles),p=(0,r.EW)(()=>t.isLoading),f=(0,r.EW)(()=>t.error),h=(0,r.EW)(()=>t.isAdmin),g=(0,r.EW)(()=>t.isStaff),b=(0,r.EW)(()=>t.isApprover),v=(0,r.EW)(()=>n.value?.name||"User"),x=async r=>{try{const{authService:o}=await a.e(981).then(a.bind(a,981)),i=await o.login(r);if(i.success){const{user:a,token:r}=i.data;t.setAuthData({user:a,token:r});let o=(0,s.getDefaultDashboard)(t.userRole)||"/user-dashboard";a?.needs_onboarding&&"admin"!==t.userRole&&(o="/onboarding");const n=e.currentRoute.value.query.redirect;return n&&"string"===typeof n&&(o=n),await e.push(o),{success:!0,user:a}}{let e=i.message||"Login failed";if(i.errors&&"object"===typeof i.errors){const t=["email","password"];for(const a of t){const t=i.errors[a];if(Array.isArray(t)&&t.length>0){e=t[0];break}}}return console.error("❌ Login failed:",e),t.setError(e),{success:!1,message:e}}}catch(f){return console.error("❌ Login error in composable:",f),t.setError(f.message||"Login failed"),{success:!1,message:f.message||"Login failed"}}},y=async()=>{try{const{authService:r}=await a.e(981).then(a.bind(a,981));return await r.logout(),t.clearAuth(),await e.push("/login"),{success:!0}}catch(f){return t.clearAuth(),await e.push("/login"),{success:!0}}},w=async()=>{try{const{authService:r}=await a.e(981).then(a.bind(a,981)),o=await r.logoutAll();return t.clearAuth(),await e.push("/login"),o.success?o:{success:!0}}catch(f){return t.clearAuth(),await e.push("/login"),{success:!0}}},k=e=>{t.updateUser(e)},L=()=>{t.clearError()},S=e=>t.hasPermission(e),D=e=>t.hasRole(e),C=e=>!e.meta?.roles||D(e.meta.roles),E=e=>{if(!D(e)){const t=Array.isArray(e)?e.join(", "):e;throw new Error(`Access denied. Required role(s): ${t}`)}},P=e=>{if(!e)return"User";const t={[s.gg.ADMIN]:"Administrator",[s.gg.DIVISIONAL_DIRECTOR]:"Divisional Director",[s.gg.HEAD_OF_DEPARTMENT]:"Head of Department",[s.gg.ICT_DIRECTOR]:"ICT Director",[s.gg.HEAD_OF_IT]:"Head of IT",[s.gg.STAFF]:"D. IN MEDICINE",[s.gg.ICT_OFFICER]:"ICT Officer",[s.gg.SECRETARY_ICT]:"Secretary ICT"};return t[e]||e};return{user:n,userName:v,token:l,isAuthenticated:d,userPermissions:c,userRole:u,userRoles:m,isLoading:p,error:f,isAdmin:h,isStaff:g,isApprover:b,login:x,logout:y,logoutAll:w,updateUser:k,clearError:L,hasPermission:S,hasRole:D,canAccessRoute:C,requireRole:E,getRoleDisplayName:P,ROLES:s.gg}}},2557:function(e,t,a){a(4114);var r=a(274);class o{async getCurrentUserProfile(){try{const e=await r.A.get("/profile/current");if(e.data&&e.data.success)return e.data.data,{success:!0,data:e.data.data};throw new Error(e.data?.message||"Failed to retrieve user profile")}catch(e){return console.error("❌ Error fetching user profile:",e),{success:!1,error:e.message||"Failed to retrieve user profile",data:null}}}async getUserByPfNumber(e){try{const t=await r.A.post("/profile/lookup-pf",{pf_number:e});return t.data&&t.data.success?(t.data.data,{success:!0,data:t.data.data}):{success:!1,message:t.data?.message||"User not found",data:null}}catch(t){return console.error("❌ Error looking up user:",t),{success:!1,error:t.response?.data?.message||t.message||"Failed to look up user",data:null}}}async checkPfNumberExists(e){try{const t=await r.A.post("/profile/check-pf",{pf_number:e});if(t.data&&t.data.success)return{success:!0,exists:t.data.exists,pfNumber:e};throw new Error(t.data?.message||"Failed to check PF Number")}catch(t){return console.error("❌ Error checking PF Number:",t),{success:!1,error:t.message||"Failed to check PF Number",exists:!1}}}async getDepartments(){try{const e=await r.A.get("/profile/departments");if(e.data&&e.data.success)return e.data.count,{success:!0,data:e.data.data,count:e.data.count};throw new Error(e.data?.message||"Failed to retrieve departments")}catch(e){return console.error("❌ Error fetching departments:",e),{success:!1,error:e.message||"Failed to retrieve departments",data:[]}}}async updateCurrentUserProfile(e){try{const t=await r.A.put("/profile/current",e);if(t.data&&t.data.success)return{success:!0,data:t.data.data,message:"Profile updated successfully"};throw new Error(t.data?.message||"Failed to update profile")}catch(t){return console.error("❌ Error updating profile:",t),{success:!1,error:t.response?.data?.message||t.message||"Failed to update profile",errors:t.response?.data?.errors||null}}}async getFormAutoPopulationData(){try{const e=await this.getCurrentUserProfile();if(e.success){const t=e.data,a={pfNumber:t.pf_number||"",staffName:t.staff_name||t.full_name||"",fullName:t.full_name||t.name||"",phoneNumber:t.phone||t.phone_number||"",email:t.email||"",departmentId:t.department_id||null,departmentName:t.department?.name||"",departmentCode:t.department?.code||"",departmentFullName:t.department?.display_name||t.department?.full_name||"",userId:t.id,primaryRole:t.primary_role||"",roles:t.roles||[],isActive:!1!==t.is_active};return{success:!0,data:a,message:"Form data populated successfully"}}return e}catch(e){return console.error("❌ Error preparing form auto-population data:",e),{success:!1,error:e.message||"Failed to prepare form data",data:null}}}validateUserData(e){const t=[];return e.pfNumber&&""!==e.pfNumber.trim()||t.push("PF Number is required"),e.staffName&&""!==e.staffName.trim()||t.push("Staff Name is required"),e.phoneNumber&&""!==e.phoneNumber.trim()||t.push("Phone Number is required"),e.departmentId||t.push("Department is required"),{isValid:0===t.length,errors:t}}}t.A=new o},4247:function(e,t,a){a.d(t,{A:function(){return d}});var r=a(5796);const o={class:"center-logo"};function i(e,t,a,i,s,n){return(0,r.uX)(),(0,r.CE)("div",{class:(0,r.C4)(["orbiting-dots",n.sizeClass]),style:(0,r.Tr)(n.customSize)},[(0,r.Lk)("div",o,[(0,r.Lk)("img",{src:"/assets/images/logo2.png",alt:"Loading",class:"logo-img",onError:t[0]||(t[0]=(...e)=>n.handleImageError&&n.handleImageError(...e))},null,32)]),(0,r.Lk)("div",{class:"orbit",style:(0,r.Tr)(n.orbitStyle)},[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.dots,(e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:`dot-${t}`,class:(0,r.C4)(`dot ${e.color}`),style:(0,r.Tr)(n.getDotStyle(t))},null,6))),128))],4)],6)}var s={name:"OrbitingDots",props:{size:{type:String,default:"sm"},customWidth:{type:Number,default:null},customHeight:{type:Number,default:null},speed:{type:Number,default:3}},data(){return{updateFrequency:50,dots:[{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"},{color:"logo-red"},{color:"logo-gold"},{color:"logo-white"}]}},computed:{sizeClass(){return this.customWidth||this.customHeight?"":`size-${this.size}`},customSize(){return this.customWidth||this.customHeight?{width:this.customWidth?`${this.customWidth}px`:"auto",height:this.customHeight?`${this.customHeight}px`:"auto"}:{}},dotSpacing(){return 360/this.dots.length},orbitRadius(){if(this.customWidth)return Math.max(8,this.customWidth/4);switch(this.size){case"xs":return 6;case"sm":return 8;case"md":return 12;case"lg":return 16;case"xl":return 24;case"2xl":return 45;default:return 8}},currentContainerSize(){if(this.customWidth)return this.customWidth;switch(this.size){case"xs":return 16;case"sm":return 20;case"md":return 28;case"lg":return 36;case"xl":return 64;case"2xl":return 120;default:return 20}},durationSeconds(){const e=this.speed*(1e3/this.updateFrequency),t=e>0?360/e:1.5;return Math.max(.8,Math.min(t,4))},orbitStyle(){return{"--orbit-duration":`${this.durationSeconds}s`}}},methods:{getDotStyle(e){const t=e*this.dotSpacing,a=this.orbitRadius;return{top:"50%",left:"50%",transform:`translate(-50%, -50%) rotate(${t}deg) translateX(${a}px)`}},handleImageError(){const e=this.$el?.querySelector(".center-logo");e&&(e.style.display="none")}}},n=a(1241);const l=(0,n.A)(s,[["render",i],["__scopeId","data-v-088d0f9c"]]);var d=l},8976:function(e,t,a){a.r(t),a.d(t,{default:function(){return oa}});var r=a(5796);const o={class:"min-h-screen bg-gray-100"};function i(e,t,a,i,s,n){const l=(0,r.g2)("OnboardingFlow");return(0,r.uX)(),(0,r.CE)("div",o,[i.currentUser?((0,r.uX)(),(0,r.Wv)(l,{key:0,"user-name":i.currentUser.name,"user-id":i.currentUser.id,onOnboardingComplete:i.handleOnboardingComplete,onReturnToLogin:i.handleReturnToLogin},null,8,["user-name","user-id","onOnboardingComplete","onReturnToLogin"])):(0,r.Q3)("",!0)])}a(4114);var s=a(1127),n=a(8728);const l={key:1};function d(e,t,a,o,i,s){const n=(0,r.g2)("SimpleLoadingBanner"),d=(0,r.g2)("OnboardingPopup"),c=(0,r.g2)("TermsOfService"),u=(0,r.g2)("IctPolicy"),m=(0,r.g2)("DeclarationForm"),p=(0,r.g2)("SuccessPopup");return(0,r.uX)(),(0,r.CE)("div",null,[i.loading?((0,r.uX)(),(0,r.Wv)(n,{key:0,show:i.loading,"auto-start":!0,onLoadingComplete:s.onLoadingComplete},null,8,["show","onLoadingComplete"])):((0,r.uX)(),(0,r.CE)("div",l,["terms-popup"===i.currentStep?((0,r.uX)(),(0,r.Wv)(d,{key:0,title:"Welcome to Muhimbili National Hospital",message:"Click to read the Organization Terms of Service","button-text":"Read Terms of Service",icon:"fas fa-file-pen","show-return-to-login":!0,onClick:s.showTermsOfService,onReturnToLogin:s.returnToLogin},null,8,["onClick","onReturnToLogin"])):(0,r.Q3)("",!0),"terms-page"===i.currentStep?((0,r.uX)(),(0,r.Wv)(c,{key:1,onTermsAccepted:s.onTermsAccepted,onGoBack:s.goToPreviousStep},null,8,["onTermsAccepted","onGoBack"])):(0,r.Q3)("",!0),"policy-popup"===i.currentStep?((0,r.uX)(),(0,r.Wv)(d,{key:2,title:"ICT Policy Review",message:"Press to read Organization ICT Policy","button-text":"Read ICT Policy",icon:"fas fa-shield-alt","show-return-to-login":!0,onClick:s.showIctPolicy,onReturnToLogin:s.returnToLogin},null,8,["onClick","onReturnToLogin"])):(0,r.Q3)("",!0),"policy-page"===i.currentStep?((0,r.uX)(),(0,r.Wv)(u,{key:3,onPolicyAccepted:s.onPolicyAccepted,onGoBack:s.goToPreviousStep},null,8,["onPolicyAccepted","onGoBack"])):(0,r.Q3)("",!0),"declaration"===i.currentStep?((0,r.uX)(),(0,r.Wv)(m,{key:4,onFormSubmitted:s.onDeclarationSubmitted,onGoBack:s.goToPreviousStep},null,8,["onFormSubmitted","onGoBack"])):(0,r.Q3)("",!0),"success"===i.currentStep?((0,r.uX)(),(0,r.Wv)(p,{key:5,"user-name":a.userName,"user-role-display":i.userRoleDisplay,message:"You have successfully completed the onboarding process. Now you can proceed with your requests.",onContinue:s.completeOnboarding},null,8,["user-name","user-role-display","onContinue"])):(0,r.Q3)("",!0)]))])}a(8111),a(2489),a(3110),a(8335);const c={class:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-end z-50 p-4 backdrop-blur-sm"},u={class:"ultra-glass rounded-3xl max-w-md w-full transform transition-all duration-500 scale-100 animate-slideInRight relative z-10 border border-white border-opacity-30 shadow-2xl mr-8"},m={class:"transparent-body p-8 text-center relative"},p={class:"relative z-10"},f={class:"text-white text-2xl leading-relaxed mb-8 drop-shadow-glow font-semibold tracking-wide text-shadow-strong"},h={class:"space-y-4"};function g(e,t,a,o,i,s){return(0,r.uX)(),(0,r.CE)("div",c,[t[5]||(t[5]=(0,r.Lk)("div",{class:"absolute inset-0 bg-cover bg-center bg-no-repeat opacity-800",style:{"background-image":"url('/assets/images/image1.jpg')"}},null,-1)),(0,r.Lk)("div",u,[(0,r.Lk)("div",m,[t[4]||(t[4]=(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-t from-white from-opacity-2 to-transparent rounded-b-3xl"},null,-1)),(0,r.Lk)("div",p,[(0,r.Lk)("p",f,(0,r.v_)(a.message),1),(0,r.Lk)("div",h,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.handleClick&&s.handleClick(...e)),class:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 bg-opacity-90 text-white py-5 px-8 rounded-2xl font-bold text-lg hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 shadow-xl hover:shadow-2xl backdrop-blur-md border border-white border-opacity-20 glow-effect"},[t[2]||(t[2]=(0,r.Lk)("i",{class:"fas fa-arrow-right mr-3"},null,-1)),(0,r.eW)(" "+(0,r.v_)(a.buttonText),1)]),a.showReturnToLogin?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>s.handleReturnToLogin&&s.handleReturnToLogin(...e)),class:"w-full bg-gradient-to-r from-gray-600 to-gray-700 bg-opacity-80 text-white py-4 px-8 rounded-2xl font-semibold text-base hover:from-gray-700 hover:to-gray-800 focus:outline-none focus:ring-4 focus:ring-gray-300 focus:ring-offset-2 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl backdrop-blur-md border border-white border-opacity-10"},[...t[3]||(t[3]=[(0,r.Lk)("i",{class:"fas fa-arrow-left mr-3"},null,-1),(0,r.eW)(" Return to Login ",-1)])])):(0,r.Q3)("",!0)])])])])])}var b={name:"OnboardingPopup",props:{title:{type:String,required:!0},message:{type:String,required:!0},buttonText:{type:String,default:"Continue"},icon:{type:String,default:"fas fa-info-circle"},showReturnToLogin:{type:Boolean,default:!1}},emits:["click","return-to-login"],methods:{handleClick(){this.$emit("click")},handleReturnToLogin(){this.$emit("return-to-login")}}},v=a(1241);const x=(0,v.A)(b,[["render",g],["__scopeId","data-v-6f92fbce"]]);var y=x;const w={class:"relative"},k={class:"fixed top-0 left-0 right-0 z-50"},L={class:"w-full px-6 py-2 flex items-center justify-center min-h-[80px]"},S={key:0,class:"flex items-center justify-center w-full max-w-lg"},D={class:"bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl px-6 py-4 shadow-xl border border-white/20 text-center"},C={class:"flex items-center justify-center space-x-4"},E={class:"text-center"},P={class:"text-2xl font-bold text-white mb-1"},_={class:"text-amber-100 text-xs"},T={class:"w-12 h-12"},N={class:"w-12 h-12 transform -rotate-90",viewBox:"0 0 48 48"},A=["stroke-dashoffset"],I={key:1,class:"flex items-center justify-center w-full max-w-md"},F={class:"pt-24"},R={class:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-40"},O={class:"bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl px-8 py-4 shadow-2xl border border-white/20"},z={class:"flex items-center space-x-4"},X={class:"flex items-center cursor-pointer"};function j(e,t,a,o,i,s){const n=(0,r.g2)("TermsOfServiceMain");return(0,r.uX)(),(0,r.CE)("div",w,[(0,r.Lk)("div",k,[(0,r.Lk)("div",L,[i.timerFinished?((0,r.uX)(),(0,r.CE)("div",I,[...t[5]||(t[5]=[(0,r.Fv)('<div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-2xl px-6 py-4 shadow-xl border border-white/20 text-center" data-v-4fec90a4><div class="flex flex-col items-center space-y-2" data-v-4fec90a4><div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center animate-bounce" data-v-4fec90a4><i class="fas fa-arrow-down text-lg animate-pulse" data-v-4fec90a4></i></div><p class="text-white font-medium text-sm" data-v-4fec90a4>Scroll Down</p></div></div>',1)])])):((0,r.uX)(),(0,r.CE)("div",S,[(0,r.Lk)("div",D,[(0,r.Lk)("div",C,[t[4]||(t[4]=(0,r.Lk)("div",{class:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center animate-spin"},[(0,r.Lk)("i",{class:"fas fa-clock text-lg"})],-1)),(0,r.Lk)("div",E,[(0,r.Lk)("div",P,(0,r.v_)(s.formatTime(i.timeRemaining)),1),(0,r.Lk)("p",_,"Please wait "+(0,r.v_)(i.timeRemaining)+"s",1)]),(0,r.Lk)("div",T,[((0,r.uX)(),(0,r.CE)("svg",N,[t[3]||(t[3]=(0,r.Lk)("circle",{cx:"24",cy:"24",r:"20",stroke:"rgba(255,255,255,0.2)","stroke-width":"3",fill:"none"},null,-1)),(0,r.Lk)("circle",{cx:"24",cy:"24",r:"20",stroke:"white","stroke-width":"3",fill:"none","stroke-dasharray":125.66,"stroke-dashoffset":125.66-125.66*s.progressPercentage/100,class:"transition-all duration-1000 ease-out"},null,8,A)]))])])])]))])]),(0,r.Lk)("div",F,[(0,r.bF)(n)]),(0,r.Lk)("div",R,[(0,r.Lk)("div",O,[(0,r.Lk)("div",z,[(0,r.Lk)("label",X,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.termsAccepted=e),type:"checkbox",class:"w-5 h-5 text-emerald-600 border-2 border-white rounded-lg focus:ring-emerald-400 focus:ring-2 mr-3 bg-white/20"},null,512),[[r.lH,i.termsAccepted]]),t[6]||(t[6]=(0,r.Lk)("span",{class:"text-white font-medium"},"I accept the Terms of Service",-1))]),i.termsAccepted?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>s.acceptTerms&&s.acceptTerms(...e)),class:"bg-white text-emerald-600 px-6 py-2 rounded-xl font-bold hover:bg-emerald-50 focus:outline-none focus:ring-4 focus:ring-white/50 transition-all duration-300 shadow-lg transform hover:scale-105"},[...t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-arrow-right mr-2"},null,-1),(0,r.eW)(" Accept & Proceed ",-1)])])):(0,r.Q3)("",!0)])])]),(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>s.goBack&&s.goBack(...e)),class:"fixed bottom-6 left-6 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 z-40 group",title:"Go Back"},[...t[8]||(t[8]=[(0,r.Lk)("i",{class:"fas fa-arrow-left text-lg group-hover:animate-pulse"},null,-1)])])])}var W=a(4786),B={name:"OnboardingTermsOfService",components:{TermsOfServiceMain:W["default"]},emits:["terms-accepted","go-back"],data(){return{timeRemaining:5,timerFinished:!1,termsAccepted:!1,timer:null}},computed:{progressPercentage(){return(5-this.timeRemaining)/5*100}},mounted(){this.startTimer()},beforeUnmount(){this.timer&&clearInterval(this.timer)},methods:{startTimer(){this.timer=setInterval(()=>{this.timeRemaining>0?this.timeRemaining--:(this.timerFinished=!0,clearInterval(this.timer))},1e3)},formatTime(e){const t=Math.floor(e/60),a=e%60;return`${t}:${a.toString().padStart(2,"0")}`},acceptTerms(){this.showSuccessMessage("Terms of Service accepted successfully! You may now proceed with your access request."),setTimeout(()=>{this.$emit("terms-accepted")},2e3)},showSuccessMessage(e){const t=document.createElement("div");t.className="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-8 py-6 rounded-2xl shadow-2xl z-50 max-w-md text-center border border-white/20",t.innerHTML=`\n        <div class="flex items-center justify-center mb-3">\n          <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mr-3">\n            <i class="fas fa-check-circle text-2xl"></i>\n          </div>\n          <h3 class="text-xl font-bold">Success!</h3>\n        </div>\n        <p class="text-emerald-100 leading-relaxed">${e}</p>\n      `;const a=document.createElement("div");a.className="fixed inset-0 bg-black/50 z-40 backdrop-blur-sm",document.body.appendChild(a),document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t),document.body.contains(a)&&document.body.removeChild(a)},2e3)},goBack(){this.$emit("go-back")}}};const U=(0,v.A)(B,[["render",j],["__scopeId","data-v-4fec90a4"]]);var $=U;const M={class:"relative"},q={class:"fixed top-0 left-0 right-0 z-50"},V={class:"w-full px-6 py-2 flex items-center justify-center min-h-[80px]"},H={key:0,class:"flex items-center justify-center w-full max-w-lg"},Q={class:"bg-gradient-to-r from-amber-500 to-orange-500 text-white rounded-2xl px-6 py-4 shadow-xl border border-white/20 text-center"},Y={class:"flex items-center justify-center space-x-4"},G={class:"text-center"},J={class:"text-2xl font-bold text-white mb-1"},K={class:"text-amber-100 text-xs"},Z={class:"w-12 h-12"},ee={class:"w-12 h-12 transform -rotate-90",viewBox:"0 0 48 48"},te=["stroke-dashoffset"],ae={key:1,class:"flex items-center justify-center w-full max-w-md"},re={class:"pt-24"},oe={class:"fixed bottom-20 left-1/2 transform -translate-x-1/2 z-40"},ie={class:"bg-gradient-to-r from-emerald-500 to-teal-500 text-white rounded-2xl px-8 py-4 shadow-2xl border border-white/20"},se={class:"flex items-center space-x-4"},ne={class:"flex items-center cursor-pointer"};function le(e,t,a,o,i,s){const n=(0,r.g2)("IctPolicyMain");return(0,r.uX)(),(0,r.CE)("div",M,[(0,r.Lk)("div",q,[(0,r.Lk)("div",V,[i.timerFinished?((0,r.uX)(),(0,r.CE)("div",ae,[...t[5]||(t[5]=[(0,r.Fv)('<div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-2xl px-6 py-4 shadow-xl border border-white/20 text-center" data-v-22f64f30><div class="flex flex-col items-center space-y-2" data-v-22f64f30><div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center animate-bounce" data-v-22f64f30><i class="fas fa-arrow-down text-lg animate-pulse" data-v-22f64f30></i></div><p class="text-white font-medium text-sm" data-v-22f64f30>Scroll Down</p></div></div>',1)])])):((0,r.uX)(),(0,r.CE)("div",H,[(0,r.Lk)("div",Q,[(0,r.Lk)("div",Y,[t[4]||(t[4]=(0,r.Lk)("div",{class:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center animate-spin"},[(0,r.Lk)("i",{class:"fas fa-clock text-lg"})],-1)),(0,r.Lk)("div",G,[(0,r.Lk)("div",J,(0,r.v_)(s.formatTime(i.timeRemaining)),1),(0,r.Lk)("p",K,"Please wait "+(0,r.v_)(i.timeRemaining)+"s",1)]),(0,r.Lk)("div",Z,[((0,r.uX)(),(0,r.CE)("svg",ee,[t[3]||(t[3]=(0,r.Lk)("circle",{cx:"24",cy:"24",r:"20",stroke:"rgba(255,255,255,0.2)","stroke-width":"3",fill:"none"},null,-1)),(0,r.Lk)("circle",{cx:"24",cy:"24",r:"20",stroke:"white","stroke-width":"3",fill:"none","stroke-dasharray":125.66,"stroke-dashoffset":125.66-125.66*s.progressPercentage/100,class:"transition-all duration-1000 ease-out"},null,8,te)]))])])])]))])]),(0,r.Lk)("div",re,[(0,r.bF)(n)]),(0,r.Lk)("div",oe,[(0,r.Lk)("div",ie,[(0,r.Lk)("div",se,[(0,r.Lk)("label",ne,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.policyAccepted=e),type:"checkbox",class:"w-5 h-5 text-emerald-600 border-2 border-white rounded-lg focus:ring-emerald-400 focus:ring-2 mr-3 bg-white/20"},null,512),[[r.lH,i.policyAccepted]]),t[6]||(t[6]=(0,r.Lk)("span",{class:"text-white font-medium"},"I accept the ICT Policy",-1))]),i.policyAccepted?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>s.acceptPolicy&&s.acceptPolicy(...e)),class:"bg-white text-emerald-600 px-6 py-2 rounded-xl font-bold hover:bg-emerald-50 focus:outline-none focus:ring-4 focus:ring-white/50 transition-all duration-300 shadow-lg transform hover:scale-105"},[...t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-arrow-right mr-2"},null,-1),(0,r.eW)(" Accept & Proceed ",-1)])])):(0,r.Q3)("",!0)])])]),(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>s.goBack&&s.goBack(...e)),class:"fixed bottom-6 left-6 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 z-40 group",title:"Go Back"},[...t[8]||(t[8]=[(0,r.Lk)("i",{class:"fas fa-arrow-left text-lg group-hover:animate-pulse"},null,-1)])])])}var de=a(8022),ce={name:"OnboardingIctPolicy",components:{IctPolicyMain:de["default"]},emits:["policy-accepted","go-back"],data(){return{timeRemaining:5,timerFinished:!1,policyAccepted:!1,timer:null}},computed:{progressPercentage(){return(5-this.timeRemaining)/5*100}},mounted(){this.startTimer()},beforeUnmount(){this.timer&&clearInterval(this.timer)},methods:{startTimer(){this.timer=setInterval(()=>{this.timeRemaining>0?this.timeRemaining--:(this.timerFinished=!0,clearInterval(this.timer))},1e3)},formatTime(e){const t=Math.floor(e/60),a=e%60;return`${t}:${a.toString().padStart(2,"0")}`},acceptPolicy(){this.showSuccessMessage("ICT Policy accepted successfully! You may now proceed with your access request."),setTimeout(()=>{this.$emit("policy-accepted")},2e3)},showSuccessMessage(e){const t=document.createElement("div");t.className="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gradient-to-r from-emerald-500 to-teal-500 text-white px-8 py-6 rounded-2xl shadow-2xl z-50 max-w-md text-center border border-white/20",t.innerHTML=`\n        <div class="flex items-center justify-center mb-3">\n          <div class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center mr-3">\n            <i class="fas fa-check-circle text-2xl"></i>\n          </div>\n          <h3 class="text-xl font-bold">Success!</h3>\n        </div>\n        <p class="text-emerald-100 leading-relaxed">${e}</p>\n      `;const a=document.createElement("div");a.className="fixed inset-0 bg-black/50 z-40 backdrop-blur-sm",document.body.appendChild(a),document.body.appendChild(t),setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t),document.body.contains(a)&&document.body.removeChild(a)},2e3)},goBack(){this.$emit("go-back")}}};const ue=(0,v.A)(ce,[["render",le],["__scopeId","data-v-22f64f30"]]);var me=ue;const pe=["aria-busy"],fe={class:"absolute inset-0 overflow-hidden pointer-events-none"},he={class:"absolute inset-0 opacity-5"},ge={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},be={class:"absolute inset-0"},ve={class:"max-w-none mx-auto relative z-10 px-4 sm:px-6 lg:px-8 xl:px-12 2xl:px-16 3xl:px-20"},xe={class:"medical-glass-card rounded-b-3xl overflow-hidden"},ye={class:"medical-card bg-gradient-to-r from-blue-600/25 to-blue-700/25 border-2 border-blue-400/40 p-2 rounded-xl backdrop-blur-sm hover:shadow-xl hover:shadow-blue-500/20 transition-all duration-300 group"},we={class:"flex items-center justify-between mb-2"},ke={class:"flex items-center space-x-2"},Le={key:0,class:"text-sm text-blue-300 font-medium bg-blue-500/20 px-2 py-1 rounded-full border border-blue-400/30 animate-pulse"},Se={key:1,class:"text-base text-green-300 font-medium bg-green-500/20 px-2 py-1 rounded-full border border-green-400/30"},De={key:2,class:"text-xs text-yellow-300 font-medium bg-yellow-500/20 px-2 py-1 rounded-full border border-yellow-400/30"},Ce={class:"grid grid-cols-1 lg:grid-cols-4 gap-4 md:gap-6"},Ee={class:""},Pe={class:"block text-base font-bold text-blue-100 mb-2 flex items-center justify-between"},_e={key:0,class:"text-xs text-green-300 font-medium bg-green-500/20 px-1.5 py-0.5 rounded-full border border-green-400/30 flex items-center gap-1"},Te={class:"relative"},Ne=["placeholder","disabled","readonly","aria-describedby"],Ae={class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-blue-300/70"},Ie={key:1,class:"fas fa-check text-green-400 text-xs"},Fe={key:0,id:"full-name-help",class:"text-xs text-green-200/70 mt-1 italic flex items-center",role:"status"},Re={class:""},Oe={class:"block text-base font-bold text-blue-100 mb-2 flex items-center justify-between"},ze={key:0,class:"text-xs text-green-300 font-medium bg-green-500/20 px-1.5 py-0.5 rounded-full border border-green-400/30 flex items-center gap-1"},Xe={class:"relative"},je=["placeholder","disabled","readonly","aria-describedby"],We={class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-blue-300/70"},Be={key:1,class:"fas fa-check text-green-400 text-xs"},Ue={key:0,id:"pf-number-help",class:"text-xs text-green-200/70 mt-1 italic flex items-center",role:"status"},$e={class:""},Me={class:"block text-base font-bold text-blue-100 mb-2 flex items-center justify-between"},qe={key:0,class:"text-xs text-green-300 font-medium bg-green-500/20 px-1.5 py-0.5 rounded-full border border-green-400/30 flex items-center gap-1"},Ve={class:"relative"},He=["disabled","readonly","aria-describedby"],Qe=["value"],Ye={key:0,id:"department-help",class:"text-xs text-green-200/70 mt-1 italic flex items-center",role:"status"},Ge={class:""},Je={class:"relative"},Ke={class:"medical-card bg-gradient-to-r from-blue-600/25 to-blue-700/25 border-2 border-blue-400/40 p-3 rounded-xl backdrop-blur-sm hover:shadow-xl hover:shadow-blue-500/20 transition-all duration-300 group"},Ze={class:"bg-white/15 p-3 rounded-xl backdrop-blur-sm border-2 border-blue-300/30"},et={class:"text-blue-100 leading-relaxed text-lg space-y-3 text-justify"},tt={class:"text-red-500"},at={class:"text-red-500"},rt={class:"medical-card bg-gradient-to-r from-blue-600/25 to-blue-700/25 border-2 border-blue-400/40 p-2 rounded-xl backdrop-blur-sm hover:shadow-xl hover:shadow-blue-500/20 transition-all duration-300 group"},ot={class:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-6 gap-2 md:gap-3"},it={class:"md:col-span-2 xl:col-span-3 2xl:col-span-5"},st={class:"w-full px-2 py-1 border-2 border-blue-400/60 rounded-lg bg-blue-500/20 backdrop-blur-sm transition-all duration-300 shadow-lg hover:shadow-xl hover:bg-blue-500/30 min-h-[32px] flex flex-col sm:flex-row sm:items-center gap-2"},nt=["disabled","aria-label"],lt={class:"flex-1 text-xs leading-snug"},dt={key:0,class:"text-green-300 font-medium"},ct={key:1,class:"text-blue-100/80"},ut={key:2,class:"text-[10px] text-blue-200/80 mt-0.5 break-all"},mt={class:"2xl:col-span-1"},pt={class:"relative"},ft=["max"],ht={class:"medical-card bg-gradient-to-r from-red-600/25 to-rose-600/25 border-2 border-red-400/40 p-3 rounded-xl backdrop-blur-sm hover:shadow-xl hover:shadow-red-500/20 transition-all duration-300 group"},gt={class:"flex items-start space-x-4"},bt={class:"flex-shrink-0 mt-1"},vt={class:"relative"},xt={class:"border-t-2 border-blue-300/30 pt-3"},yt={class:"flex flex-col sm:flex-row justify-center gap-3"},wt=["disabled","aria-label"],kt={key:1,class:"fas fa-file-signature mr-3","aria-hidden":"true"};function Lt(e,t,a,o,i,s){const n=(0,r.g2)("SimpleLoadingBanner"),l=(0,r.g2)("OrbitingDots");return(0,r.uX)(),(0,r.CE)("div",null,[i.isLoadingProfile?((0,r.uX)(),(0,r.Wv)(n,{key:0,ref:"loadingBanner",show:i.isLoadingProfile,"auto-start":!0,onLoadingComplete:s.onLoadingComplete},null,8,["show","onLoadingComplete"])):(0,r.Q3)("",!0),(0,r.bo)((0,r.Lk)("div",{class:"min-h-screen bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 py-2 px-4 relative overflow-hidden",role:"main","aria-label":"Staff Declaration Form for Muhimbili National Hospital","aria-busy":i.isLoadingProfile},[(0,r.Lk)("div",fe,[(0,r.Lk)("div",he,[(0,r.Lk)("div",ge,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.backgroundDots,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,r.Tr)({animationDelay:e.delay})},null,4))),128))])]),(0,r.Lk)("div",be,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.floatingIcons,e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"absolute text-white opacity-10 animate-float",style:(0,r.Tr)({left:e.left,top:e.top,animationDelay:e.animationDelay,animationDuration:e.animationDuration,fontSize:e.fontSize})},[(0,r.Lk)("i",{class:(0,r.C4)(e.iconClass)},null,2)],4))),128))])]),(0,r.Lk)("div",ve,[t[44]||(t[44]=(0,r.Fv)('<div class="medical-glass-card rounded-t-3xl p-3 mb-0 border-b border-blue-300/30" data-v-d619d9c2><div class="flex justify-between items-center" data-v-d619d9c2><div class="w-16 h-16 mr-3 transform hover:scale-110 transition-transform duration-300" data-v-d619d9c2><div class="w-full h-full bg-gradient-to-br from-blue-500/20 to-teal-500/20 rounded-2xl backdrop-blur-sm border-2 border-blue-300/40 flex items-center justify-center shadow-2xl hover:shadow-blue-500/25" data-v-d619d9c2><img src="/assets/images/ngao2.png" alt="National Shield" class="max-w-12 max-h-12 object-contain" data-v-d619d9c2></div></div><div class="text-center flex-1" data-v-d619d9c2><h1 class="text-2xl font-bold text-white mb-1 tracking-wide drop-shadow-lg animate-fade-in" data-v-d619d9c2> MUHIMBILI NATIONAL HOSPITAL </h1><div class="relative inline-block mb-1" data-v-d619d9c2><div class="bg-gradient-to-r from-red-600 to-red-700 text-white px-4 py-1 rounded-full text-base font-bold shadow-2xl transform hover:scale-105 transition-all duration-300 border-2 border-red-400/60" data-v-d619d9c2><span class="relative z-10 flex items-center gap-1" data-v-d619d9c2><i class="fas fa-shield-alt text-red-200 text-xs" data-v-d619d9c2></i> RESTRICTED </span><div class="absolute inset-0 bg-gradient-to-r from-red-700 to-red-800 rounded-full opacity-0 hover:opacity-100 transition-opacity duration-300" data-v-d619d9c2></div></div></div><h2 class="text-2xl font-bold text-blue-100 tracking-wide drop-shadow-md animate-fade-in-delay" data-v-d619d9c2> DECLARATIONS BY STAFF </h2></div><div class="w-16 h-16 ml-3 transform hover:scale-110 transition-transform duration-300" data-v-d619d9c2><div class="w-full h-full bg-gradient-to-br from-teal-500/20 to-blue-500/20 rounded-2xl backdrop-blur-sm border-2 border-teal-300/40 flex items-center justify-center shadow-2xl hover:shadow-teal-500/25" data-v-d619d9c2><img src="/assets/images/logo2.png" alt="Muhimbili Logo" class="max-w-12 max-h-12 object-contain" data-v-d619d9c2></div></div></div></div>',1)),(0,r.Lk)("div",xe,[(0,r.Lk)("form",{onSubmit:t[7]||(t[7]=(0,r.D$)((...e)=>s.submitDeclaration&&s.submitDeclaration(...e),["prevent"])),class:"p-3 space-y-3",role:"form","aria-labelledby":"form-title",novalidate:""},[t[43]||(t[43]=(0,r.Fv)('<div class="medical-card bg-gradient-to-r from-blue-600/25 to-blue-700/25 border-2 border-blue-400/40 p-2 rounded-xl backdrop-blur-sm hover:shadow-xl hover:shadow-blue-500/20 transition-all duration-300 group" data-v-d619d9c2><div class="flex items-start space-x-4" data-v-d619d9c2><div class="flex-shrink-0" data-v-d619d9c2><div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300 border border-blue-300/50" data-v-d619d9c2><i class="fas fa-info-circle text-white text-lg" data-v-d619d9c2></i></div></div><div class="flex-1" data-v-d619d9c2><h3 id="form-title" class="text-base font-bold text-white mb-1 flex items-center" data-v-d619d9c2><i class="fas fa-clipboard-list mr-2 text-blue-300" aria-hidden="true" data-v-d619d9c2></i> Declaration Information </h3><div class="text-blue-100 leading-relaxed space-y-1" data-v-d619d9c2><p class="text-base font-medium" data-v-d619d9c2> These declarations have been designed to certify that users acknowledge that they are aware of Muhimbili National Hospital Acceptable Information and Communication Technology use policy and agree to abide by their terms. </p></div></div></div></div>',1)),(0,r.Lk)("div",ye,[(0,r.Lk)("div",we,[t[14]||(t[14]=(0,r.Fv)('<div class="flex items-center space-x-3" data-v-d619d9c2><div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300 border border-blue-300/50" data-v-d619d9c2><i class="fas fa-user-md text-white text-lg" data-v-d619d9c2></i></div><h3 class="text-xl font-bold text-white flex items-center" data-v-d619d9c2><i class="fas fa-id-card mr-2 text-blue-300" data-v-d619d9c2></i> Personal Information </h3></div>',1)),(0,r.Lk)("div",ke,[i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("span",Le,[(0,r.bF)(l,{size:"xs",class:"mr-1"}),t[11]||(t[11]=(0,r.eW)(" Loading... ",-1))])):i.autoPopulated?((0,r.uX)(),(0,r.CE)("span",Se,[...t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-check mr-1 text-sm"},null,-1),(0,r.eW)(" Auto-populated ",-1)])])):i.profileLoadError?((0,r.uX)(),(0,r.CE)("span",De,[...t[13]||(t[13]=[(0,r.Lk)("i",{class:"fas fa-exclamation-triangle mr-1 text-xs"},null,-1),(0,r.eW)(" Manual entry ",-1)])])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Ce,[(0,r.Lk)("div",Ee,[(0,r.Lk)("label",Pe,[t[16]||(t[16]=(0,r.Lk)("span",null,[(0,r.eW)("Full Name "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),i.autoPopulated&&i.formData.fullName&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("span",_e,[...t[15]||(t[15]=[(0,r.Lk)("i",{class:"fas fa-lock text-xs"},null,-1),(0,r.eW)(" Protected ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Te,[(0,r.bo)((0,r.Lk)("input",{id:"full-name","onUpdate:modelValue":t[0]||(t[0]=e=>i.formData.fullName=e),type:"text",class:(0,r.C4)(["medical-input w-full px-2 py-1.5 border-2 rounded-lg focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 text-sm",{"bg-blue-500/30 border-blue-400/60 focus:border-blue-500 hover:bg-blue-500/40 focus:bg-blue-500/50 focus:shadow-lg focus:shadow-blue-500/30":!i.autoPopulated||i.isLoadingProfile,"bg-green-500/20 border-green-400/60 cursor-not-allowed":i.autoPopulated&&i.formData.fullName&&!i.isLoadingProfile}]),placeholder:i.isLoadingProfile?"Loading your name...":i.autoPopulated&&i.formData.fullName?"Auto-populated from your profile":"Enter your full name",disabled:i.isLoadingProfile||i.autoPopulated&&i.formData.fullName,readonly:i.autoPopulated&&i.formData.fullName&&!i.isLoadingProfile,"aria-describedby":i.autoPopulated&&i.formData.fullName?"full-name-help":void 0,"aria-required":"true",autocomplete:"name",required:""},null,10,Ne),[[r.Jo,i.formData.fullName]]),t[17]||(t[17]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-500/10 to-blue-600/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1)),(0,r.Lk)("div",Ae,[i.isLoadingProfile?((0,r.uX)(),(0,r.Wv)(l,{key:0,size:"xs"})):i.autoPopulated&&i.formData.fullName?((0,r.uX)(),(0,r.CE)("i",Ie)):(0,r.Q3)("",!0)])]),i.autoPopulated&&i.formData.fullName&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("p",Fe,[...t[18]||(t[18]=[(0,r.Lk)("i",{class:"fas fa-info-circle mr-1 text-xs","aria-hidden":"true"},null,-1),(0,r.eW)(" Auto-populated, cannot be edited ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Re,[(0,r.Lk)("label",Oe,[t[20]||(t[20]=(0,r.Lk)("span",null,[(0,r.eW)("PF Number "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),i.autoPopulated&&i.formData.pfNumber&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("span",ze,[...t[19]||(t[19]=[(0,r.Lk)("i",{class:"fas fa-lock text-xs"},null,-1),(0,r.eW)(" Protected ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Xe,[(0,r.bo)((0,r.Lk)("input",{id:"pf-number","onUpdate:modelValue":t[1]||(t[1]=e=>i.formData.pfNumber=e),type:"text",class:(0,r.C4)(["medical-input w-full px-2 py-1.5 border-2 rounded-lg focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 text-sm",{"bg-blue-500/30 border-blue-400/60 focus:border-blue-500 hover:bg-blue-500/40 focus:bg-blue-500/50 focus:shadow-lg focus:shadow-blue-500/30":!i.autoPopulated||i.isLoadingProfile,"bg-green-500/20 border-green-400/60 cursor-not-allowed":i.autoPopulated&&i.formData.pfNumber&&!i.isLoadingProfile}]),placeholder:i.isLoadingProfile?"Loading your PF Number...":i.autoPopulated&&i.formData.pfNumber?"Auto-populated from your profile":"Enter PF Number",disabled:i.isLoadingProfile||i.autoPopulated&&i.formData.pfNumber,readonly:i.autoPopulated&&i.formData.pfNumber&&!i.isLoadingProfile,"aria-describedby":i.autoPopulated&&i.formData.pfNumber?"pf-number-help":void 0,"aria-required":"true",autocomplete:"off",pattern:"[-A-Za-z0-9/]+",required:""},null,10,je),[[r.Jo,i.formData.pfNumber]]),t[21]||(t[21]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-500/10 to-blue-600/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1)),(0,r.Lk)("div",We,[i.isLoadingProfile?((0,r.uX)(),(0,r.Wv)(l,{key:0,size:"xs"})):i.autoPopulated&&i.formData.pfNumber?((0,r.uX)(),(0,r.CE)("i",Be)):(0,r.Q3)("",!0)])]),i.autoPopulated&&i.formData.pfNumber&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("p",Ue,[...t[22]||(t[22]=[(0,r.Lk)("i",{class:"fas fa-info-circle mr-1 text-xs","aria-hidden":"true"},null,-1),(0,r.eW)(" Auto-populated, cannot be edited ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",$e,[(0,r.Lk)("label",Me,[t[24]||(t[24]=(0,r.Lk)("span",null,[(0,r.eW)("Department/Unit "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),i.autoPopulated&&i.formData.department&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("span",qe,[...t[23]||(t[23]=[(0,r.Lk)("i",{class:"fas fa-lock text-xs"},null,-1),(0,r.eW)(" Protected ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Ve,[(0,r.bo)((0,r.Lk)("select",{id:"department","onUpdate:modelValue":t[2]||(t[2]=e=>i.formData.department=e),class:"medical-input w-full px-2 py-1.5 bg-blue-500/30 border-2 border-blue-400/60 rounded-lg focus:border-blue-500 focus:outline-none text-white backdrop-blur-sm transition-all duration-300 hover:bg-blue-500/40 focus:bg-blue-500/50 focus:shadow-lg focus:shadow-blue-500/30 appearance-none text-sm",disabled:i.isLoadingProfile||i.autoPopulated&&i.formData.department,readonly:i.autoPopulated&&i.formData.department&&!i.isLoadingProfile,"aria-describedby":i.autoPopulated&&i.formData.department?"department-help":void 0,"aria-required":"true",required:""},[t[25]||(t[25]=(0,r.Lk)("option",{value:"",disabled:"",class:"bg-gray-800 text-gray-300"}," Select your department ",-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(i.departments,e=>((0,r.uX)(),(0,r.CE)("option",{key:e,value:e,class:"bg-gray-800 text-white"},(0,r.v_)(e),9,Qe))),128))],8,He),[[r.u1,i.formData.department]]),t[26]||(t[26]=(0,r.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none"},[(0,r.Lk)("i",{class:"fas fa-chevron-down text-blue-300"})],-1)),t[27]||(t[27]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-lg bg-gradient-to-r from-blue-500/10 to-blue-600/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))]),i.autoPopulated&&i.formData.department&&!i.isLoadingProfile?((0,r.uX)(),(0,r.CE)("p",Ye,[...t[28]||(t[28]=[(0,r.Lk)("i",{class:"fas fa-info-circle mr-1 text-xs","aria-hidden":"true"},null,-1),(0,r.eW)(" Auto-populated, cannot be edited ",-1)])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Ge,[t[30]||(t[30]=(0,r.Lk)("label",{class:"block text-base font-bold text-blue-100 mb-2"},[(0,r.eW)(" Job Title "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),(0,r.Lk)("div",Je,[(0,r.bo)((0,r.Lk)("input",{id:"job-title","onUpdate:modelValue":t[3]||(t[3]=e=>i.formData.jobTitle=e),type:"text",class:"medical-input w-full px-2 py-1.5 bg-blue-500/30 border-2 border-blue-400/60 rounded-lg focus:border-blue-500 focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 hover:bg-blue-500/40 focus:bg-blue-500/50 focus:shadow-lg focus:shadow-blue-500/30 text-sm",placeholder:"Enter your job title","aria-required":"true",autocomplete:"organization-title",required:""},null,512),[[r.Jo,i.formData.jobTitle]]),t[29]||(t[29]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-600/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))])])])]),(0,r.Lk)("div",Ke,[t[36]||(t[36]=(0,r.Fv)('<div class="flex items-center space-x-2 mb-2" data-v-d619d9c2><div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300 border border-blue-300/50" data-v-d619d9c2><i class="fas fa-file-contract text-white text-xs" data-v-d619d9c2></i></div><h3 class="text-base font-bold text-white flex items-center" data-v-d619d9c2><i class="fas fa-scroll mr-2 text-blue-300 text-xs" data-v-d619d9c2></i> Declaration Statement </h3></div>',1)),(0,r.Lk)("div",Ze,[(0,r.Lk)("div",et,[(0,r.Lk)("p",null,[t[31]||(t[31]=(0,r.eW)(" I ",-1)),(0,r.Lk)("strong",tt,(0,r.v_)(i.formData.fullName||"______________________"),1),t[32]||(t[32]=(0,r.eW)(" PF No. ",-1)),(0,r.Lk)("strong",at,(0,r.v_)(i.formData.pfNumber||"______"),1),t[33]||(t[33]=(0,r.eW)(" acknowledge that Muhimbili National Hospital acceptable ICT use policy has been made available to me for adequate review and understanding. ",-1))]),t[34]||(t[34]=(0,r.Lk)("p",null," I certify that I have been given ample opportunity to read and understand it, and ask questions about my responsibilities on it. I am, therefore, aware that I am accountable to all its terms and requirements; and that I shall abide by them. ",-1)),t[35]||(t[35]=(0,r.Lk)("p",null," I also understand that failure to abide by them; Muhimbili National Hospital shall take against me appropriate disciplinary action or legal action, or both, as the case may be. ",-1))])])]),(0,r.Lk)("div",rt,[t[40]||(t[40]=(0,r.Fv)('<div class="flex items-center space-x-2 mb-1" data-v-d619d9c2><div class="w-6 h-6 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300 border border-blue-300/50" data-v-d619d9c2><i class="fas fa-signature text-white text-xs" data-v-d619d9c2></i></div><h3 class="text-sm font-bold text-white flex items-center" data-v-d619d9c2><i class="fas fa-pen-fancy mr-1 text-blue-300 text-xs" data-v-d619d9c2></i> Digital Signature </h3></div>',1)),(0,r.Lk)("div",ot,[(0,r.Lk)("div",it,[t[37]||(t[37]=(0,r.Lk)("label",{class:"block text-sm font-bold text-blue-100 mb-1"},[(0,r.eW)(" Signature "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),(0,r.Lk)("div",st,[(0,r.Lk)("button",{type:"button",onClick:t[4]||(t[4]=(...e)=>s.signDeclaration&&s.signDeclaration(...e)),disabled:i.isSigning||i.hasUserSigned,class:"px-2.5 py-1 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-xs sm:text-sm font-semibold rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-300 flex items-center gap-2 shadow hover:shadow-lg transform hover:scale-105 disabled:opacity-60 disabled:cursor-not-allowed disabled:transform-none border border-blue-400/60 focus:ring-1 focus:ring-blue-300","aria-label":i.hasUserSigned?"Declaration already signed":"Digitally sign this declaration"},[i.isSigning?((0,r.uX)(),(0,r.Wv)(l,{key:0,size:"xs"})):((0,r.uX)(),(0,r.CE)("i",{key:1,class:(0,r.C4)([i.hasUserSigned?"fas fa-check":"fas fa-pen-fancy","text-xs"])},null,2)),(0,r.Lk)("span",null,(0,r.v_)(i.hasUserSigned?"Signed":"Click to Sign Digitally"),1)],8,nt),(0,r.Lk)("div",lt,[i.hasUserSigned?((0,r.uX)(),(0,r.CE)("p",dt," Signed on "+(0,r.v_)(s.formattedSignedAt),1)):((0,r.uX)(),(0,r.CE)("p",ct," You must digitally sign this declaration before submitting. ")),i.signatureToken?((0,r.uX)(),(0,r.CE)("p",ut," Token: "+(0,r.v_)(s.signatureTokenPreview),1)):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",mt,[t[39]||(t[39]=(0,r.Lk)("label",{class:"block text-sm font-bold text-blue-100 mb-1"},[(0,r.eW)(" Date "),(0,r.Lk)("span",{class:"text-red-400"},"*")],-1)),(0,r.Lk)("div",pt,[(0,r.bo)((0,r.Lk)("input",{id:"signature-date","onUpdate:modelValue":t[5]||(t[5]=e=>i.formData.date=e),type:"date",class:"medical-input w-full px-2 py-1.5 bg-blue-500/30 border-2 border-blue-400/60 rounded-lg focus:border-blue-500 focus:outline-none text-white backdrop-blur-sm transition-all duration-300 hover:bg-blue-500/40 focus:bg-blue-500/50 focus:shadow-lg focus:shadow-blue-500/30 text-sm","aria-required":"true",max:s.maxFutureDate,required:""},null,8,ft),[[r.Jo,i.formData.date]]),t[38]||(t[38]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-emerald-500/10 to-teal-500/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))])])])]),(0,r.Lk)("div",ht,[(0,r.Lk)("div",gt,[(0,r.Lk)("div",bt,[(0,r.Lk)("div",vt,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>i.formData.agreement=e),type:"checkbox",id:"agreement",class:"w-7 h-7 text-red-500 bg-white/15 border-2 border-red-300/40 rounded-lg focus:ring-red-400 focus:ring-2 backdrop-blur-sm transition-all duration-300","aria-required":"true","aria-describedby":"agreement-text",required:""},null,512),[[r.lH,i.formData.agreement]]),t[41]||(t[41]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-lg bg-gradient-to-r from-red-500/10 to-rose-500/10 opacity-0 hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))])]),t[42]||(t[42]=(0,r.Lk)("label",{for:"agreement",class:"text-base text-blue-100 leading-relaxed flex-1"},[(0,r.Lk)("span",{class:"font-bold text-red-300 flex items-center gap-2"},[(0,r.Lk)("i",{class:"fas fa-exclamation-triangle","aria-hidden":"true"}),(0,r.eW)(" I hereby confirm that: ")]),(0,r.Lk)("span",{id:"agreement-text"}," I have read, understood, and agree to abide by all terms and conditions of the Muhimbili National Hospital Acceptable ICT Use Policy. I acknowledge that violation of this policy may result in disciplinary action or legal consequences. ")],-1))])]),(0,r.Lk)("div",xt,[(0,r.Lk)("div",yt,[(0,r.Lk)("button",{type:"submit",disabled:!s.isFormValid||i.isSubmitting,class:"px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold flex items-center justify-center shadow-lg hover:shadow-xl hover:shadow-blue-500/25 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none border-2 border-blue-500/50 focus:ring-2 focus:ring-blue-300 focus:ring-offset-2","aria-label":i.isSubmitting?"Submitting declaration form":"Submit declaration form"},[i.isSubmitting?((0,r.uX)(),(0,r.Wv)(l,{key:0,size:"sm",class:"mr-3"})):((0,r.uX)(),(0,r.CE)("i",kt)),(0,r.eW)(" "+(0,r.v_)(i.isSubmitting?"Submitting...":"Submit Declaration"),1)],8,wt)])])],32)])])],8,pe),[[r.aG,!i.isLoadingProfile]]),(0,r.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>s.goBack&&s.goBack(...e)),onKeydown:[t[9]||(t[9]=(0,r.jR)((...e)=>s.goBack&&s.goBack(...e),["enter"])),t[10]||(t[10]=(0,r.jR)((0,r.D$)((...e)=>s.goBack&&s.goBack(...e),["prevent"]),["space"]))],class:"fixed bottom-6 left-6 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-4 focus:ring-blue-300 focus:ring-offset-2 z-40 group","aria-label":"Go back to previous page"},[...t[45]||(t[45]=[(0,r.Lk)("i",{class:"fas fa-arrow-left text-lg group-hover:animate-pulse","aria-hidden":"true"},null,-1)])],32)])}a(7588),a(1701),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698);var St=a(2557);function Dt(e,t,a,o,i,s){return i.isVisible?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,r.C4)(["loading-banner",{"fade-out":i.isComplete}])},[...t[0]||(t[0]=[(0,r.Lk)("div",{class:"loading-card rounded-xl shadow-2xl p-8 text-center border border-blue-400/40",style:{background:"linear-gradient(90deg, #0b3a82, #0a2f6f, #0b3a82)"}},[(0,r.Lk)("div",{class:"flex justify-center mb-4"},[(0,r.Lk)("div",{class:"w-12 h-12 border-4 border-white border-t-transparent rounded-full animate-spin"})]),(0,r.Lk)("p",{class:"text-blue-100 font-medium"},"Loading...")],-1)])],2)):(0,r.Q3)("",!0)}var Ct={name:"SimpleLoadingBanner",props:{show:{type:Boolean,default:!0},autoStart:{type:Boolean,default:!0}},emits:["loading-complete"],data(){return{isVisible:!0,isComplete:!1}},watch:{show:{handler(e){e&&!this.isVisible?this.startLoading():e||this.stopLoading()},immediate:!0}},mounted(){this.autoStart&&this.show&&this.startLoading()},methods:{startLoading(){this.isVisible=!0,this.isComplete=!1},stopLoading(){this.isVisible=!1},completeLoading(){this.isComplete=!0,setTimeout(()=>{this.isVisible=!1,this.$emit("loading-complete")},300)}}};const Et=(0,v.A)(Ct,[["render",Dt],["__scopeId","data-v-4da685cc"]]);var Pt=Et,_t=a(4247),Tt=a(1075),Nt=a(9871);const At={MAX_FILE_SIZE:5242880,ALLOWED_FILE_TYPES:["image/png","image/jpeg","image/jpg","application/pdf"],MAX_RETRIES:3,RETRY_BASE_DELAY:1e3,MAX_RETRY_DELAY:3e3,NOTIFICATION_DURATION:4e3,SUCCESS_DELAY:1500,MAX_FIELD_LENGTH:255,MAX_TEXT_LENGTH:1e3},It=Object.freeze(["Administration","Anesthesiology","Cardiology","Dermatology","Emergency Medicine","Endocrinology","Gastroenterology","General Surgery","Gynecology","Hematology","ICT Department","Internal Medicine","Laboratory","Nephrology","Neurology","Nursing","Obstetrics","Oncology","Ophthalmology","Orthopedics","Pediatrics","Pharmacy","Psychiatry","Pulmonology","Radiology","Rehabilitation","Urology","Other"]),Ft=Object.freeze({success:"green",error:"red",info:"blue",warning:"yellow"}),Rt=Object.freeze(["fa-heartbeat","fa-user-md","fa-hospital","fa-stethoscope","fa-plus"]);var Ot={name:"DeclarationForm",components:{SimpleLoadingBanner:Pt,OrbitingDots:_t.A},emits:["form-submitted","go-back"],data(){return{isSubmitting:!1,isSigning:!1,hasUserSigned:!1,signatureToken:"",signedAt:null,signaturePreview:"",signatureFileName:"",isLoadingProfile:!0,profileLoadError:null,autoPopulated:!1,departments:[...It],formData:{fullName:"",pfNumber:"",department:"",jobTitle:"",signature:null,date:"",agreement:!1},backgroundDotsCache:null,floatingIconsCache:null,retryButton:null,retryClickHandler:null,retryTimeout:null,fileReaders:new Set}},computed:{isFormValid(){return this.formValidationState.isValid},maxFutureDate(){const e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]},backgroundDots(){return this.backgroundDotsCache||[]},floatingIcons(){return this.floatingIconsCache||[]},formValidationState(){const e=!!this.formData.fullName,t=!!this.formData.pfNumber,a=!!this.formData.department,r=!!this.formData.jobTitle,o=!!this.formData.date,i=!!this.formData.agreement,s=!!this.hasUserSigned;return{isValid:e&&t&&a&&r&&o&&i&&s,missingFields:[!e&&"Full Name",!t&&"PF Number",!a&&"Department",!r&&"Job Title",!o&&"Date",!i&&"Agreement",!s&&"Digital Signature"].filter(Boolean)}},formattedSignedAt(){if(!this.signedAt)return"";try{return new Date(this.signedAt).toLocaleString()}catch(e){return this.signedAt}},signatureTokenPreview(){return this.signatureToken?this.signatureToken.length<=16?this.signatureToken:`${this.signatureToken.slice(0,10)}…${this.signatureToken.slice(-4)}`:""}},methods:{onLoadingComplete(){Nt.vQ.DEBUG},completeLoadingBanner(){this.$nextTick(()=>{const e=this.$refs.loadingBanner;e&&e.completeLoading&&e.completeLoading()})},async autoPopulateUserData(){Nt.vQ.DEBUG,this.isLoadingProfile=!0,this.profileLoadError=null;const e=localStorage.getItem("auth_token");if(!e)return console.error("❌ No authentication token found"),this.profileLoadError="No authentication token found",void(this.isLoadingProfile=!1);Nt.vQ.DEBUG;try{const e=await St.A.getFormAutoPopulationData();if(e.success&&e.data){e.data;const t=this.processUserProfileData(e.data);t.success?(this.autoPopulated=!0,t.data,t.populatedFields.length>0&&this.showNotification(`Auto-populated: ${t.populatedFields.join(", ")}`,"info")):(console.warn("⚠️ No fields could be auto-populated:",t.error),this.showNotification("Profile data available but could not be used","warning"))}else console.warn("⚠️ Failed to auto-populate declaration form:",e.error),this.profileLoadError=e.error||"Failed to load profile data",this.showNotification("Could not auto-populate your details. Please fill them manually.","warning")}catch(t){console.error("❌ Error during declaration auto-population:",t),this.profileLoadError=t.message||"Network error while loading profile",this.showNotification("Error loading your profile. Please fill in your details manually.","error")}finally{this.completeLoadingBanner(),setTimeout(()=>{this.isLoadingProfile=!1},400)}},async signDeclaration(){try{if(this.isSigning)return;this.isSigning=!0;const e=await Tt["default"].sign("declaration");e&&(e.success||e.data)?(this.hasUserSigned=!0,this.signedAt=e?.data?.signed_at||e?.signed_at||(new Date).toISOString(),this.signatureToken=e?.data?.signature_hash||e?.signature_hash||"",this.showNotification(`Declaration signed on ${new Date(this.signedAt).toLocaleString()}`,"success")):this.showNotification(e?.message||"Failed to sign declaration","error")}catch(e){console.error("Error signing declaration:",e),this.showNotification(e.message||"Failed to sign declaration","error")}finally{this.isSigning=!1}},processUserProfileData(e){if(!e||"object"!==typeof e)return{success:!1,error:"Invalid profile data format"};const t=[],a=[];try{const r=this.validateAndSanitizeText(e.staffName||e.fullName||"","Full Name");r.isValid?(this.formData.fullName=r.value,t.push("name")):r.error&&a.push(r.error);const o=this.validateAndSanitizeText(e.pfNumber||"","PF Number");o.isValid?(this.formData.pfNumber=o.value,t.push("PF number")):o.error&&a.push(o.error);const i=e.departmentFullName||e.departmentName||e.departmentCode||"",s=this.validateAndSanitizeText(i,"Department");return s.isValid&&s.value?(this.departments.includes(s.value)||(s.value,this.departments.push(s.value),this.departments.sort()),this.formData.department=s.value,t.push("department")):s.error&&a.push(s.error),{success:t.length>0,populatedFields:t,errors:a,data:{fullName:this.formData.fullName,pfNumber:this.formData.pfNumber,department:this.formData.department}}}catch(r){return console.error("Error processing profile data:",r),{success:!1,error:"Error processing profile data",populatedFields:[],errors:[r.message]}}},validateAndSanitizeText(e,t){if(!e||"string"!==typeof e)return{isValid:!1,value:"",error:null};const a=e.trim().replace(/[<>"'&]/g,"");return 0===a.length?{isValid:!1,value:"",error:null}:a.length>At.MAX_FIELD_LENGTH?{isValid:!1,value:"",error:`${t} is too long (max ${At.MAX_FIELD_LENGTH} characters)`}:"PF Number"===t&&a&&!/^[A-Z0-9\-\/]+$/i.test(a)?{isValid:!1,value:"",error:"PF Number contains invalid characters"}:{isValid:!0,value:a,error:null}},validateFileSecurity(e){if(!At.ALLOWED_FILE_TYPES.includes(e.type))return{isValid:!1,error:`Please select a valid file type: ${At.ALLOWED_FILE_TYPES.join(", ").replace(/image\//g,"").replace(/application\//g,"").toUpperCase()}`};if(e.size>At.MAX_FILE_SIZE)return{isValid:!1,error:`File size must be less than ${At.MAX_FILE_SIZE/1048576}MB`};const t=[/\.exe$/i,/\.bat$/i,/\.cmd$/i,/\.com$/i,/\.scr$/i,/\.js$/i,/\.vbs$/i];if(t.some(t=>t.test(e.name)))return{isValid:!1,error:"File type not allowed for security reasons"};if(e.name.length>255)return{isValid:!1,error:"Filename is too long"};const a=e.name.split(".");return a.length>2?{isValid:!1,error:"Files with multiple extensions are not allowed"}:{isValid:!0}},async submitDeclaration(){if(!this.isFormValid){const e=this.formValidationState.missingFields;return void this.showNotification(`Missing required fields: ${e.join(", ")}`,"error")}const e=this.validateFormData();if(e.isValid)try{this.isSubmitting=!0,this.showNotification("Submitting declaration...","info");const e={fullName:this.formData.fullName,pfNumber:this.formData.pfNumber,department:this.formData.department,jobTitle:this.formData.jobTitle,date:this.formData.date,agreement:this.formData.agreement,signatureMethod:"digital_token",signatureHash:this.signatureToken||null,signedAt:this.signedAt||null},t=new FormData;Object.keys(e).forEach(a=>{let r=e[a];"boolean"===typeof r&&(r=r?"1":"0"),null!==r&&void 0!==r&&t.append(a,r)}),Nt.vQ.DEBUG&&this.hasUserSigned;const{authAPI:r}=await Promise.resolve().then(a.bind(a,274)),o=await r.submitDeclaration(t);o.success?(Nt.vQ.DEBUG&&o.data,this.showNotification("Declaration submitted successfully!","success"),setTimeout(()=>{this.$emit("form-submitted",e)},At.SUCCESS_DELAY)):(console.error("Declaration submission failed:",o.error),this.showNotification(o.error||"Failed to submit declaration","error"),o.errors&&Object.values(o.errors).forEach(e=>{e.forEach(e=>{this.showNotification(e,"error")})}))}catch(t){console.error("Error submitting declaration:",t),this.showNotification("An error occurred while submitting the declaration","error")}finally{this.isSubmitting=!1}else this.showNotification(e.error,"error")},resetForm(){this.formData={fullName:"",pfNumber:"",department:"",jobTitle:"",signature:null,date:"",agreement:!1},this.signaturePreview="",this.signatureFileName="",this.hasUserSigned=!1,this.signatureToken="",this.signedAt=null,this.showNotification("Form has been reset","info")},printForm(){window.print()},showNotification(e,t="info"){if(!e)return;const a=String(e).replace(/<[^>]*>/g,""),r=Ft;this.createOptimizedNotification(a,r[t]||"blue")},createOptimizedNotification(e,t){let a=document.getElementById("notification-container");a||(a=document.createElement("div"),a.id="notification-container",a.className="fixed top-4 right-4 z-[9999] space-y-2 pointer-events-none",document.body.appendChild(a));const r=document.createElement("div");r.className=`px-6 py-3 rounded-lg text-white font-semibold bg-${t}-600 shadow-lg transform transition-all duration-300 max-w-md pointer-events-auto`,r.textContent=e,r.style.transform="translateX(100%)",a.appendChild(r),requestAnimationFrame(()=>{r.style.transform="translateX(0)"}),setTimeout(()=>this.removeNotification(r,a),At.NOTIFICATION_DURATION)},removeNotification(e,t){if(!e.parentNode)return;e.style.transform="translateX(100%)";const a=setTimeout(()=>{e.parentNode&&(t.removeChild(e),0===t.children.length&&document.body.contains(t)&&document.body.removeChild(t)),clearTimeout(a)},300)},validateFormData(){const e=[],t=this.validateAndSanitizeText(this.formData.fullName,"Full Name");t.isValid||e.push(t.error||"Full name is required");const a=this.validateAndSanitizeText(this.formData.pfNumber,"PF Number");a.isValid||e.push(a.error||"PF Number is required");const r=this.validateAndSanitizeText(this.formData.department,"Department");r.isValid||e.push(r.error||"Department is required");const o=this.validateAndSanitizeText(this.formData.jobTitle,"Job Title");if(o.isValid||e.push(o.error||"Job title is required"),this.formData.date){const t=new Date(this.formData.date),a=new Date;a.setMonth(a.getMonth()+3),t>a&&e.push("Date cannot be more than 3 months in the future")}else e.push("Date is required");return this.formData.agreement||e.push("You must agree to the terms and conditions"),this.hasUserSigned||e.push("Digital signature is required"),{isValid:0===e.length,error:e.length>0?e[0]:null,errors:e}},goBack(){this.$emit("go-back")},checkAuthentication(){const e=localStorage.getItem("auth_token"),t=localStorage.getItem("user_data");return e?(t||console.warn("⚠️ No user data found in localStorage"),0===e.trim().length?(console.error("❌ Authentication token is empty"),!1):!(e.length<10)||(console.warn("⚠️ Authentication token appears to be too short"),!1)):(console.error("❌ No authentication token found"),!1)},handleAuthenticationFailure(){localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("session_data"),this.showNotification("Session expired. Please log in again.","error"),setTimeout(()=>{"undefined"!==typeof window&&(window.location.href="/")},2e3)},async initializeFormWithRetry(){let e=1;while(e<=At.MAX_RETRIES){try{if(At.MAX_RETRIES,await this.autoPopulateUserData(),!this.profileLoadError)return}catch(t){console.error(`❌ Form initialization attempt ${e} failed:`,t)}if(e++,e<=At.MAX_RETRIES){const t=Math.min(At.RETRY_BASE_DELAY*e,At.MAX_RETRY_DELAY);await new Promise(e=>setTimeout(e,t))}}console.error("❌ All initialization attempts failed"),this.handleInitializationFailure()},handleInitializationFailure(){this.isLoadingProfile=!1,this.profileLoadError="Failed to initialize form after multiple attempts",this.showNotification("Unable to load your profile data. You can still fill the form manually.","warning"),this.showManualEntryOption()},showManualEntryOption(){const e=document.createElement("button");e.className="fixed bottom-20 right-6 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center gap-2 transition-all duration-300",e.innerHTML='<i class="fas fa-sync-alt"></i> Retry Loading Profile';const t=async()=>{this.removeRetryButton(e,t),this.isLoadingProfile=!0,this.profileLoadError=null,await this.initializeFormWithRetry()};e.addEventListener("click",t),document.body.appendChild(e),this.retryButton=e,this.retryClickHandler=t,this.retryTimeout=setTimeout(()=>{this.removeRetryButton(e,t)},1e4)},removeRetryButton(e,t){e&&document.body.contains(e)&&(e.removeEventListener("click",t),document.body.removeChild(e)),this.retryTimeout&&(clearTimeout(this.retryTimeout),this.retryTimeout=null),this.retryButton=null,this.retryClickHandler=null},async loadAvailableDepartments(){try{const e=await St.A.getDepartments();if(e.success&&e.data&&Array.isArray(e.data)){const t=e.data.map(e=>e.display_name||e.full_name||e.name||"").filter(e=>e.length>0),a=[...new Set([...this.departments,...t])];this.departments=Object.freeze(a.sort()),t.length,this.departments.length}else console.warn("⚠️ Failed to load departments from backend, using static list")}catch(e){console.warn("⚠️ Error loading departments from backend:",e.message)}},initializeBackgroundDots(){if(this.backgroundDotsCache)return;const e=[];for(let t=1;t<=48;t++)e.push({id:`dot-${t}`,delay:.1*t+"s"});this.backgroundDotsCache=Object.freeze(e)},initializeFloatingIcons(){if(this.floatingIconsCache)return;const e=[],t=Rt,a=e=>{const t=1e4*Math.sin(e);return t-Math.floor(t)};for(let r=1;r<=15;r++){const o=12345*r,i=67890*r,s=54321*r,n=98765*r,l=13579*r;e.push({id:`icon-${r}`,left:100*a(o)+"%",top:100*a(i)+"%",animationDelay:3*a(s)+"s",animationDuration:3*a(n)+2+"s",fontSize:20*a(l)+10+"px",iconClass:`fas ${t[Math.floor(a(2*o)*t.length)]}`})}this.floatingIconsCache=Object.freeze(e)},cleanupResources(){this.fileReaders&&this.fileReaders.size>0&&(this.fileReaders.forEach(e=>{e.readyState===FileReader.LOADING&&e.abort()}),this.fileReaders.clear()),(this.retryButton||this.retryClickHandler)&&this.removeRetryButton(this.retryButton,this.retryClickHandler);const e=document.getElementById("notification-container");e&&document.body.contains(e)&&document.body.removeChild(e),this.backgroundDotsCache=null,this.floatingIconsCache=null}},async mounted(){if(!this.checkAuthentication())return console.error("❌ User not authenticated, redirecting to login"),void this.handleAuthenticationFailure();const e=(new Date).toISOString().split("T")[0];this.formData.date=e,this.loadAvailableDepartments(),this.initializeBackgroundDots(),this.initializeFloatingIcons(),await this.initializeFormWithRetry()},beforeUnmount(){this.cleanupResources()}};const zt=(0,v.A)(Ot,[["render",Lt],["__scopeId","data-v-d619d9c2"]]);var Xt=zt;const jt={class:"fixed inset-0 bg-slate-900/40 backdrop-blur-md flex items-center justify-center z-[9999] p-4"},Wt={class:"bg-white rounded-3xl w-full max-w-lg overflow-hidden shadow-[0_20px_50px_rgba(0,0,0,0.1)] border border-slate-100 transform transition-all animate-modal-pop"},Bt={class:"relative bg-gradient-to-br from-blue-700 via-blue-800 to-blue-900 p-10 text-center"},Ut={class:"inline-flex items-center px-3 py-1 bg-white/10 rounded-full backdrop-blur-sm"},$t={class:"text-blue-100 text-sm font-semibold uppercase tracking-wider"},Mt={class:"p-10 bg-white"},qt={class:"text-center mb-8"},Vt={class:"text-3xl font-black text-slate-900 mb-4 tracking-tight"},Ht={class:"space-y-3 mb-10"},Qt={class:"text-slate-700 font-bold text-sm"};function Yt(e,t,a,o,i,s){return(0,r.uX)(),(0,r.CE)("div",jt,[(0,r.Lk)("div",Wt,[(0,r.Lk)("div",Bt,[t[1]||(t[1]=(0,r.Fv)('<div class="absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full -mr-16 -mt-16" data-v-1d1898fe></div><div class="absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full -ml-12 -mb-12" data-v-1d1898fe></div><div class="relative inline-block mb-6" data-v-1d1898fe><div class="w-20 h-20 bg-gradient-to-tr from-amber-300 to-amber-500 rounded-2xl flex items-center justify-center mx-auto shadow-2xl animate-float" data-v-1d1898fe><i class="fas fa-trophy text-white text-3xl drop-shadow-md" data-v-1d1898fe></i></div><div class="absolute -top-2 -right-2 animate-pulse" data-v-1d1898fe><i class="fas fa-sparkles text-amber-300 text-sm" data-v-1d1898fe></i></div></div><h2 class="text-3xl font-extrabold text-white mb-2 tracking-tight" data-v-1d1898fe>Congratulations!</h2>',4)),(0,r.Lk)("div",Ut,[(0,r.Lk)("span",$t,(0,r.v_)(a.userRoleDisplay),1)])]),(0,r.Lk)("div",Mt,[(0,r.Lk)("div",qt,[t[2]||(t[2]=(0,r.Lk)("div",{class:"text-slate-500 text-xs font-bold uppercase tracking-widest mb-2"}," Welcome Aboard ",-1)),(0,r.Lk)("h3",Vt,(0,r.v_)(a.userName),1),t[3]||(t[3]=(0,r.Lk)("p",{class:"text-slate-600 text-base leading-relaxed max-w-sm mx-auto"}," Your onboarding is now officially complete. You have full access to the portal features. ",-1))]),(0,r.Lk)("div",Ht,[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(["Terms of Service Accepted","ICT Policy Acknowledged","Declaration Form Submitted"],(e,a)=>(0,r.Lk)("div",{key:a,class:"flex items-center gap-4 p-4 rounded-xl bg-slate-50 border border-slate-100 transition-all hover:bg-slate-100/80 group"},[t[4]||(t[4]=(0,r.Lk)("div",{class:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm transition-transform group-hover:scale-110"},[(0,r.Lk)("i",{class:"fas fa-check text-white text-[10px]"})],-1)),(0,r.Lk)("span",Qt,(0,r.v_)(e),1)])),64))]),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.handleContinue&&s.handleContinue(...e)),class:"group relative w-full bg-slate-900 hover:bg-blue-600 text-white py-5 px-8 rounded-2xl font-bold text-lg transition-all duration-300 shadow-[0_10px_20px_rgba(15,23,42,0.15)] hover:shadow-[0_15px_30px_rgba(37,99,235,0.3)] active:scale-[0.98] overflow-hidden"},[...t[5]||(t[5]=[(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-600 to-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1),(0,r.Lk)("div",{class:"relative flex items-center justify-center gap-3"},[(0,r.Lk)("span",null,"Continue to Dashboard"),(0,r.Lk)("i",{class:"fas fa-chevron-right text-sm transition-transform group-hover:translate-x-1"})],-1)])])])])])}var Gt={name:"SuccessPopup",props:{userName:{type:String,required:!0},userRoleDisplay:{type:String,default:"Staff Member"},message:{type:String,default:"You have successfully completed the onboarding process. Now you can proceed with your requests."}},emits:["continue"],methods:{handleContinue(){this.$emit("continue")}}};const Jt=(0,v.A)(Gt,[["render",Yt],["__scopeId","data-v-1d1898fe"]]);var Kt=Jt,Zt={name:"OnboardingFlow",components:{OnboardingPopup:y,TermsOfService:$,IctPolicy:me,DeclarationForm:Xt,SuccessPopup:Kt,SimpleLoadingBanner:Pt},props:{userName:{type:String,required:!0},userId:{type:[String,Number],required:!0}},emits:["onboarding-complete","return-to-login"],data(){return{currentStep:"terms-popup",loading:!0,backendStatus:null,userRoleDisplay:"Staff Member"}},async mounted(){await this.initializeOnboardingState()},watch:{currentStep(e){this.saveCurrentStep()}},methods:{async initializeOnboardingState(){try{this.userId;const{authAPI:e}=await Promise.resolve().then(a.bind(a,274)),t=await e.getOnboardingStatus();t.success?(t.data,this.backendStatus=t.data,t.data.user_info&&t.data.user_info.role_display&&(this.userRoleDisplay=t.data.user_info.role_display),t.data.progress&&t.data.progress.completed?this.currentStep="success":(this.currentStep=this.determineCurrentStep(t.data.progress||{}),this.currentStep)):(console.warn("⚠️ Failed to get onboarding status:",t.error),this.currentStep=this.getInitialStepFromLocalStorage())}catch(e){console.warn("⚠️ Error initializing onboarding state:",e),this.currentStep=this.getInitialStepFromLocalStorage()}finally{this.loading=!1,this.currentStep}},determineCurrentStep(e){return e.terms_accepted?e.ict_policy_accepted?e.declaration_submitted?e.completed?"success":"terms-popup":"declaration":"policy-popup":"terms-popup"},getInitialStepFromLocalStorage(){const e=localStorage.getItem(`onboarding_step_${this.userId}`),t=JSON.parse(localStorage.getItem("onboarding_completed")||"[]");return t.includes(this.userId)?"success":e||"terms-popup"},saveCurrentStep(){localStorage.setItem(`onboarding_step_${this.userId}`,this.currentStep)},onLoadingComplete(){},showTermsOfService(){this.currentStep="terms-page",this.saveCurrentStep()},async onTermsAccepted(){try{const{authAPI:e}=await Promise.resolve().then(a.bind(a,274)),t=await e.acceptTerms();t.success?(this.currentStep="policy-popup",this.saveCurrentStep()):console.error("Failed to accept terms:",t.error)}catch(e){console.error("Error accepting terms:",e),this.currentStep="policy-popup",this.saveCurrentStep()}},showIctPolicy(){this.currentStep="policy-page",this.saveCurrentStep()},async onPolicyAccepted(){try{const{authAPI:e}=await Promise.resolve().then(a.bind(a,274)),t=await e.acceptIctPolicy();t.success?(this.currentStep="declaration",this.saveCurrentStep()):console.error("Failed to accept ICT policy:",t.error)}catch(e){console.error("Error accepting ICT policy:",e),this.currentStep="declaration",this.saveCurrentStep()}},async onDeclarationSubmitted(e){try{const{authAPI:t}=await Promise.resolve().then(a.bind(a,274)),r=await t.submitDeclaration(e);r.success?(this.currentStep="success",this.saveCurrentStep()):console.error("Failed to submit declaration:",r.error)}catch(t){console.error("Error submitting declaration:",t),this.currentStep="success",this.saveCurrentStep()}},async completeOnboarding(){const e=await this.markOnboardingComplete();e.success?(e.data&&e.data.user_info&&e.data.user_info.role_display&&(this.userRoleDisplay=e.data.user_info.role_display),this.clearOnboardingStep(),this.$emit("onboarding-complete")):console.error("❌ Failed to complete onboarding process")},returnToLogin(){this.$emit("return-to-login")},async markOnboardingComplete(){try{const{authAPI:e}=await Promise.resolve().then(a.bind(a,274)),t=await e.completeOnboarding();if(t.success){const e=JSON.parse(localStorage.getItem("onboarding_completed")||"[]");return e.includes(this.userId)||(e.push(this.userId),localStorage.setItem("onboarding_completed",JSON.stringify(e))),{success:!0,data:t.data}}return console.error("Failed to complete onboarding:",t.error),{success:!1,error:t.error}}catch(e){return console.error("Error completing onboarding:",e),{success:!1,error:e.message}}},clearOnboardingStep(){localStorage.removeItem(`onboarding_step_${this.userId}`)},resetOnboardingState(){localStorage.removeItem(`onboarding_step_${this.userId}`);const e=JSON.parse(localStorage.getItem("onboarding_completed")||"[]"),t=e.filter(e=>e!==this.userId);localStorage.setItem("onboarding_completed",JSON.stringify(t)),this.currentStep="terms-popup",this.saveCurrentStep()},goToPreviousStep(){const e=["terms-popup","terms-page","policy-popup","policy-page","declaration","success"],t=e.indexOf(this.currentStep);t>0?(this.currentStep=e[t-1],this.saveCurrentStep()):this.returnToLogin()}}};const ea=(0,v.A)(Zt,[["render",d]]);var ta=ea,aa={name:"OnboardingPage",components:{OnboardingFlow:ta},setup(){const{user:e,logout:t}=(0,s.h)(),r=(0,n.rd)(),o=async()=>{try{e.value,e.value,e.value;const{authAPI:o}=await Promise.resolve().then(a.bind(a,274)),i=await o.getCurrentUser();if(!i.success)throw console.error("❌ Failed to refresh user data:",i.error),new Error("Failed to refresh user data: "+i.error);{i.data,i.data.needs_onboarding;const e=(await a.e(2226).then(a.bind(a,2226))).default;e.commit("auth/SET_USER",i.data);try{const{useAuthStore:e}=await Promise.resolve().then(a.bind(a,14)),t=e();t.updateUser(i.data)}catch(t){console.warn("⚠️ Could not update Pinia store:",t)}await new Promise(e=>setTimeout(e,200));const o=i.data;o.role,o.needs_onboarding;let s="/user-dashboard";if(o?.role)switch(o.role,o.role){case"admin":s="/admin-dashboard";break;case"ict_officer":s="/ict-dashboard";break;case"head_of_department":s="/hod-dashboard";break;case"divisional_director":s="/divisional-dashboard";break;case"ict_director":s="/dict-dashboard";break;case"staff":default:s="/user-dashboard";break}else console.warn("⚠️ No user role found, using default dashboard");await new Promise(e=>setTimeout(e,300));await r.push(s)}}catch(o){console.error("❌ Error completing onboarding:",o),console.error("📍 Error details:",{message:o.message,stack:o.stack,currentUser:e.value});try{await r.push("/user-dashboard")}catch(i){console.error("❌ Fallback redirect also failed:",i),window.location.href="/user-dashboard"}}},i=async()=>{try{await t(),r.push("/")}catch(e){console.error("Logout error:",e),r.push("/")}};return{currentUser:e,handleOnboardingComplete:o,handleReturnToLogin:i}}};const ra=(0,v.A)(aa,[["render",i]]);var oa=ra}}]);
//# sourceMappingURL=7902.cf95924d.js.map