"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[3631],{6082:function(e,t,s){s.r(t),s.d(t,{default:function(){return st}});s(4114),s(8111),s(2489),s(116),s(1701),s(4603),s(7566),s(8721);var o=s(5796),a=s(5498),n=s(8966),r=s(9101),i=s(373);const l={key:0,class:"mt-6 bg-white rounded-lg shadow-sm border border-gray-200"},d={class:"flex items-center justify-between p-4 border-b border-gray-200"},u={class:"p-4 bg-gray-50 border-b border-gray-200"},c={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},f={class:"ml-2 text-gray-900"},g={class:"ml-2 text-gray-900"},p={class:"ml-2 text-gray-900"},m={class:"p-4"},b={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},v={class:"flex items-center"},x={key:0,class:"w-2 h-2 bg-white rounded-full m-0.5"},h={class:"flex items-center"},w={key:0,class:"w-2 h-2 bg-white rounded-full m-0.5"},k={class:"flex items-center"},y={key:0,class:"w-2 h-2 bg-white rounded-full m-0.5"},L={class:"mb-6"},_={class:"mt-1 text-xs text-gray-500"},C={key:0,class:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md"},q={class:"flex items-center"},R={class:"text-red-700 text-sm"},I={class:"flex justify-end space-x-3"},E=["disabled"],S={key:0,class:"w-4 h-4 mr-2 animate-spin",fill:"none",viewBox:"0 0 24 24"},A={key:1,class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},T={key:2},P={key:3};function F(e,t,s,a,n,r){return s.show?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",d,[t[6]||(t[6]=(0,o.Lk)("h3",{class:"text-lg font-semibold text-gray-900 flex items-center"},[(0,o.Lk)("svg",{class:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})]),(0,o.eW)(" Update Implementation Progress ")],-1)),(0,o.Lk)("span",{class:(0,o.C4)(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",r.getRequestStatusClasses(s.requestData?.status)])},(0,o.v_)(r.getRequestStatusLabel(s.requestData?.status)),3)]),(0,o.Lk)("div",u,[(0,o.Lk)("div",c,[(0,o.Lk)("div",null,[t[7]||(t[7]=(0,o.Lk)("span",{class:"font-medium text-gray-700"},"Request ID:",-1)),(0,o.Lk)("span",f,(0,o.v_)(s.requestData?.request_id||`REQ-${s.requestData?.id?.toString().padStart(6,"0")}`),1)]),(0,o.Lk)("div",null,[t[8]||(t[8]=(0,o.Lk)("span",{class:"font-medium text-gray-700"},"Staff Name:",-1)),(0,o.Lk)("span",g,(0,o.v_)(s.requestData?.staff_name||"N/A"),1)]),(0,o.Lk)("div",null,[t[9]||(t[9]=(0,o.Lk)("span",{class:"font-medium text-gray-700"},"Department:",-1)),(0,o.Lk)("span",p,(0,o.v_)(s.requestData?.department_name||"N/A"),1)])])]),(0,o.Lk)("div",m,[(0,o.Lk)("div",b,[(0,o.Lk)("div",{class:(0,o.C4)(["p-4 rounded-lg border-2 cursor-pointer transition-all duration-200","implementation_in_progress"===n.selectedStatus?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300 hover:bg-blue-25"]),onClick:t[0]||(t[0]=e=>r.selectStatus("implementation_in_progress"))},[(0,o.Lk)("div",v,[(0,o.Lk)("div",{class:(0,o.C4)(["w-4 h-4 rounded-full border-2 mr-3","implementation_in_progress"===n.selectedStatus?"border-blue-500 bg-blue-500":"border-gray-300"])},["implementation_in_progress"===n.selectedStatus?((0,o.uX)(),(0,o.CE)("div",x)):(0,o.Q3)("",!0)],2),(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:(0,o.C4)(["font-semibold text-base","implementation_in_progress"===n.selectedStatus?"text-blue-900":"text-gray-700"])}," In Progress ",2),t[10]||(t[10]=(0,o.Lk)("div",{class:"text-sm text-gray-500"},"Implementation has started",-1))])]),t[11]||(t[11]=(0,o.Lk)("div",{class:"mt-2 flex items-center text-sm text-blue-600"},[(0,o.Lk)("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),(0,o.eW)(" Working on it ")],-1))],2),(0,o.Lk)("div",{class:(0,o.C4)(["p-4 rounded-lg border-2 cursor-pointer transition-all duration-200","implemented"===n.selectedStatus?"border-green-500 bg-green-50":"border-gray-200 bg-white hover:border-green-300 hover:bg-green-25"]),onClick:t[1]||(t[1]=e=>r.selectStatus("implemented"))},[(0,o.Lk)("div",h,[(0,o.Lk)("div",{class:(0,o.C4)(["w-4 h-4 rounded-full border-2 mr-3","implemented"===n.selectedStatus?"border-green-500 bg-green-500":"border-gray-300"])},["implemented"===n.selectedStatus?((0,o.uX)(),(0,o.CE)("div",w)):(0,o.Q3)("",!0)],2),(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:(0,o.C4)(["font-semibold text-base","implemented"===n.selectedStatus?"text-green-900":"text-gray-700"])}," Completed ",2),t[12]||(t[12]=(0,o.Lk)("div",{class:"text-sm text-gray-500"},"Implementation finished",-1))])]),t[13]||(t[13]=(0,o.Lk)("div",{class:"mt-2 flex items-center text-sm text-green-600"},[(0,o.Lk)("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[(0,o.Lk)("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})]),(0,o.eW)(" All done ")],-1))],2),(0,o.Lk)("div",{class:(0,o.C4)(["p-4 rounded-lg border-2 cursor-pointer transition-all duration-200","rejected"===n.selectedStatus?"border-red-500 bg-red-50":"border-gray-200 bg-white hover:border-red-300 hover:bg-red-25"]),onClick:t[2]||(t[2]=e=>r.selectStatus("rejected"))},[(0,o.Lk)("div",k,[(0,o.Lk)("div",{class:(0,o.C4)(["w-4 h-4 rounded-full border-2 mr-3","rejected"===n.selectedStatus?"border-red-500 bg-red-500":"border-gray-300"])},["rejected"===n.selectedStatus?((0,o.uX)(),(0,o.CE)("div",y)):(0,o.Q3)("",!0)],2),(0,o.Lk)("div",null,[(0,o.Lk)("div",{class:(0,o.C4)(["font-semibold text-base","rejected"===n.selectedStatus?"text-red-900":"text-gray-700"])}," Rejected ",2),t[14]||(t[14]=(0,o.Lk)("div",{class:"text-sm text-gray-500"},"Cannot be implemented",-1))])]),t[15]||(t[15]=(0,o.Lk)("div",{class:"mt-2 flex items-center text-sm text-red-600"},[(0,o.Lk)("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})]),(0,o.eW)(" Issue found ")],-1))],2)]),(0,o.Lk)("div",L,[t[16]||(t[16]=(0,o.Lk)("label",{for:"comments",class:"block text-sm font-medium text-gray-700 mb-2"},[(0,o.eW)(" Implementation Comments "),(0,o.Lk)("span",{class:"text-gray-500 font-normal"},"(Optional)")],-1)),(0,o.bo)((0,o.Lk)("textarea",{id:"comments","onUpdate:modelValue":t[3]||(t[3]=e=>n.comments=e),rows:"4",placeholder:"Add details about the implementation progress, any issues encountered, or completion notes...",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none text-sm"},null,512),[[o.Jo,n.comments]]),(0,o.Lk)("div",_,(0,o.v_)(n.comments.length)+"/500 characters",1)]),n.error?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",q,[t[17]||(t[17]=(0,o.Lk)("svg",{class:"w-4 h-4 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[(0,o.Lk)("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)),(0,o.Lk)("span",R,(0,o.v_)(n.error),1)])])):(0,o.Q3)("",!0),(0,o.Lk)("div",I,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>r.close&&r.close(...e)),class:"px-6 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200"}," Cancel "),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>r.updateProgress&&r.updateProgress(...e)),disabled:!n.selectedStatus||n.updating,class:"inline-flex items-center px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},[n.updating?((0,o.uX)(),(0,o.CE)("svg",S,[...t[18]||(t[18]=[(0,o.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),(0,o.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):((0,o.uX)(),(0,o.CE)("svg",A,[...t[19]||(t[19]=[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])),n.updating?((0,o.uX)(),(0,o.CE)("span",T,"Updating...")):((0,o.uX)(),(0,o.CE)("span",P,"Update Progress"))],8,E)])])])):(0,o.Q3)("",!0)}var D=s(5389),j=s(1127),N={name:"UpdateProgress",props:{show:{type:Boolean,default:!1},requestId:{type:[Number,String],required:!0},requestData:{type:Object,default:null}},emits:["close","updated"],setup(){const{hasRole:e,ROLES:t,user:s}=(0,j.h)();return{hasRole:e,ROLES:t,currentUser:s}},data(){return{selectedStatus:"",comments:"",updating:!1,error:null}},computed:{canUpdate(){return!(!this.hasRole(this.ROLES.ICT_OFFICER)||!this.requestData)&&(this.requestData.ict_officer_user_id&&this.requestData.ict_officer_user_id===this.currentUser?.id&&!this.requestData.ict_officer_implemented_at&&"implemented"!==this.requestData.ict_officer_status&&"rejected"!==this.requestData.ict_officer_status)}},watch:{show(e){e&&this.resetForm()},comments(e){e.length>500&&(this.comments=e.substring(0,500))}},methods:{selectStatus(e){this.selectedStatus=e,this.error=null},resetForm(){this.selectedStatus="",this.comments="",this.error=null,this.updating=!1},async updateProgress(){if(this.selectedStatus){this.updating=!0,this.error=null;try{const e=await D["default"].updateProgress(this.requestId,this.selectedStatus,this.comments);e.success?(this.showSuccessMessage(),this.refreshNotificationBadge(),this.$emit("updated"),this.$emit("close"),this.resetForm()):this.error=e.message||"Failed to update progress"}catch(e){console.error("Error updating progress:",e),this.error=e.message||"Network error while updating progress"}finally{this.updating=!1}}else this.error="Please select a status"},close(){this.$emit("close")},showSuccessMessage(){const e=document.createElement("div");e.className="fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 transition-all duration-300",e.innerHTML='\n        <div class="flex items-center">\n          <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">\n            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>\n          </svg>\n          Progress updated successfully!\n        </div>\n      ',document.body.appendChild(e),setTimeout(()=>{e.parentNode&&(e.style.transform="translateX(100%)",e.style.opacity="0",setTimeout(()=>{document.body.removeChild(e)},300))},3e3)},getRequestStatusClasses(e){switch(e){case"assigned_to_ict":return"bg-blue-100 text-blue-800";case"implementation_in_progress":return"bg-purple-100 text-purple-800";case"implemented":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},getRequestStatusLabel(e){switch(e){case"assigned_to_ict":return"Assigned to ICT";case"implementation_in_progress":return"In Progress";case"implemented":return"Implemented";case"rejected":return"Rejected";default:return"Unknown"}},refreshNotificationBadge(){try{if(this.clearNotificationCache(),window.dispatchEvent){const e=new CustomEvent("force-refresh-notifications",{detail:{source:"UpdateProgress",reason:"implementation_status_updated",requestId:this.requestId,newStatus:this.selectedStatus,timestamp:Date.now()}});window.dispatchEvent(e)}window.sidebarInstance&&window.sidebarInstance.fetchNotificationCounts&&window.sidebarInstance.fetchNotificationCounts(!0),setTimeout(()=>{if(this.clearNotificationCache(),window.dispatchEvent){const e=new CustomEvent("refresh-notifications",{detail:{source:"UpdateProgress_delayed",reason:"delayed_refresh",requestId:this.requestId}});window.dispatchEvent(e)}window.sidebarInstance&&window.sidebarInstance.fetchNotificationCounts&&window.sidebarInstance.fetchNotificationCounts(!0)},2e3),["implemented","completed"].includes(this.selectedStatus)&&setTimeout(()=>{this.clearNotificationCache(),window.sidebarInstance&&window.sidebarInstance.fetchNotificationCounts&&window.sidebarInstance.fetchNotificationCounts(!0)},5e3)}catch(e){console.warn("UpdateProgress: Failed to refresh notification badge:",e)}},clearNotificationCache(){try{s.e(4710).then(s.bind(s,4710)).then(e=>{e.default.clearCache()})}catch(e){console.warn("UpdateProgress: Failed to clear notification cache:",e)}}}},X=s(1241);const U=(0,X.A)(N,[["render",F],["__scopeId","data-v-25e00bee"]]);var M=U,Q=s(9423);const K={class:"flex flex-col h-screen"},z={class:"flex flex-1 overflow-hidden"},B={class:"sidebar-narrow"},O={class:"flex-1 p-4 bg-blue-900 overflow-y-auto"},$={class:"max-w-full mx-auto"},W={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},V={class:"text-lg"},H={class:"grid grid-cols-4 gap-4 mb-6"},Y={class:"bg-green-600/25 border border-green-400/40 p-4 rounded-lg"},G={class:"text-white text-3xl font-bold"},J={class:"bg-blue-600/25 border border-blue-400/40 p-4 rounded-lg"},Z={class:"text-white text-3xl font-bold"},ee={class:"bg-purple-600/25 border border-purple-400/40 p-4 rounded-lg"},te={class:"text-white text-3xl font-bold"},se={class:"bg-teal-600/25 border border-teal-400/40 p-4 rounded-lg"},oe={class:"text-white text-3xl font-bold"},ae={class:"bg-white/10 rounded-lg p-4 mb-6"},ne={class:"flex gap-4"},re={class:"bg-white/10 rounded-lg"},ie={class:"overflow-x-auto",style:{"overflow-y":"visible"}},le={class:"w-full"},de={class:"px-4 py-3"},ue={class:"flex items-center space-x-2"},ce={class:"flex-shrink-0"},fe={key:0,class:"fas fa-clock text-yellow-400 text-base",title:"Available for assignment"},ge={key:1,class:"fas fa-check-circle text-green-400 text-base",title:"Assigned or in progress"},pe={class:"text-white font-medium text-sm"},me={class:"text-purple-300 text-xs"},be={class:"px-4 py-3"},ve={class:"text-white font-medium text-sm"},xe={class:"text-blue-300 text-xs"},he={class:"px-4 py-3"},we={class:"flex flex-nowrap gap-1"},ke={key:0,class:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800 whitespace-nowrap"},ye={key:1,class:"px-2 py-1 rounded text-xs bg-green-100 text-green-800 whitespace-nowrap"},Le={key:2,class:"px-2 py-1 rounded text-xs bg-cyan-100 text-cyan-800 whitespace-nowrap"},_e={class:"px-4 py-3"},Ce={class:"text-white font-medium text-sm"},qe={class:"text-blue-300 text-xs"},Re={key:0,class:"text-teal-300 text-xs"},Ie={class:"px-4 py-3"},Ee={class:"text-white font-medium text-sm"},Se={class:"text-blue-300 text-xs"},Ae={class:"px-4 py-3"},Te={class:"flex flex-col"},Pe={class:"px-4 py-3"},Fe={class:"flex items-center space-x-2"},De=["onClick","disabled"],je={key:0},Ne={key:1},Xe={key:1,class:"text-xs text-blue-200 ml-1"},Ue={class:"px-4 py-3 text-center",style:{overflow:"visible"}},Me={class:"relative inline-block",style:{overflow:"visible"}},Qe=["onClick","title"],Ke={key:0,class:"text-center py-12"},ze={class:"text-blue-300 text-base"},Be={key:1,class:"px-4 py-3 border-t border-blue-300/30"},Oe={class:"text-blue-300 text-base"},$e={class:"bg-white/90 rounded-xl shadow-2xl p-6 w-full max-w-md border border-blue-200"},We={class:"flex items-center gap-3 mb-3"},Ve={class:"text-lg font-semibold text-gray-800"},He={class:"w-full h-3 bg-gray-200 rounded-full overflow-hidden"},Ye={class:"mt-4 flex justify-end"},Ge={key:1,class:"absolute inset-0 z-40 flex items-center justify-center pointer-events-none animate-fade-in"},Je={class:"max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Ze=5;var et={__name:"AccessRequests",setup(e){const t=(0,o.KR)([]),l=(0,o.KR)(""),d=(0,o.KR)(""),u=(0,o.KR)(!1),c=(0,o.KR)(!1),f=(0,o.KR)(0),g=(0,o.Kh)({unassigned:0,assigned:0,inProgress:0,total:0}),p=(0,o.KR)(null),m=(0,o.Kh)({total:0,currentPage:1,perPage:20}),b=(0,o.KR)(!1),v=(0,o.KR)(null),x=(0,o.KR)(null),h=(0,o.KR)(!1),w=(0,o.KR)(null),k=(0,o.KR)(null),{ROLES:y,requireRole:L,user:_,userRole:C,ensureInitialized:q}=(0,j.h)(),R=e=>"head_of_it_approved"===e||!e,I=(0,o.EW)(()=>{if(!Array.isArray(t.value))return console.warn("IctAccessRequests: accessRequests is not an array:",t.value),[];let e=t.value;if(l.value){const t=l.value.toLowerCase();e=e.filter(e=>(e.staff_name||e.full_name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.department_name||e.department||"").toLowerCase().includes(t)||(e.request_id||"").toLowerCase().includes(t))}return d.value&&(e="unassigned"===d.value?e.filter(e=>R(e.status)):e.filter(e=>e.status===d.value)),e.sort((e,t)=>{const s=R(e.status),o=R(t.status);if(s&&!o)return-1;if(!s&&o)return 1;const a=e=>new Date(e.head_of_it_approval_date||e.head_of_it_approved_at||e.created_at||0);return a(e)-a(t)})});async function E(){u.value=!0,p.value=null;try{const e=await D["default"].getAccessRequests();if(e.success){const s=e.data,o=Array.isArray(s)?s:s&&Array.isArray(s.data)?s.data:[],a=Array.isArray(s)?s.length:s?.total??o.length,n=s?.current_page??1,r=s?.per_page??o.length;o.length,t.value=o,m.total=a,m.currentPage=n,m.perPage=r;const i=t.value.filter(e=>R(e.status)).length;g.unassigned=i,g.assigned=t.value.filter(e=>"assigned_to_ict"===e.status).length,g.inProgress=t.value.filter(e=>"implementation_in_progress"===e.status).length,g.total=t.value.length,kt(i);const l=!1;l&&setTimeout(()=>yt(),1e3)}else console.error("âŒ IctAccessRequests: Failed to load requests:",e.message),p.value=e.message}catch(e){console.error("âŒ IctAccessRequests: Error loading requests:",e),p.value="Network error while loading access requests. Please check your connection."}finally{u.value=!1}}async function S(){await E(),St()}async function A(e){e.id;try{q&&"function"===typeof q&&await q();const t=("function"===typeof C?C():C?.value)||_?.value?.primary_role||_?.value?.role;if(t!==y.ICT_OFFICER)return console.warn("Blocked navigation: current role is not ICT_OFFICER",{role:t}),window.location.href="/ict-dashboard",await(0,o.dY)(),void alert("You do not have permission to process this request.");const s=e.id;if(!s)return console.warn("Missing id on request, cannot open form.",e),await(0,o.dY)(),void alert("Cannot open form: missing request id.");window.location.href=`/ict-dashboard/both-service-form/${s}`}catch(t){console.error("Failed to open request processing page:",t),await(0,o.dY)(),alert("Unable to open the request. Please try again.")}}async function T(e){e.id;try{const t=await D["default"].assignTaskToSelf(e.id,"Task assigned by ICT Officer");t.success?(await E(),ht(),alert("Task assigned successfully!")):alert("Failed to assign task: "+t.message)}catch(p){console.error("Error assigning task:",p),alert("Network error while assigning task")}}async function P(e){e.id;try{const t=await D["default"].updateProgress(e.id,"implementation_in_progress","Implementation started");t.success?(await E(),ht(),alert("Progress updated successfully!")):alert("Failed to update progress: "+t.message)}catch(p){console.error("Error updating progress:",p),alert("Network error while updating progress")}}async function F(e){e.id;const t=prompt("Please provide a reason for canceling this task:");if(t&&t.trim())try{const s=await D["default"].cancelTask(e.id,t);s.success?(await E(),ht(),alert("Task canceled successfully!")):alert("Failed to cancel task: "+s.message)}catch(p){console.error("Error canceling task:",p),alert("Network error while canceling task")}}function N(e,t){return"jeeva"===t?e.jeeva_access_required||e.request_types&&e.request_types.includes("jeeva"):"wellsoft"===t?e.wellsoft_access_required||e.request_types&&e.request_types.includes("wellsoft"):"internet"===t&&(e.internet_access_required||e.request_types&&e.request_types.includes("internet"))}function X(e){const t=[];return N(e,"jeeva")&&t.push("Jeeva"),N(e,"wellsoft")&&t.push("Wellsoft"),N(e,"internet")&&t.push("Internet"),t.length>0?t.join(" + "):"Access Request"}function U(e){const t={head_of_it_approved:"bg-yellow-500 text-yellow-900",assigned_to_ict:"bg-blue-500 text-blue-900",implementation_in_progress:"bg-purple-500 text-purple-900",completed:"bg-emerald-500 text-emerald-900",implemented:"bg-green-500 text-green-900",cancelled:"bg-red-500 text-red-900"};return t[e]||"bg-gray-500 text-gray-900"}function et(e){const t={head_of_it_approved:"Pending Implementation",assigned_to_ict:"Assigned to ICT Officer",implementation_in_progress:"Implementation in Progress",completed:"Implementation Completed",implemented:"Access Granted",cancelled:"Task Cancelled"};return t[e]||e?.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())||"Unknown Status"}function tt(e){if("implemented"===e.status||"completed"===e.status){const t=e=>{if(void 0===e||null===e)return null;if("boolean"===typeof e)return e?"sent":"pending";if("number"===typeof e)return 1===e?"sent":0===e?"pending":null;const t=String(e).toLowerCase().trim();return["sent","delivered","success","successful","ok","delivrd","delivery_ok","submitted","accepted","done","complete","completed"].includes(t)?"sent":["failed","fail","error","undelivered","rejected","expired","blocked","blacklisted"].includes(t)?"failed":["queued","queue","processing","pending","in_progress"].includes(t)?"pending":t||null},s=e.requester_sms_sent_at||e.sms_to_requester_at||e.sms_delivered_to_requester_at;if(s)return"sent";const o=[e.sms_to_requester_status,e.sms_to_requester,e.requester_sms_status,e.sms_delivery_status_to_requester,e.sms_status].map(t).filter(Boolean);return o.length?o.find(e=>"pending"!==e)||o[0]:"pending"}return"pending"}function st(e){const t={sent:"Submitted",pending:"Pending",failed:"Failed"};return t[e]||"Pending"}function ot(e){const t={sent:"bg-green-500",pending:"bg-yellow-500",failed:"bg-red-500"};return t[e]||"bg-gray-400"}function at(e){const t={sent:"text-green-400",pending:"text-yellow-400",failed:"text-red-400"};return t[e]||"text-gray-400"}function nt(e){e.id,v.value=e.id,x.value=e,b.value=!0}function rt(){b.value=!1,v.value=null,x.value=null,h.value=!1}async function it(){await E(),ht()}function lt(e){e&&ct(e)&&(x.value=e,v.value=e.id,h.value=!0)}function dt(){h.value=!1}async function ut(){await E(),ht(),St(),rt(),setTimeout(()=>ht(),3e3),setTimeout(()=>ht(),5e3)}function ct(e){if(!e)return!1;const t=_.value?.id;return e.ict_officer_user_id&&e.ict_officer_user_id===t&&!e.ict_officer_implemented_at&&"implemented"!==e.ict_officer_status&&"rejected"!==e.ict_officer_status&&!["implemented","completed"].includes(e.status)&&("assigned_to_ict"===e.status||"implementation_in_progress"===e.status)}function ft(e,t,s){if(w.value===e)w.value=null,x.value=null;else if(w.value=e,x.value=s,t){const e=t.target.closest("button");if(e){const t=e.getBoundingClientRect();k.value={top:t.top+window.scrollY,right:window.innerWidth-t.right-window.scrollX,showAbove:!0}}}}function gt(){if(k.value){const e=192,t=120;let{top:s,right:o,showAbove:a}=k.value;return o+e>window.innerWidth&&(o=Math.max(4,window.innerWidth-e-4)),a&&(s-=t,s<window.scrollY+4&&(s=window.scrollY+4)),{top:`${s}px`,right:`${o}px`,left:"auto"}}return{top:"100%",right:"0",left:"auto",position:"absolute"}}function pt(e){!w.value||e.target.closest('[style*="z-index: 9999"]')||e.target.closest('button[title*="Actions for"]')||(w.value=null,k.value=null)}async function mt(e){try{if(!e?.id)return void alert("Missing request id");c.value=!0,f.value=0;const t=await Q.A.get(`/both-service-form/${e.id}/export-pdf`,{responseType:"blob",onDownloadProgress:e=>{if(e.total)f.value=Math.min(100,Math.round(100*e.loaded/e.total));else{const e=f.value+3;f.value=e>=95?95:e}}}),s=new Blob([t.data],{type:"application/pdf"}),o=URL.createObjectURL(s),a=document.createElement("a");a.href=o,a.download=`access-request-${e.id}.pdf`,document.body.appendChild(a),a.click(),URL.revokeObjectURL(o),a.remove(),f.value=100,setTimeout(()=>c.value=!1,400)}catch(t){console.error("Failed to download PDF:",t),c.value=!1,f.value=0,alert("Failed to download PDF. Please try again.")}}function bt(e,t){switch(w.value=null,k.value=null,e){case"viewRequest":A(t);break;case"viewTimeline":nt(t);break;case"downloadPdf":mt(t);break;case"assignTask":T(t);break;case"updateProgress":P(t);break;case"cancelTask":F(t);break;default:console.warn("Unknown action:",e)}}function vt(e){if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB")}catch{return"Invalid Date"}}function xt(e){if(!e)return"N/A";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Time"}}function ht(){try{const e=t.value.filter(e=>R(e.status)).length;if(kt(e),wt(),window.dispatchEvent){const e=new CustomEvent("force-refresh-notifications",{detail:{source:"AccessRequests",reason:"request_updated",timestamp:Date.now()}});window.dispatchEvent(e)}window.sidebarInstance&&window.sidebarInstance.fetchNotificationCounts&&window.sidebarInstance.fetchNotificationCounts(!0)}catch(e){console.warn("Failed to refresh notification badge:",e)}}function wt(){try{s.e(4710).then(s.bind(s,4710)).then(e=>{e.default.clearCache()})}catch(e){console.warn("Failed to clear notification cache:",e)}}function kt(e){try{if("undefined"!==typeof window&&(window.accessRequestsPendingCount=e),window.dispatchEvent){const t=new CustomEvent("ict-access-requests-pending-count",{detail:{count:e,source:"AccessRequests",timestamp:Date.now()}});window.dispatchEvent(t)}window.sidebarInstance&&window.sidebarInstance.setNotificationCount&&window.sidebarInstance.setNotificationCount("/ict-dashboard/access-requests",e)}catch(t){console.warn("Failed to set pending count override:",t)}}async function yt(){try{const e=(await s.e(4710).then(s.bind(s,4710))).default;await e.getPendingRequestsCount(!0),await D["default"].getPendingRequestsCount(),t.value.map(e=>({id:e.id,status:e.status,request_id:e.request_id||`REQ-${e.id.toString().padStart(6,"0")}`}));0}catch(e){console.error("ðŸš« DIAGNOSTIC ERROR:",e)}}const Lt=(0,o.Kh)({}),_t=(0,o.Kh)({}),Ct=[3e3,7e3,15e3,3e4,6e4];function qt(e){return Lt[e]||0}function Rt(e){return!!_t[e]}async function It(e){if(!e)return;const s=e.id;if(Lt[s]||(Lt[s]=0),!Rt(s))try{_t[s]=setTimeout(()=>{},0);const o=e.phone_number||e.phone||null;await D["default"].resendRequesterSms(s,o),setTimeout(async()=>{await E(),clearTimeout(_t[s]),delete _t[s];const o=tt(t.value.find(e=>e.id===s)||e);"sent"!==o?Et(s,e):Lt[s]=0},1200)}catch(o){clearTimeout(_t[s]),delete _t[s],Et(s,e)}}function Et(e,t){if(Lt[e]=(Lt[e]||0)+1,Lt[e]>Ze)return;const s=Ct[Math.min(Lt[e]-1,Ct.length-1)];_t[e]=setTimeout(()=>{clearTimeout(_t[e]),delete _t[e],It(t)},s)}function St(){for(const e of t.value){const t=tt(e);["failed","pending"].includes(t)&&["implemented","completed"].includes(e.status)&&(_t[e.id]||0!==(Lt[e.id]||0)||Et(e.id,e))}}return(0,o.sV)(async()=>{try{u.value=!1,c.value=!1,L([y.ICT_OFFICER,y.SECRETARY_ICT]),await E(),ht(),St();const e=!1;e&&yt(),document.addEventListener("click",pt),setTimeout(()=>{u.value&&(console.warn("IctAccessRequests: Forcing isLoading=false after timeout"),u.value=!1)},1e4),setTimeout(()=>{c.value&&0===f.value&&(console.warn("IctAccessRequests: Forcing downloadingPdf=false after timeout"),c.value=!1)},3e4)}catch(e){console.error("IctAccessRequests: Error during mount:",e),p.value="Failed to initialize component: "+e.message,u.value=!1,c.value=!1}}),(0,o.xo)(()=>{document.removeEventListener("click",pt)}),(e,t)=>((0,o.uX)(),(0,o.CE)("div",K,[(0,o.bF)(a.A),(0,o.Lk)("div",z,[(0,o.Lk)("div",B,[(0,o.bF)(n.A)]),(0,o.Lk)("main",O,[(0,o.Lk)("div",$,[p.value?((0,o.uX)(),(0,o.CE)("div",W,[t[19]||(t[19]=(0,o.Lk)("h3",{class:"font-bold text-xl"},"Error",-1)),(0,o.Lk)("p",V,(0,o.v_)(p.value),1),(0,o.Lk)("button",{onClick:E,class:"mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 text-base font-medium"}," Retry ")])):(0,o.Q3)("",!0),(0,o.Lk)("div",H,[(0,o.Lk)("div",Y,[t[20]||(t[20]=(0,o.Lk)("h3",{class:"text-green-200 text-base font-semibold"},"Available for Assignment",-1)),(0,o.Lk)("p",G,(0,o.v_)(g.unassigned),1)]),(0,o.Lk)("div",J,[t[21]||(t[21]=(0,o.Lk)("h3",{class:"text-blue-200 text-base font-semibold"},"Assigned to ICT",-1)),(0,o.Lk)("p",Z,(0,o.v_)(g.assigned),1)]),(0,o.Lk)("div",ee,[t[22]||(t[22]=(0,o.Lk)("h3",{class:"text-purple-200 text-base font-semibold"},"In Progress",-1)),(0,o.Lk)("p",te,(0,o.v_)(g.inProgress),1)]),(0,o.Lk)("div",se,[t[23]||(t[23]=(0,o.Lk)("h3",{class:"text-teal-200 text-base font-semibold"},"Total Requests",-1)),(0,o.Lk)("p",oe,(0,o.v_)(g.total),1)])]),(0,o.Lk)("div",ae,[(0,o.Lk)("div",ne,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),type:"text",placeholder:"Search by staff name, PF number, or department...",class:"flex-1 px-3 py-2 bg-white/20 border border-blue-300/30 rounded text-white placeholder-blue-200/60 text-sm"},null,512),[[o.Jo,l.value]]),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>d.value=e),class:"px-3 py-2 bg-white/20 border border-blue-300/30 rounded text-white text-sm status-select"},[...t[24]||(t[24]=[(0,o.Fv)('<option value="" data-v-5afe819d>All Requests</option><option value="unassigned" data-v-5afe819d>Available for Assignment</option><option value="assigned_to_ict" data-v-5afe819d>Assigned to ICT</option><option value="implementation_in_progress" data-v-5afe819d>In Progress</option><option value="completed" data-v-5afe819d>Completed</option>',5)])],512),[[o.u1,d.value]]),(0,o.Lk)("button",{onClick:S,class:"px-6 py-2 bg-teal-600 text-white rounded hover:bg-teal-700 text-sm font-medium"}," Refresh ")])]),(0,o.Lk)("div",re,[(0,o.Lk)("div",ie,[(0,o.Lk)("table",le,[t[27]||(t[27]=(0,o.Lk)("thead",{class:"bg-blue-800/50"},[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," Request ID "),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," Request Type "),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," Requested Modules "),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," Requester Name & PF Number "),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," Head of IT Approval Date "),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"},"Status"),(0,o.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-semibold"}," SMS Status "),(0,o.Lk)("th",{class:"px-4 py-3 text-center text-blue-100 text-sm font-semibold"}," Actions ")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(I.value,e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id,class:(0,o.C4)(["border-t border-blue-300/20 hover:bg-blue-700/30 transition-colors duration-200",R(e.status)?"bg-yellow-900/20 border-l-4 border-yellow-400":"bg-green-900/10 border-l-4 border-green-600"])},[(0,o.Lk)("td",de,[(0,o.Lk)("div",ue,[(0,o.Lk)("div",ce,[R(e.status)?((0,o.uX)(),(0,o.CE)("i",fe)):((0,o.uX)(),(0,o.CE)("i",ge))]),(0,o.Lk)("div",null,[(0,o.Lk)("div",pe,(0,o.v_)(e.request_id||`REQ-${e.id.toString().padStart(6,"0")}`),1),(0,o.Lk)("div",me,"ID: "+(0,o.v_)(e.id),1)])])]),(0,o.Lk)("td",be,[(0,o.Lk)("div",ve,(0,o.v_)(X(e)),1),(0,o.Lk)("div",xe,(0,o.v_)(e.department_name||e.department||"Unknown Dept"),1)]),(0,o.Lk)("td",he,[(0,o.Lk)("div",we,[N(e,"jeeva")?((0,o.uX)(),(0,o.CE)("span",ke," Jeeva ")):(0,o.Q3)("",!0),N(e,"wellsoft")?((0,o.uX)(),(0,o.CE)("span",ye," Wellsoft ")):(0,o.Q3)("",!0),N(e,"internet")?((0,o.uX)(),(0,o.CE)("span",Le," Internet ")):(0,o.Q3)("",!0)])]),(0,o.Lk)("td",_e,[(0,o.Lk)("div",Ce,(0,o.v_)(e.staff_name||e.full_name||"Unknown User"),1),(0,o.Lk)("div",qe,(0,o.v_)(e.phone||e.phone_number||"No phone"),1),e.pf_number?((0,o.uX)(),(0,o.CE)("div",Re," PF: "+(0,o.v_)(e.pf_number),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("td",Ie,[(0,o.Lk)("div",Ee,(0,o.v_)(vt(e.head_of_it_approval_date||e.head_of_it_approved_at)),1),(0,o.Lk)("div",Se,(0,o.v_)(xt(e.head_of_it_approval_date||e.head_of_it_approved_at)),1)]),(0,o.Lk)("td",Ae,[(0,o.Lk)("div",Te,[(0,o.Lk)("span",{class:(0,o.C4)([U(e.status),"rounded text-sm font-medium inline-block whitespace-nowrap"]),style:{padding:"6px 12px",width:"fit-content"}},(0,o.v_)(et(e.status)),3)])]),(0,o.Lk)("td",Pe,[(0,o.Lk)("div",Fe,[(0,o.Lk)("div",{class:(0,o.C4)(["w-3 h-3 rounded-full",ot(tt(e))])},null,2),(0,o.Lk)("span",{class:(0,o.C4)(["text-sm font-medium",at(tt(e))])},(0,o.v_)(st(tt(e))),3),["failed","pending"].includes(tt(e))&&["implemented","completed"].includes(e.status)?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t=>It(e),disabled:Rt(e.id),class:"ml-2 px-2 py-1 text-xs rounded border border-blue-300/50 text-blue-100 hover:bg-blue-700/40 disabled:opacity-50",title:"Retry sending SMS to requester"},[Rt(e.id)?((0,o.uX)(),(0,o.CE)("span",Ne,[...t[25]||(t[25]=[(0,o.Lk)("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),(0,o.eW)("Retrying ",-1)])])):((0,o.uX)(),(0,o.CE)("span",je,"Retry"))],8,De)):(0,o.Q3)("",!0),qt(e.id)>0?((0,o.uX)(),(0,o.CE)("span",Xe," ("+(0,o.v_)(qt(e.id))+") ",1)):(0,o.Q3)("",!0)])]),(0,o.Lk)("td",Ue,[(0,o.Lk)("div",Me,[(0,o.Lk)("button",{onClick:t=>ft(e.id,t,e),class:"w-8 h-8 flex items-center justify-center text-white hover:bg-white/10 rounded-full transition-colors duration-200",title:"Actions for "+(e.request_id||"REQ-"+e.id.toString().padStart(6,"0"))},[...t[26]||(t[26]=[(0,o.Lk)("i",{class:"fas fa-ellipsis-v text-sm"},null,-1)])],8,Qe)])])],2))),128))])])]),0===I.value.length?((0,o.uX)(),(0,o.CE)("div",Ke,[t[28]||(t[28]=(0,o.Lk)("h3",{class:"text-white text-xl font-medium mb-2"},"No requests found",-1)),(0,o.Lk)("p",ze,(0,o.v_)(l.value||d.value?"No requests match your current filters.":"No access requests approved by Head of IT are currently available."),1)])):(0,o.Q3)("",!0),I.value.length>0?((0,o.uX)(),(0,o.CE)("div",Be,[(0,o.Lk)("div",Oe," Showing "+(0,o.v_)(I.value.length)+" of "+(0,o.v_)(m.total)+" requests ",1)])):(0,o.Q3)("",!0)])])])]),((0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[null!==w.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"fixed w-56 bg-white rounded-lg shadow-2xl border border-gray-200 py-1",style:(0,o.Tr)([gt(),{"z-index":"99999"}]),onClick:t[16]||(t[16]=(0,o.D$)(()=>{},["stop"]))},[x.value&&R(x.value.status)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",{onClick:t[2]||(t[2]=e=>bt("viewRequest",x.value)),class:"w-full text-left px-4 py-3 text-sm bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-inset transition-all duration-200 flex items-center group first:rounded-t-lg"},[...t[29]||(t[29]=[(0,o.Lk)("i",{class:"fas fa-check mr-3 text-green-600 group-hover:text-green-700 group-focus:text-green-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold text-green-800"},"Approve",-1)])]),(0,o.Lk)("button",{onClick:t[3]||(t[3]=e=>bt("viewTimeline",x.value)),class:"w-full text-left px-4 py-3 text-sm bg-indigo-50 text-indigo-800 border-b border-indigo-200 hover:bg-indigo-100 focus:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset transition-all duration-200 flex items-center group"},[...t[30]||(t[30]=[(0,o.Lk)("i",{class:"fas fa-history mr-3 text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"View Timeline",-1)])]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>bt("downloadPdf",x.value)),class:"w-full text-left px-4 py-3 text-sm bg-rose-50 text-rose-800 hover:bg-rose-100 focus:bg-rose-100 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-inset transition-all duration-200 flex items-center group last:rounded-b-lg"},[...t[31]||(t[31]=[(0,o.Lk)("i",{class:"fas fa-file-pdf mr-3 text-rose-600 group-hover:text-rose-700 group-focus:text-rose-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"Download PDF",-1)])])],64)):x.value&&"assigned_to_ict"===x.value.status?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.Lk)("button",{onClick:t[5]||(t[5]=e=>bt("viewRequest",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-inset transition-all duration-200 flex items-center group first:rounded-t-lg"},[...t[32]||(t[32]=[(0,o.Lk)("i",{class:"fas fa-check mr-3 text-green-600 group-hover:text-green-700 group-focus:text-green-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold text-green-800"},"Approve",-1)])]),(0,o.Lk)("button",{onClick:t[6]||(t[6]=e=>bt("viewTimeline",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-indigo-50 text-indigo-800 border-b border-indigo-200 hover:bg-indigo-100 focus:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset transition-all duration-200 flex items-center group"},[...t[33]||(t[33]=[(0,o.Lk)("i",{class:"fas fa-history mr-3 text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"View Timeline",-1)])]),(0,o.Lk)("button",{onClick:t[7]||(t[7]=e=>bt("downloadPdf",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-rose-50 text-rose-800 hover:bg-rose-100 focus:bg-rose-100 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-inset transition-all duration-200 flex items-center group last:rounded-b-lg"},[...t[34]||(t[34]=[(0,o.Lk)("i",{class:"fas fa-file-pdf mr-3 text-rose-600 group-hover:text-rose-700 group-focus:text-rose-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"Download PDF",-1)])])],64)):x.value&&"implementation_in_progress"===x.value.status?((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.Lk)("button",{onClick:t[8]||(t[8]=e=>bt("viewRequest",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-inset transition-all duration-200 flex items-center group first:rounded-t-lg"},[...t[35]||(t[35]=[(0,o.Lk)("i",{class:"fas fa-check mr-3 text-green-600 group-hover:text-green-700 group-focus:text-green-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold text-green-800"},"Approve",-1)])]),(0,o.Lk)("button",{onClick:t[9]||(t[9]=e=>bt("viewTimeline",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-indigo-50 text-indigo-800 border-b border-indigo-200 hover:bg-indigo-100 focus:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset transition-all duration-200 flex items-center group"},[...t[36]||(t[36]=[(0,o.Lk)("i",{class:"fas fa-history mr-3 text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"View Timeline",-1)])]),(0,o.Lk)("button",{onClick:t[10]||(t[10]=e=>bt("downloadPdf",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-rose-50 text-rose-800 hover:bg-rose-100 focus:bg-rose-100 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-inset transition-all duration-200 flex items-center group last:rounded-b-lg"},[...t[37]||(t[37]=[(0,o.Lk)("i",{class:"fas fa-file-pdf mr-3 text-rose-600 group-hover:text-rose-700 group-focus:text-rose-700 transition-colors duration-200 text-lg"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"Download PDF",-1)])])],64)):!x.value||"completed"!==x.value.status&&"implemented"!==x.value.status?x.value?((0,o.uX)(),(0,o.CE)(o.FK,{key:4},[(0,o.Lk)("button",{onClick:t[14]||(t[14]=e=>bt("viewRequest",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-blue-50 text-blue-800 border-b border-blue-200 hover:bg-blue-100 focus:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset transition-all duration-200 flex items-center group first:rounded-t-lg"},[...t[41]||(t[41]=[(0,o.Lk)("i",{class:"fas fa-eye mr-3 text-blue-600 group-hover:text-blue-700 group-focus:text-blue-700 transition-colors duration-200"},null,-1),(0,o.Lk)("span",{class:"font-semibold text-blue-800"},"View Request",-1)])]),(0,o.Lk)("button",{onClick:t[15]||(t[15]=e=>bt("viewTimeline",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-indigo-50 text-indigo-800 hover:bg-indigo-100 focus:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset transition-all duration-200 flex items-center group last:rounded-b-lg"},[...t[42]||(t[42]=[(0,o.Lk)("i",{class:"fas fa-history mr-3 text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700 transition-colors duration-200"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"View Timeline",-1)])])],64)):(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.Lk)("button",{onClick:t[11]||(t[11]=e=>bt("viewRequest",x.value)),class:"w-full text-left px-4 py-3 text-sm bg-blue-50 text-blue-800 border-b border-blue-200 hover:bg-blue-100 focus:bg-blue-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-inset transition-all duration-200 flex items-center group first:rounded-t-lg"},[...t[38]||(t[38]=[(0,o.Lk)("i",{class:"fas fa-eye mr-3 text-blue-600 group-hover:text-blue-700 group-focus:text-blue-700 transition-colors duration-200"},null,-1),(0,o.Lk)("span",{class:"font-semibold text-blue-800"},"View Request",-1)])]),(0,o.Lk)("button",{onClick:t[12]||(t[12]=e=>bt("viewTimeline",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-indigo-50 text-indigo-800 border-b border-indigo-200 hover:bg-indigo-100 focus:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-inset transition-all duration-200 flex items-center group"},[...t[39]||(t[39]=[(0,o.Lk)("i",{class:"fas fa-history mr-3 text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700 transition-colors duration-200"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"View Timeline",-1)])]),(0,o.Lk)("button",{onClick:t[13]||(t[13]=e=>bt("downloadPdf",x.value)),class:"w-full text-left px-4 py-3 text-lg bg-rose-50 text-rose-800 hover:bg-rose-100 focus:bg-rose-100 focus:outline-none focus:ring-2 focus:ring-rose-500 focus:ring-inset transition-all duration-200 flex items-center group last:rounded-b-lg"},[...t[40]||(t[40]=[(0,o.Lk)("i",{class:"fas fa-file-pdf mr-3 text-rose-600 group-hover:text-rose-700 group-focus:text-rose-700 transition-colors duration-200"},null,-1),(0,o.Lk)("span",{class:"font-semibold"},"Download PDF",-1)])])],64))],4)):(0,o.Q3)("",!0)])),(0,o.bF)(r.A),c.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"fixed inset-0 z-[100002] flex items-center justify-center bg-black/40",onClick:t[18]||(t[18]=(0,o.D$)(e=>c.value=!1,["self"]))},[(0,o.Lk)("div",$e,[(0,o.Lk)("div",We,[t[43]||(t[43]=(0,o.Lk)("i",{class:"fas fa-file-pdf text-rose-600 text-2xl"},null,-1)),(0,o.Lk)("div",Ve," Downloading PDFâ€¦ "+(0,o.v_)(f.value)+"% ",1)]),(0,o.Lk)("div",He,[(0,o.Lk)("div",{class:"h-full bg-gradient-to-r from-rose-500 to-blue-600",style:(0,o.Tr)({width:f.value+"%"})},null,4)]),t[44]||(t[44]=(0,o.Lk)("div",{class:"text-sm text-gray-700 mt-3 font-semibold"}," Please keep this tab open until the download completes. ",-1)),(0,o.Lk)("div",Ye,[(0,o.Lk)("button",{type:"button",class:"px-3 py-1.5 text-sm rounded-md bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold",onClick:t[17]||(t[17]=e=>c.value=!1),title:"Dismiss overlay"}," Dismiss ")])])])):(0,o.Q3)("",!0),u.value?((0,o.uX)(),(0,o.CE)("div",Ge,[...t[45]||(t[45]=[(0,o.Fv)('<div class="pointer-events-auto w-full max-w-lg mx-auto" data-v-5afe819d><div class="relative bg-gradient-to-br from-white/20 via-blue-50/30 to-white/10 border-2 border-blue-300/50 backdrop-blur-xl rounded-3xl p-8 shadow-2xl overflow-hidden" data-v-5afe819d><div class="absolute inset-0 opacity-10" data-v-5afe819d><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-slide-across" data-v-5afe819d></div><div class="absolute top-4 left-4 w-16 h-16 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.2);" data-v-5afe819d></div><div class="absolute bottom-4 right-4 w-20 h-20 bg-blue-400/20 rounded-full animate-float" style="animation-delay:1s;" data-v-5afe819d></div><div class="absolute top-1/2 left-8 w-12 h-12 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.15);animation-delay:2s;" data-v-5afe819d></div></div><div class="relative z-10" data-v-5afe819d><div class="flex items-center justify-center gap-6 mb-6" data-v-5afe819d><div class="relative" data-v-5afe819d><div class="w-16 h-16 bg-gradient-to-br from-blue-500/30 to-teal-500/30 rounded-2xl backdrop-blur-sm border-2 border-blue-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300" data-v-5afe819d><img src="/assets/images/ngao2.png" alt="National Shield" class="max-w-12 max-h-12 object-contain drop-shadow-lg" data-v-5afe819d></div><div class="absolute -inset-1 bg-gradient-to-r from-blue-400 to-teal-400 rounded-2xl opacity-20 blur-sm animate-pulse" data-v-5afe819d></div></div><div class="relative flex flex-col items-center" data-v-5afe819d><div class="relative mb-3" data-v-5afe819d><div class="rounded-full h-12 w-12 border-2 border-gray-300/20" data-v-5afe819d></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-top-color:#ff0000;animation-duration:2s;" data-v-5afe819d></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-bottom-color:#0000d1;animation-direction:reverse;animation-duration:1.5s;" data-v-5afe819d></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-right-color:rgba(255, 0, 0, 0.7);animation-duration:2.5s;" data-v-5afe819d></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-left-color:rgba(0, 0, 209, 0.7);animation-direction:reverse;animation-duration:1.8s;" data-v-5afe819d></div></div><div class="text-center" data-v-5afe819d><div class="text-white text-xl font-bold tracking-wide mb-1 drop-shadow-md" data-v-5afe819d> Loading Access Requests </div><div class="text-blue-100 text-sm animate-pulse" data-v-5afe819d>Please wait...</div></div></div><div class="relative" data-v-5afe819d><div class="w-16 h-16 bg-gradient-to-br from-teal-500/30 to-blue-500/30 rounded-2xl backdrop-blur-sm border-2 border-teal-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300" data-v-5afe819d><img src="/assets/images/logo2.png" alt="MNH Logo" class="max-w-12 max-h-12 object-contain drop-shadow-lg" data-v-5afe819d></div><div class="absolute -inset-1 bg-gradient-to-r from-teal-400 to-blue-400 rounded-2xl opacity-20 blur-sm animate-pulse" style="animation-delay:0.5s;" data-v-5afe819d></div></div></div><div class="text-center border-t border-blue-300/30 pt-4" data-v-5afe819d><div class="text-lg font-black tracking-widest mb-1 drop-shadow-sm" style="color:#ff0000;" data-v-5afe819d> MUHIMBILI NATIONAL HOSPITAL </div><div class="text-teal-200 text-sm font-semibold tracking-wider" data-v-5afe819d> ICT ACCESS REQUESTS MANAGEMENT </div></div><div class="flex justify-center gap-2 mt-4" data-v-5afe819d><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;" data-v-5afe819d></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.1s;" data-v-5afe819d></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;animation-delay:0.2s;" data-v-5afe819d></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.3s;" data-v-5afe819d></div></div></div></div></div>',1)])])):(0,o.Q3)("",!0),(0,o.bF)(i.A,{show:b.value,"request-id":v.value,onClose:rt,onUpdated:it,onOpenUpdateProgress:lt},null,8,["show","request-id"]),h.value&&x.value?((0,o.uX)(),(0,o.CE)("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10001]",onClick:(0,o.D$)(dt,["self"])},[(0,o.Lk)("div",Je,[(0,o.bF)(M,{show:h.value,"request-id":v.value,"request-data":x.value,onClose:dt,onUpdated:ut},null,8,["show","request-id","request-data"])])])):(0,o.Q3)("",!0)]))}};const tt=(0,X.A)(et,[["__scopeId","data-v-5afe819d"]]);var st=tt},9423:function(e,t,s){var o=s(4373);const a="/api",n=o.A.create({baseURL:a,timeout:parseInt("30000")||1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}});n.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("session_data"),window.location.href="/login"),Promise.reject(e))),t.A=n}}]);
//# sourceMappingURL=3631.5523c647.js.map