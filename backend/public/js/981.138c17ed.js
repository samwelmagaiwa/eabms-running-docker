"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[981],{981:function(s,e,t){t.d(e,{authService:function(){return c}});var a=t(4373);const r="http://127.0.0.1:8000/api",o=a.A.create({baseURL:r,timeout:parseInt("30000")||1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}});o.interceptors.request.use(s=>{const e=localStorage.getItem("auth_token");return e&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s)),o.interceptors.response.use(s=>s,s=>{const e=s.response?.status,t=(s.config?.method||"").toString().toLowerCase(),a=(s.config?.url||"").toString();if(401===e){const s="post"===t&&a.includes("/login");s||(localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("session_data"),window.location.href="/login")}return Promise.reject(s)});const c={async login(s){try{const e=await o.post("/login",s);return{success:!0,data:e.data}}catch(e){return{success:!1,message:e.response?.data?.message||"Login failed",errors:e.response?.data?.errors||{}}}},async logout(){try{const s=await o.post("/logout");return{success:!0,data:s.data}}catch(s){return{success:!0,message:"Logged out locally (API call failed)"}}},async logoutAll(){try{const s=await o.post("/logout-all");return{success:!0,data:s.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Logout all failed"}}},async getCurrentUser(){try{const s=await o.get("/current-user");return{success:!0,data:s.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Failed to get user data",status:s.response?.status}}},async getRoleBasedRedirect(){try{const s=await o.get("/role-redirect");return{success:!0,data:s.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Failed to get redirect URL",status:s.response?.status}}},async getActiveSessions(){try{const s=await o.get("/active-sessions");return{success:!0,data:s.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Failed to get active sessions"}}},async revokeSession(s){try{const e=await o.post("/revoke-session",{token_id:s});return{success:!0,data:e.data}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to revoke session"}}},async changePassword(s){try{const e=await o.post("/change-password",{current_password:s.current,password:s.new,password_confirmation:s.confirm});return{success:!0,data:e.data,message:e.data?.message||"Password changed successfully."}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to change password.",errors:e.response?.data?.errors||{}}}},async requestPasswordResetByPhone(s){try{const e=await o.post("/password-reset/request-by-phone",{phone:s});return{success:!0,data:e.data,message:e.data?.message}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to send OTP.",errors:e.response?.data?.errors||{}}}},async verifyPasswordResetOtp(s){try{const e=await o.post("/password-reset/verify-otp",{phone:s.phone,otp:s.otp});return{success:!0,data:e.data,message:e.data?.message}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to verify OTP.",errors:e.response?.data?.errors||{}}}},async resetPasswordWithOtp(s){try{const e=await o.post("/password-reset/reset-with-otp",{phone:s.phone,otp:s.otp,password:s.password,password_confirmation:s.password_confirmation});return{success:!0,data:e.data?.data,message:e.data?.message}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to reset password.",errors:e.response?.data?.errors||{}}}}};e["default"]=c}}]);
//# sourceMappingURL=981.138c17ed.js.map