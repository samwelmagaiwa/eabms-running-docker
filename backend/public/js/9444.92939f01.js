"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[9444],{60:function(e,s,t){var a=t(4373);const l="/api",r=a.A.create({baseURL:l,timeout:parseInt("30000")||1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}});r.interceptors.request.use(e=>{const s=localStorage.getItem("auth_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e,e=>(401===e.response?.status&&(localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("session_data"),window.location.href="/login"),Promise.reject(e)));const o={async getAllRoles(){try{const e=await r.get("/roles");return{success:!0,data:e.data.data}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to fetch roles",errors:e.response?.data?.errors||{}}}},async getUsersWithRoles(e={}){try{const s=await r.get("/user-roles",{params:e});return{success:!0,data:s.data.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Failed to fetch users",errors:s.response?.data?.errors||{}}}},async assignRolesToUser(e,s){try{const t=await r.post(`/user-roles/${e}/assign`,{role_ids:s});return{success:!0,data:t.data.data,message:t.data.message}}catch(t){return{success:!1,message:t.response?.data?.message||"Failed to assign roles",errors:t.response?.data?.errors||{}}}},async removeRoleFromUser(e,s){try{const t=await r.delete(`/user-roles/${e}/roles/${s}`);return{success:!0,message:t.data.message}}catch(t){return{success:!1,message:t.response?.data?.message||"Failed to remove role",errors:t.response?.data?.errors||{}}}},async getUserRoleHistory(e){try{const s=await r.get(`/user-roles/${e}/history`);return{success:!0,data:s.data.data}}catch(s){return{success:!1,message:s.response?.data?.message||"Failed to fetch role history",errors:s.response?.data?.errors||{}}}},async getRoleStatistics(){try{const e=await r.get("/user-roles/statistics");return{success:!0,data:e.data.data}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to fetch statistics",errors:e.response?.data?.errors||{}}}},async getAvailablePermissions(){try{const e=await r.get("/roles/permissions");return{success:!0,data:e.data.data}}catch(e){return{success:!1,message:e.response?.data?.message||"Failed to fetch permissions",errors:e.response?.data?.errors||{}}}}};s.A=o},6100:function(e,s,t){t.r(s),t.d(s,{default:function(){return ze}});var a=t(5796);const l={class:"flex flex-col h-screen"},r={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-6 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 overflow-y-auto relative"},i={class:"absolute inset-0 overflow-hidden"},d={class:"absolute inset-0 opacity-5"},n={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},c={class:"max-w-10xl mx-auto relative z-10"},u={class:"medical-glass-card rounded-b-3xl overflow-hidden"},g={class:"p-6 space-y-6"},p={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},x={class:"medical-card bg-gradient-to-r from-blue-600/25 to-cyan-600/25 border-2 border-blue-400/40 p-4 rounded-xl backdrop-blur-sm"},m={class:"flex items-center space-x-3"},f={class:"text-2xl font-bold text-white"},v={class:"medical-card bg-gradient-to-r from-green-600/25 to-emerald-600/25 border-2 border-green-400/40 p-4 rounded-xl backdrop-blur-sm"},b={class:"flex items-center space-x-3"},k={class:"text-2xl font-bold text-white"},h={class:"medical-card bg-gradient-to-r from-purple-600/25 to-indigo-600/25 border-2 border-purple-400/40 p-4 rounded-xl backdrop-blur-sm"},y={class:"flex items-center space-x-3"},L={class:"text-2xl font-bold text-white"},w={class:"medical-card bg-gradient-to-r from-orange-600/25 to-red-600/25 border-2 border-orange-400/40 p-4 rounded-xl backdrop-blur-sm"},R={class:"flex items-center space-x-3"},C={class:"text-2xl font-bold text-white"},_={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},E={class:"medical-card bg-gradient-to-r from-teal-600/25 to-blue-600/25 border-2 border-teal-400/40 p-6 rounded-2xl backdrop-blur-sm"},U={class:"mb-4"},X={class:"relative"},A={class:"space-y-2 max-h-96 overflow-y-auto"},F={key:0,class:"text-center py-4"},S={key:1,class:"text-center py-4"},I=["onClick"],K={class:"flex items-center space-x-3"},j={class:"w-10 h-10 bg-gradient-to-br from-teal-500 to-blue-600 rounded-full flex items-center justify-center"},H={class:"text-white font-bold text-sm"},T={class:"flex-1"},Q={class:"font-bold text-white"},W={class:"text-teal-100 text-sm"},M={key:0,class:"flex flex-wrap gap-1 mt-1"},D={key:0,class:"px-2 py-1 bg-gray-500/30 text-gray-100 rounded text-xs"},N={key:1,class:"text-xs text-teal-200 mt-1"},$={class:"medical-card bg-gradient-to-r from-purple-600/25 to-indigo-600/25 border-2 border-purple-400/40 p-6 rounded-2xl backdrop-blur-sm"},q={key:0,class:"text-center py-8"},z={key:1,class:"space-y-6"},P={class:"bg-white/10 rounded-lg p-4 border border-purple-300/30"},V={class:"flex items-center space-x-3"},B={class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center"},J={class:"text-white font-bold"},O={class:"font-bold text-white"},G={class:"text-purple-100 text-sm"},Y={class:"space-y-4"},Z={class:"relative"},ee=["value"],se={class:"flex items-center justify-between mb-2"},te={key:0,class:"bg-white/10 border-2 border-purple-300/30 rounded-xl p-4 max-h-64 overflow-y-auto"},ae={class:"space-y-2"},le=["value"],re={class:"flex-1"},oe={class:"flex items-center space-x-2"},ie={key:0,class:"text-xs text-purple-200 mt-1"},de={key:0},ne={class:"block text-base font-bold text-purple-100 mb-2"},ce={class:"flex flex-wrap gap-2"},ue=["onClick"],ge={key:1},pe={class:"flex flex-wrap gap-2"},xe=["onClick"],me={class:"flex space-x-3 pt-4"},fe=["disabled"],ve={key:0,class:"fas fa-spinner fa-spin"},be={key:1,class:"fas fa-save"},ke=["disabled"],he={key:0,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 backdrop-blur-sm"},ye={class:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Le={class:"bg-gradient-to-r from-blue-500 to-blue-600 p-6 text-center"},we={class:"text-xl font-bold text-white mb-2"},Re={class:"p-6"},Ce={key:0,class:"text-center py-8"},_e={key:1,class:"space-y-4"},Ee={class:"flex items-start space-x-4"},Ue={class:"flex-1"},Xe={class:"flex items-center justify-between mb-2"},Ae={class:"font-semibold text-gray-800"},Fe={class:"text-sm text-gray-500"},Se={class:"mb-2"},Ie={key:0,class:"text-sm text-gray-600"},Ke={key:2,class:"text-center py-8"},je={class:"flex justify-end p-6 border-t border-gray-200"},He={class:"flex items-center"},Te={class:"font-medium"};function Qe(e,s,t,Qe,We,Me){const De=(0,a.g2)("AppHeader"),Ne=(0,a.g2)("ModernSidebar");return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(De),(0,a.Lk)("div",r,[(0,a.bF)(Ne),(0,a.Lk)("main",o,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("div",n,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",c,[s[39]||(s[39]=(0,a.Fv)('<div class="medical-glass-card rounded-t-3xl p-6 mb-0 border-b border-blue-300/30" data-v-3dfe87ee><div class="text-center" data-v-3dfe87ee><h1 class="text-4xl font-bold text-white mb-2 tracking-wide drop-shadow-lg" data-v-3dfe87ee><i class="fas fa-users-cog mr-3 text-blue-300" data-v-3dfe87ee></i> Role Assignment System </h1><p class="text-blue-100 text-lg" data-v-3dfe87ee>Assign roles to users from database</p></div></div>',1)),(0,a.Lk)("div",u,[(0,a.Lk)("div",g,[(0,a.Lk)("div",p,[(0,a.Lk)("div",x,[(0,a.Lk)("div",m,[s[11]||(s[11]=(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-users text-white text-lg"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("div",f,(0,a.v_)(Qe.statistics.total_users||0),1),s[10]||(s[10]=(0,a.Lk)("div",{class:"text-sm text-blue-100"},"Total Users",-1))])])]),(0,a.Lk)("div",v,[(0,a.Lk)("div",b,[s[13]||(s[13]=(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-user-check text-white text-lg"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("div",k,(0,a.v_)(Qe.statistics.users_with_roles||0),1),s[12]||(s[12]=(0,a.Lk)("div",{class:"text-sm text-green-100"},"With Roles",-1))])])]),(0,a.Lk)("div",h,[(0,a.Lk)("div",y,[s[15]||(s[15]=(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-shield-alt text-white text-lg"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("div",L,(0,a.v_)(Qe.availableRoles.length||0),1),s[14]||(s[14]=(0,a.Lk)("div",{class:"text-sm text-purple-100"},"Available Roles",-1))])])]),(0,a.Lk)("div",w,[(0,a.Lk)("div",R,[s[17]||(s[17]=(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-history text-white text-lg"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("div",C,(0,a.v_)(Qe.statistics.recent_role_changes||0),1),s[16]||(s[16]=(0,a.Lk)("div",{class:"text-sm text-orange-100"},"Recent Changes",-1))])])])]),(0,a.Lk)("div",_,[(0,a.Lk)("div",E,[s[22]||(s[22]=(0,a.Lk)("div",{class:"flex items-center space-x-3 mb-6"},[(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl flex items-center justify-center shadow-lg"},[(0,a.Lk)("i",{class:"fas fa-user-friends text-white text-lg"})]),(0,a.Lk)("h3",{class:"text-xl font-bold text-white"},"Select User")],-1)),(0,a.Lk)("div",U,[s[19]||(s[19]=(0,a.Lk)("label",{class:"block text-base font-bold text-teal-100 mb-2"},"Search Users",-1)),(0,a.Lk)("div",X,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>Qe.userSearchQuery=e),type:"text",class:"w-full px-4 py-3 bg-white/15 border-2 border-teal-300/30 rounded-xl focus:border-cyan-400 focus:outline-none text-white placeholder-teal-200/60 backdrop-blur-sm",placeholder:"Search by name or email...",onInput:s[1]||(s[1]=(...e)=>Qe.searchUsers&&Qe.searchUsers(...e))},null,544),[[a.Jo,Qe.userSearchQuery]]),s[18]||(s[18]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center pr-3"},[(0,a.Lk)("i",{class:"fas fa-search text-teal-300"})],-1))])]),(0,a.Lk)("div",A,[Qe.loadingUsers?((0,a.uX)(),(0,a.CE)("div",F,[...s[20]||(s[20]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-teal-300 text-xl"},null,-1),(0,a.Lk)("p",{class:"text-teal-100 mt-2"},"Loading users...",-1)])])):0===Qe.filteredUsers.length?((0,a.uX)(),(0,a.CE)("div",S,[...s[21]||(s[21]=[(0,a.Lk)("i",{class:"fas fa-users text-teal-300 text-2xl opacity-50"},null,-1),(0,a.Lk)("p",{class:"text-teal-100 mt-2"},"No users found",-1)])])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.filteredUsers,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,onClick:s=>Qe.selectUser(e),class:(0,a.C4)(["p-4 rounded-lg cursor-pointer transition-all duration-200 border",Qe.selectedUser?.id===e.id?"bg-white/25 border-cyan-400/60 shadow-lg":"bg-white/10 border-teal-300/30 hover:bg-white/20 hover:border-cyan-400/40"])},[(0,a.Lk)("div",K,[(0,a.Lk)("div",j,[(0,a.Lk)("span",H,(0,a.v_)(Qe.getInitials(e.name)),1)]),(0,a.Lk)("div",T,[(0,a.Lk)("h4",Q,(0,a.v_)(e.name),1),(0,a.Lk)("p",W,(0,a.v_)(e.email),1),e.roles&&e.roles.length>0?((0,a.uX)(),(0,a.CE)("div",M,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.roles.slice(0,2),e=>((0,a.uX)(),(0,a.CE)("span",{key:e.id,class:"px-2 py-1 bg-teal-500/30 text-teal-100 rounded text-xs"},(0,a.v_)(e.name),1))),128)),e.roles.length>2?((0,a.uX)(),(0,a.CE)("span",D," +"+(0,a.v_)(e.roles.length-2)+" more ",1)):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",N,"No roles assigned"))])])],10,I))),128))])]),(0,a.Lk)("div",$,[s[34]||(s[34]=(0,a.Lk)("div",{class:"flex items-center space-x-3 mb-6"},[(0,a.Lk)("div",{class:"w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg"},[(0,a.Lk)("i",{class:"fas fa-user-tag text-white text-lg"})]),(0,a.Lk)("h3",{class:"text-xl font-bold text-white"},"Assign Roles")],-1)),Qe.selectedUser?((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("div",P,[(0,a.Lk)("div",V,[(0,a.Lk)("div",B,[(0,a.Lk)("span",J,(0,a.v_)(Qe.getInitials(Qe.selectedUser.name)),1)]),(0,a.Lk)("div",null,[(0,a.Lk)("h4",O,(0,a.v_)(Qe.selectedUser.name),1),(0,a.Lk)("p",G,(0,a.v_)(Qe.selectedUser.email),1)])])]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",null,[s[26]||(s[26]=(0,a.Lk)("label",{class:"block text-base font-bold text-purple-100 mb-2"},[(0,a.Lk)("i",{class:"fas fa-list mr-2"}),(0,a.eW)("Select Roles ")],-1)),(0,a.Lk)("div",Z,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>Qe.selectedRoleToAdd=e),onChange:s[3]||(s[3]=(...e)=>Qe.addRoleToSelection&&Qe.addRoleToSelection(...e)),class:"w-full px-4 py-3 bg-white/15 border-2 border-purple-300/30 rounded-xl focus:border-purple-400 focus:outline-none text-white backdrop-blur-sm appearance-none cursor-pointer"},[s[24]||(s[24]=(0,a.Lk)("option",{value:"",class:"bg-gray-800 text-white"}," Choose a role to add... ",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.availableRolesForDropdown,e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id,class:"bg-gray-800 text-white"},(0,a.v_)(e.name)+" "+(0,a.v_)(e.description?"- "+e.description:""),9,ee))),128))],544),[[a.u1,Qe.selectedRoleToAdd]]),s[25]||(s[25]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-purple-300"})],-1))]),s[27]||(s[27]=(0,a.Lk)("p",{class:"text-xs text-purple-200 mt-1"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-1"}),(0,a.eW)(" Select roles from the dropdown to assign to the user ")],-1))]),(0,a.Lk)("div",null,[(0,a.Lk)("div",se,[s[28]||(s[28]=(0,a.Lk)("label",{class:"text-sm font-bold text-purple-100"},[(0,a.Lk)("i",{class:"fas fa-check-square mr-2"}),(0,a.eW)("Or select from list ")],-1)),(0,a.Lk)("button",{onClick:s[4]||(s[4]=e=>Qe.showRolesList=!Qe.showRolesList),class:"text-sm text-purple-300 hover:text-purple-100 font-medium flex items-center space-x-1"},[(0,a.Lk)("span",null,(0,a.v_)(Qe.showRolesList?"Hide":"Show")+" roles list",1),(0,a.Lk)("i",{class:(0,a.C4)(Qe.showRolesList?"fas fa-chevron-up":"fas fa-chevron-down")},null,2)])]),Qe.showRolesList?((0,a.uX)(),(0,a.CE)("div",te,[(0,a.Lk)("div",ae,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.availableRoles,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"flex items-center space-x-3 p-2 bg-white/10 rounded-lg hover:bg-white/20 transition-colors duration-200"},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>Qe.selectedRoleIds=e),value:e.id,type:"checkbox",class:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"},null,8,le),[[a.lH,Qe.selectedRoleIds]]),(0,a.Lk)("div",re,[(0,a.Lk)("div",oe,[(0,a.Lk)("span",{class:(0,a.C4)(["px-2 py-1 rounded text-xs",Qe.getRoleColorClasses(e.name)])},(0,a.v_)(e.name),3)]),e.description?((0,a.uX)(),(0,a.CE)("p",ie,(0,a.v_)(e.description),1)):(0,a.Q3)("",!0)])]))),128))])])):(0,a.Q3)("",!0)]),Qe.selectedRoleIds.length>0?((0,a.uX)(),(0,a.CE)("div",de,[(0,a.Lk)("label",ne,[s[29]||(s[29]=(0,a.Lk)("i",{class:"fas fa-check mr-2"},null,-1)),(0,a.eW)("Selected Roles ("+(0,a.v_)(Qe.selectedRoleIds.length)+"): ",1)]),(0,a.Lk)("div",ce,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedRoleIds,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:(0,a.C4)(["px-3 py-2 rounded-lg text-sm flex items-center space-x-2",Qe.getRoleColorClasses(Qe.getRoleName(e))])},[(0,a.Lk)("span",null,(0,a.v_)(Qe.getRoleName(e)),1),(0,a.Lk)("button",{onClick:s=>Qe.removeRoleFromSelection(e),class:"text-current hover:text-red-300 transition-colors duration-200"},[...s[30]||(s[30]=[(0,a.Lk)("i",{class:"fas fa-times text-xs"},null,-1)])],8,ue)],2))),128))])])):(0,a.Q3)("",!0),Qe.selectedUser.roles&&Qe.selectedUser.roles.length>0?((0,a.uX)(),(0,a.CE)("div",ge,[s[32]||(s[32]=(0,a.Lk)("label",{class:"block text-base font-bold text-purple-100 mb-2"},[(0,a.Lk)("i",{class:"fas fa-user-shield mr-2"}),(0,a.eW)("Current Roles: ")],-1)),(0,a.Lk)("div",pe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedUser.roles,e=>((0,a.uX)(),(0,a.CE)("span",{key:e.id,class:(0,a.C4)(["px-3 py-2 rounded-lg text-sm flex items-center space-x-2",Qe.getRoleColorClasses(e.name)])},[(0,a.Lk)("span",null,(0,a.v_)(e.name),1),(0,a.Lk)("button",{onClick:s=>Qe.quickRemoveRole(e.id),class:"text-current hover:text-red-300 transition-colors duration-200",title:"Remove this role"},[...s[31]||(s[31]=[(0,a.Lk)("i",{class:"fas fa-times text-xs"},null,-1)])],8,xe)],2))),128))])])):(0,a.Q3)("",!0),(0,a.Lk)("div",me,[(0,a.Lk)("button",{onClick:s[6]||(s[6]=(...e)=>Qe.assignRoles&&Qe.assignRoles(...e)),disabled:Qe.assigningRoles||0===Qe.selectedRoleIds.length,class:"flex-1 bg-gradient-to-r from-purple-600 to-purple-700 text-white py-3 px-6 rounded-xl font-semibold hover:from-purple-700 hover:to-purple-800 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[Qe.assigningRoles?((0,a.uX)(),(0,a.CE)("i",ve)):((0,a.uX)(),(0,a.CE)("i",be)),(0,a.Lk)("span",null,(0,a.v_)(Qe.assigningRoles?"Updating...":"Update Roles"),1)],8,fe),(0,a.Lk)("button",{onClick:s[7]||(s[7]=(...e)=>Qe.viewRoleHistory&&Qe.viewRoleHistory(...e)),disabled:!Qe.selectedUser,class:"bg-gradient-to-r from-gray-600 to-gray-700 text-white py-3 px-6 rounded-xl font-semibold hover:from-gray-700 hover:to-gray-800 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"},[...s[33]||(s[33]=[(0,a.Lk)("i",{class:"fas fa-history"},null,-1),(0,a.Lk)("span",null,"History",-1)])],8,ke)])])])):((0,a.uX)(),(0,a.CE)("div",q,[...s[23]||(s[23]=[(0,a.Lk)("i",{class:"fas fa-user-plus text-purple-300 text-3xl opacity-50"},null,-1),(0,a.Lk)("p",{class:"text-purple-100 mt-2"},"Select a user to assign roles",-1)])]))])]),Qe.showRoleHistory?((0,a.uX)(),(0,a.CE)("div",he,[(0,a.Lk)("div",ye,[(0,a.Lk)("div",Le,[(0,a.Lk)("h3",we," Role History for "+(0,a.v_)(Qe.selectedUser?.name),1)]),(0,a.Lk)("div",Re,[Qe.loadingHistory?((0,a.uX)(),(0,a.CE)("div",Ce,[...s[35]||(s[35]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-blue-500 text-2xl"},null,-1),(0,a.Lk)("p",{class:"text-gray-600 mt-2"},"Loading role history...",-1)])])):Qe.roleHistory.length>0?((0,a.uX)(),(0,a.CE)("div",_e,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.roleHistory,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"bg-gray-50 rounded-xl p-4 border border-gray-200"},[(0,a.Lk)("div",Ee,[(0,a.Lk)("div",{class:(0,a.C4)(["w-10 h-10 rounded-full flex items-center justify-center","assigned"===e.action?"bg-green-500":"bg-red-500"])},[(0,a.Lk)("i",{class:(0,a.C4)(["text-white text-sm","assigned"===e.action?"fas fa-plus":"fas fa-minus"])},null,2)],2),(0,a.Lk)("div",Ue,[(0,a.Lk)("div",Xe,[(0,a.Lk)("h4",Ae," Role "+(0,a.v_)("assigned"===e.action?"Assigned":"Removed"),1),(0,a.Lk)("span",Fe,(0,a.v_)(Qe.formatDateTime(e.changed_at)),1)]),(0,a.Lk)("div",Se,[(0,a.Lk)("span",{class:(0,a.C4)(["px-3 py-1 rounded-full text-sm",Qe.getRoleColorClasses(e.role?.name)])},(0,a.v_)(e.role?.name),3)]),e.changed_by?((0,a.uX)(),(0,a.CE)("div",Ie,[s[36]||(s[36]=(0,a.Lk)("i",{class:"fas fa-user text-gray-400 mr-1"},null,-1)),(0,a.eW)(" Changed by: "+(0,a.v_)(e.changed_by?.name),1)])):(0,a.Q3)("",!0)])])]))),128))])):((0,a.uX)(),(0,a.CE)("div",Ke,[...s[37]||(s[37]=[(0,a.Lk)("i",{class:"fas fa-history text-gray-400 text-3xl"},null,-1),(0,a.Lk)("h4",{class:"text-lg font-semibold text-gray-800 mb-2 mt-4"},"No role history",-1),(0,a.Lk)("p",{class:"text-gray-600"},"This user has no role change history.",-1)])]))]),(0,a.Lk)("div",je,[(0,a.Lk)("button",{onClick:s[8]||(s[8]=e=>Qe.showRoleHistory=!1),class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl font-medium hover:bg-gray-200 transition-colors duration-200"}," Close ")])])])):(0,a.Q3)("",!0),Qe.showMessage?((0,a.uX)(),(0,a.CE)("div",{key:1,class:(0,a.C4)(["fixed top-4 right-4 px-6 py-4 rounded-xl shadow-2xl z-50 max-w-md transform transition-all duration-300","success"===Qe.messageType?"bg-green-500 text-white":"bg-red-500 text-white"])},[(0,a.Lk)("div",He,[(0,a.Lk)("i",{class:(0,a.C4)(["mr-3","success"===Qe.messageType?"fas fa-check-circle":"fas fa-exclamation-circle"])},null,2),(0,a.Lk)("p",Te,(0,a.v_)(Qe.message),1),(0,a.Lk)("button",{onClick:s[9]||(s[9]=e=>Qe.showMessage=!1),class:"ml-3 text-white/80 hover:text-white transition-colors duration-200"},[...s[38]||(s[38]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])],2)):(0,a.Q3)("",!0)])])])])])])}t(4114),t(8111),t(2489),t(116),t(1701);var We=t(6933),Me=t(8966),De=t(60),Ne={name:"CleanRoleAssignment",components:{AppHeader:We.A,ModernSidebar:Me.A},setup(){const e=(0,a.KR)([]),s=(0,a.KR)([]),t=(0,a.KR)(null),l=(0,a.KR)([]),r=(0,a.KR)(""),o=(0,a.KR)(""),i=(0,a.KR)(!1),d=(0,a.KR)(!1),n=(0,a.KR)([]),c=(0,a.KR)({}),u=(0,a.KR)(!1),g=(0,a.KR)(!1),p=(0,a.KR)(!1),x=(0,a.KR)(!1),m=(0,a.KR)(!1),f=(0,a.KR)(""),v=(0,a.KR)("success"),b=(0,a.EW)(()=>{if(!o.value)return s.value;const e=o.value.toLowerCase();return s.value.filter(s=>s.name.toLowerCase().includes(e)||s.email.toLowerCase().includes(e))}),k=(0,a.EW)(()=>e.value.filter(e=>!l.value.includes(e.id))),h=async()=>{u.value=!0;try{const s=await De.A.getAllRoles();s.success?e.value=s.data.data||[]:j(s.message)}catch(s){console.error("Error loading roles:",s),j("Failed to load roles")}finally{u.value=!1}},y=async()=>{g.value=!0;try{const e=await De.A.getUsersWithRoles();e.success?s.value=e.data.data||[]:j(e.message)}catch(e){console.error("Error loading users:",e),j("Failed to load users")}finally{g.value=!1}},L=async()=>{try{const e=await De.A.getRoleStatistics();e.success&&(c.value=e.data)}catch(e){console.error("Error loading statistics:",e)}},w=e=>{t.value=e,l.value=e.roles?e.roles.map(e=>e.id):[]},R=()=>{r.value&&!l.value.includes(r.value)&&(l.value.push(r.value),r.value="")},C=e=>{l.value=l.value.filter(s=>s!==e)},_=async()=>{if(t.value&&0!==l.value.length){p.value=!0;try{const e=await De.A.assignRolesToUser(t.value.id,l.value);if(e.success){K(e.message||"Roles updated successfully"),await y(),await L();const a=s.value.find(e=>e.id===t.value.id);a&&(t.value=a,l.value=a.roles?a.roles.map(e=>e.id):[])}else j(e.message)}catch(e){console.error("Error assigning roles:",e),j("Failed to assign roles")}finally{p.value=!1}}},E=async e=>{if(t.value&&confirm("Are you sure you want to remove this role?"))try{const a=await De.A.removeRoleFromUser(t.value.id,e);if(a.success){K(a.message||"Role removed successfully"),await y(),await L();const e=s.value.find(e=>e.id===t.value.id);e&&(t.value=e,l.value=e.roles?e.roles.map(e=>e.id):[])}else j(a.message)}catch(a){console.error("Error removing role:",a),j("Failed to remove role")}},U=async()=>{if(t.value){d.value=!0,x.value=!0;try{const e=await De.A.getUserRoleHistory(t.value.id);e.success?n.value=e.data.data||[]:(j(e.message),n.value=[])}catch(e){console.error("Error loading role history:",e),j("Failed to load role history"),n.value=[]}finally{x.value=!1}}},X=()=>{},A=e=>e.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().substring(0,2),F=s=>{const t=e.value.find(e=>e.id===s);return t?t.name:"Unknown"},S=e=>{const s={admin:"bg-red-500/30 text-red-100 border border-red-400/50",head_of_department:"bg-blue-500/30 text-blue-100 border border-blue-400/50",ict_director:"bg-teal-500/30 text-teal-100 border border-teal-400/50",ict_officer:"bg-green-500/30 text-green-100 border border-green-400/50",divisional_director:"bg-orange-500/30 text-orange-100 border border-orange-400/50",staff:"bg-gray-500/30 text-gray-100 border border-gray-400/50"};return s[e]||"bg-blue-500/30 text-blue-100 border border-blue-400/50"},I=e=>e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",K=e=>{f.value=e,v.value="success",m.value=!0,setTimeout(()=>{m.value=!1},5e3)},j=e=>{f.value=e,v.value="error",m.value=!0,setTimeout(()=>{m.value=!1},5e3)};return(0,a.sV)(async()=>{await Promise.all([h(),y(),L()])}),{availableRoles:e,allUsers:s,selectedUser:t,selectedRoleIds:l,selectedRoleToAdd:r,userSearchQuery:o,showRolesList:i,showRoleHistory:d,roleHistory:n,statistics:c,loadingRoles:u,loadingUsers:g,assigningRoles:p,loadingHistory:x,showMessage:m,message:f,messageType:v,filteredUsers:b,availableRolesForDropdown:k,selectUser:w,addRoleToSelection:R,removeRoleFromSelection:C,assignRoles:_,quickRemoveRole:E,viewRoleHistory:U,searchUsers:X,getInitials:A,getRoleName:F,getRoleColorClasses:S,formatDateTime:I,showSuccessMessage:K,showErrorMessage:j}}},$e=t(1241);const qe=(0,$e.A)(Ne,[["render",Qe],["__scopeId","data-v-3dfe87ee"]]);var ze=qe}}]);
//# sourceMappingURL=9444.92939f01.js.map