{"version":3,"file":"js/4466.65a982fd.js","mappings":"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","sources":["webpack://frontend/./src/services/deviceBorrowingService.js"],"sourcesContent":["import apiClient from '../utils/apiClient'\nimport { devLog } from '../utils/devLogger'\n\n/**\n * Device Borrowing Request Service\n *\n * Handles ICT approval of device borrowing requests from booking_service table\n */\n\nexport const deviceBorrowingService = {\n  /**\n   * Get all device borrowing requests for ICT approval (pending, approved, rejected)\n   * @param {Object} params - Query parameters (search, device_type, department, ict_status, etc.)\n   * @returns {Promise<Object>} - API response with paginated requests\n   */\n  async getAllRequests(params = {}) {\n    try {\n      // Try ICT approval endpoint first (more reliable)\n      let response\n      try {\n        response = await apiClient.get('/ict-approval/device-requests', {\n          params: {\n            ...params,\n            per_page: params.per_page || 50\n          }\n        })\n        devLog.debug('Successfully fetched from ICT approval endpoint')\n      } catch (ictError) {\n        devLog.debug(\n          'ICT approval endpoint failed, trying booking service endpoint:',\n          ictError.response?.status,\n          ictError.response?.data?.message\n        )\n\n        // Fallback to booking service endpoint\n        response = await apiClient.get('/booking-service/ict-approval-requests', {\n          params: {\n            ...params,\n            per_page: params.per_page || 50\n          }\n        })\n        devLog.debug('Successfully fetched from booking service endpoint')\n      }\n\n      const requests = response.data.data?.data || response.data.data || []\n      const transformedRequests = Array.isArray(requests)\n        ? requests.map((request) => this.transformRequest(request))\n        : []\n\n      return {\n        success: true,\n        data: {\n          data: transformedRequests,\n          current_page: response.data.data?.current_page || 1,\n          last_page: response.data.data?.last_page || 1,\n          per_page: response.data.data?.per_page || 50,\n          total: response.data.data?.total || transformedRequests.length\n        }\n      }\n    } catch (error) {\n      devLog.error('Failed to fetch device borrowing requests:', error)\n      return {\n        success: false,\n        message: error.response?.data?.message || 'Failed to fetch requests',\n        error: error.message,\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Get device borrowing requests pending ICT approval (backward compatibility)\n   * @param {Object} params - Query parameters (search, device_type, department, etc.)\n   * @returns {Promise<Object>} - API response with paginated pending requests\n   */\n  async getPendingRequests(params = {}) {\n    return this.getAllRequests({\n      ...params,\n      ict_status: 'pending'\n    })\n  },\n\n  /**\n   * Get detailed information for a specific device borrowing request\n   * @param {number} requestId - Request ID\n   * @returns {Promise<Object>} - API response with request details\n   */\n  async getRequestDetails(requestId) {\n    try {\n      devLog.debug('üîç Fetching request details for ID:', requestId)\n\n      // Try ICT approval endpoint first (for ICT officers)\n      let response\n      let sourceEndpoint = ''\n      try {\n        response = await apiClient.get(`/ict-approval/device-requests/${requestId}`)\n        sourceEndpoint = 'ict-approval/device-requests'\n        devLog.debug('‚úÖ Successfully fetched from ICT approval endpoint')\n      } catch (ictError) {\n        devLog.debug(\n          '‚ö†Ô∏è ICT approval endpoint failed, trying booking service endpoint:',\n          ictError.response?.status\n        )\n\n        // Fallback to booking service endpoint\n        response = await apiClient.get(`/booking-service/bookings/${requestId}`)\n        sourceEndpoint = 'booking-service/bookings'\n        devLog.debug('‚úÖ Successfully fetched from booking service endpoint')\n      }\n\n      const request = response.data.data || response.data\n      // Add source endpoint information for better type detection\n      request._endpoint = sourceEndpoint\n      request._source = sourceEndpoint.includes('booking') ? 'booking_service' : 'ict_approval'\n\n      devLog.debug('üìÑ Raw request data:', request)\n      devLog.debug('üîç Source endpoint:', sourceEndpoint)\n      devLog.debug('üîç Raw reason field:', request.reason)\n      devLog.debug('üîç Raw purpose field:', request.purpose)\n      devLog.debug('üîç Raw phone fields:', {\n        phone_number: request.phone_number,\n        borrower_phone: request.borrower_phone,\n        user_phone: request.user?.phone,\n        phoneNumber: request.phoneNumber\n      })\n\n      // Check request type before transformation\n      const isBooking = this.isBookingRequest(request)\n      devLog.debug('üîç Request type analysis:', {\n        requestId: request.id,\n        isBookingRequest: isBooking,\n        detectedType: isBooking ? 'booking' : 'access'\n      })\n\n      if (!request) {\n        throw new Error('No request data received from API')\n      }\n\n      const transformedRequest = this.transformRequest(request)\n      devLog.debug('üîÑ Transformed request data:', transformedRequest)\n      devLog.debug('üîç Transformed reason field:', transformedRequest.reason)\n      devLog.debug('üîç Transformed purpose field:', transformedRequest.purpose)\n      devLog.debug('üîç Transformed phone field:', transformedRequest.borrower_phone)\n      devLog.debug('üîç Final request type:', transformedRequest.request_type)\n\n      return {\n        success: true,\n        data: transformedRequest\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to fetch request details:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message:\n          error.response?.data?.message || error.message || 'Failed to fetch request details',\n        error: error.message,\n        status: error.response?.status,\n        details: {\n          requestId,\n          endpoint: error.config?.url,\n          method: error.config?.method\n        }\n      }\n    }\n  },\n\n  /**\n   * Approve a device borrowing request (ICT Officer)\n   * @param {number} requestId - Request ID\n   * @param {string} notes - ICT officer notes (optional)\n   * @returns {Promise<Object>} - API response\n   */\n  async approveRequest(requestId, notes = '') {\n    try {\n      devLog.debug('‚úÖ Approving request ID:', requestId, 'with notes:', notes)\n\n      // Prefer booking-service endpoint (implemented), then fallback to ICT endpoint\n      let response\n      try {\n        response = await apiClient.post(`/booking-service/bookings/${requestId}/ict-approve`, {\n          ict_notes: notes\n        })\n        devLog.debug('‚úÖ Successfully approved via booking service endpoint')\n      } catch (bsError) {\n        const status = bsError.response?.status\n        devLog.debug('‚ö†Ô∏è Booking-service endpoint failed:', status, bsError.response?.data?.message)\n        // Fallback to ICT approval endpoint only for missing/not-implemented routes\n        const shouldFallback = !status || [404, 405, 501].includes(status)\n        if (!shouldFallback) {\n          throw bsError\n        }\n        response = await apiClient.post(`/ict-approval/device-requests/${requestId}/approve`, {\n          ict_notes: notes\n        })\n        devLog.debug('‚úÖ Successfully approved via ICT approval endpoint (fallback)')\n      }\n\n      return {\n        success: true,\n        data: this.transformRequest(response.data.data || response.data),\n        message: 'Device borrowing request approved successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to approve request:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to approve request',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Reject a device borrowing request (ICT Officer)\n   * @param {number} requestId - Request ID\n   * @param {string} notes - ICT officer rejection reason (required)\n   * @returns {Promise<Object>} - API response\n   */\n  async rejectRequest(requestId, notes) {\n    try {\n      if (!notes || notes.trim() === '') {\n        throw new Error('Rejection reason is required')\n      }\n\n      devLog.debug('‚ùå Rejecting request ID:', requestId, 'with notes:', notes)\n\n      // Try ICT approval endpoint first\n      let response\n      try {\n        response = await apiClient.post(`/ict-approval/device-requests/${requestId}/reject`, {\n          ict_notes: notes\n        })\n        devLog.debug('‚úÖ Successfully rejected via ICT approval endpoint')\n      } catch (ictError) {\n        devLog.debug(\n          '‚ö†Ô∏è ICT approval endpoint failed, trying booking service endpoint:',\n          ictError.response?.status\n        )\n\n        // Fallback to booking service endpoint\n        response = await apiClient.post(`/booking-service/bookings/${requestId}/ict-reject`, {\n          ict_notes: notes\n        })\n        devLog.debug('‚úÖ Successfully rejected via booking service endpoint')\n      }\n\n      return {\n        success: true,\n        data: this.transformRequest(response.data.data || response.data),\n        message: 'Device borrowing request rejected successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to reject request:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to reject request',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Delete a device borrowing request (ICT Officer)\n   * @param {number} requestId - Request ID\n   * @returns {Promise<Object>} - API response\n   */\n  async deleteRequest(requestId) {\n    try {\n      devLog.debug('üóëÔ∏è Deleting request ID:', requestId)\n\n      // Try ICT approval endpoint first\n      try {\n        await apiClient.delete(`/ict-approval/device-requests/${requestId}`)\n        devLog.debug('‚úÖ Successfully deleted via ICT approval endpoint')\n      } catch (ictError) {\n        devLog.debug(\n          '‚ö†Ô∏è ICT approval endpoint failed, trying booking service endpoint:',\n          ictError.response?.status\n        )\n\n        // Fallback to booking service endpoint\n        await apiClient.delete(`/booking-service/bookings/${requestId}`)\n        devLog.debug('‚úÖ Successfully deleted via booking service endpoint')\n      }\n\n      return {\n        success: true,\n        message: 'Device borrowing request deleted successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to delete request:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to delete request',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Bulk delete device borrowing requests (ICT Officer)\n   * @param {Array<number>} requestIds - Array of Request IDs\n   * @returns {Promise<Object>} - API response\n   */\n  async bulkDeleteRequests(requestIds) {\n    try {\n      devLog.debug('üóëÔ∏è Bulk deleting request IDs:', requestIds)\n\n      // Try ICT approval endpoint first\n      let response\n      try {\n        response = await apiClient.post('/ict-approval/device-requests/bulk-delete', {\n          request_ids: requestIds\n        })\n        devLog.debug('‚úÖ Successfully bulk deleted via ICT approval endpoint')\n      } catch (ictError) {\n        devLog.debug(\n          '‚ö†Ô∏è ICT approval endpoint failed, trying booking service endpoint:',\n          ictError.response?.status\n        )\n\n        // Fallback to booking service endpoint (if implemented)\n        response = await apiClient.post('/booking-service/bookings/bulk-delete', {\n          request_ids: requestIds\n        })\n        devLog.debug('‚úÖ Successfully bulk deleted via booking service endpoint')\n      }\n\n      return {\n        success: true,\n        data: response.data.data || {},\n        message: response.data.message || 'Requests deleted successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to bulk delete requests:', {\n        requestIds,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to delete requests',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Check if a request can be deleted based on its status\n   * @param {Object} request - Request object\n   * @returns {boolean} - Whether the request can be deleted\n   */\n  canDeleteRequest(request) {\n    // Allow deletion of: pending requests, rejected requests, and approved requests that have been returned\n    if (request.ict_approve === 'pending' || request.status === 'pending') {\n      return true\n    }\n    if (request.ict_approve === 'rejected') {\n      return true\n    }\n    if (\n      request.ict_approve === 'approved' &&\n      (request.return_status === 'returned' || request.return_status === 'returned_but_compromised')\n    ) {\n      return true\n    }\n    return false\n  },\n\n  /**\n   * Check if the request is a booking request (from booking_service table)\n   * @param {Object} request - Raw request data from API\n   * @returns {boolean} - True if it's a booking request\n   */\n  isBookingRequest(request) {\n    // Check for booking-specific fields that indicate this is from booking_service table\n    const bookingIndicators = [\n      'phone_number', // booking_service uses phone_number field\n      'device_inventory_id', // booking_service has device inventory links\n      'return_time', // booking_service has return_time field\n      'ict_approve', // booking_service has ICT approval workflow\n      'device_condition_issuing', // booking_service has device assessments\n      'booking_date' // booking_service has booking_date field\n    ]\n\n    // Check if request has multiple booking-specific indicators\n    const hasBookingFields = bookingIndicators.filter(\n      (field) =>\n        Object.prototype.hasOwnProperty.call(request, field) &&\n        request[field] !== null &&\n        request[field] !== undefined\n    ).length\n\n    // Also check the endpoint or source if available\n    const isFromBookingEndpoint =\n      request._source === 'booking_service' ||\n      request._endpoint?.includes('booking') ||\n      request._endpoint?.includes('device-requests')\n\n    devLog.debug('üîç Request type detection:', {\n      requestId: request.id,\n      hasBookingFields: hasBookingFields,\n      bookingFieldsFound: bookingIndicators.filter((field) =>\n        Object.prototype.hasOwnProperty.call(request, field)\n      ),\n      isFromBookingEndpoint,\n      isBookingRequest: hasBookingFields >= 3 || isFromBookingEndpoint\n    })\n\n    // Consider it a booking request if it has 3+ booking indicators or comes from booking endpoint\n    return hasBookingFields >= 3 || isFromBookingEndpoint\n  },\n\n  /**\n   * Get phone number - now always prioritizes users table\n   * @param {Object} request - Raw request data from API\n   * @returns {string|null} - Phone number from users table\n   */\n  getPhoneNumber(request) {\n    // Always prioritize phone number from users table for both booking and approval processes\n    const phoneNumber = request.user?.phone || request.phone_number || request.borrower_phone\n\n    devLog.debug('üìû Auto-captured phone number from users table:', {\n      requestId: request.id,\n      user_phone: request.user?.phone,\n      phone_number: request.phone_number,\n      borrower_phone: request.borrower_phone,\n      selected: phoneNumber,\n      source: request.user?.phone\n        ? 'users_table'\n        : request.phone_number\n          ? 'booking_service_table'\n          : 'fallback'\n    })\n\n    return phoneNumber\n  },\n\n  /**\n   * Transform raw request data to standardized format\n   * @param {Object} request - Raw request data from API\n   * @returns {Object} - Transformed request data\n   */\n  transformRequest(request) {\n    if (!request) return null\n\n    // Detect request type and get appropriate phone number\n    const isBooking = this.isBookingRequest(request)\n    const phoneNumber = this.getPhoneNumber(request)\n\n    // Safely parse assessment blobs if present\n    const parseAssessment = (blob) => {\n      if (!blob) return null\n      if (typeof blob === 'object') return blob\n      try {\n        return JSON.parse(blob)\n      } catch (_) {\n        return null\n      }\n    }\n\n    const issuingAssessment = parseAssessment(\n      request.device_condition_issuing || request.issuing_assessment || request.assessment_issuing\n    )\n    const receivingAssessment = parseAssessment(\n      request.device_condition_receiving ||\n        request.receiving_assessment ||\n        request.assessment_receiving\n    )\n\n    // Determine signature presence:\n    // - Prefer explicit has_signature flag from backend (supports digital signatures)\n    // - Fallback to legacy \"signature\" boolean\n    // - Finally, use presence of signature_path\n    const hasSignatureBackend =\n      typeof request.has_signature !== 'undefined'\n        ? !!request.has_signature\n        : typeof request.signature !== 'undefined'\n          ? !!request.signature\n          : !!request.signature_path\n\n    return {\n      // Core request data\n      id: request.id,\n      request_id: `REQ-${request.id.toString().padStart(6, '0')}`,\n      request_type: isBooking ? 'booking' : 'access', // Add request type for reference\n\n      // Auto-captured user details\n      borrower_id: request.user_id || request.borrower_id,\n      borrower_name: request.user?.name || request.borrower_name || 'Unknown User',\n      borrower_email: request.user?.email || request.borrower_email,\n      borrower_phone: phoneNumber,\n      pf_number: request.user?.pf_number || request.pf_number,\n\n      // Department details\n      department_id: request.user?.department_id || request.department_id,\n      department:\n        request.user?.department?.name ||\n        request.departmentInfo?.name ||\n        request.department ||\n        'Unknown Department',\n\n      // Device details\n      device_type: request.device_type,\n      custom_device: request.custom_device,\n      device_name:\n        Array.isArray(request.all_device_names) && request.all_device_names.length\n          ? request.all_device_names.join(' & ')\n          : this.getDeviceDisplayName(\n              request.device_type,\n              request.custom_device,\n              request.device_inventory_ids\n            ),\n      device_inventory_id: request.device_inventory_id,\n      device_inventory_ids: request.device_inventory_ids || [],\n      all_device_names: Array.isArray(request.all_device_names) ? request.all_device_names : [],\n      device_available:\n        typeof request.device_available !== 'undefined' ? request.device_available : null,\n\n      // Booking details\n      booking_date: request.booking_date,\n      return_date: request.return_date,\n      return_time: request.return_time,\n      return_date_time: request.return_date_time,\n      reason: request.reason || request.purpose,\n      purpose: request.purpose || request.reason,\n\n      // Signature details\n      signature_path: request.signature_path,\n      signature_url: request.signature_url,\n      has_signature: hasSignatureBackend,\n\n      // Status and approval\n      status: request.status || 'pending',\n      ict_approve: request.ict_approve || 'pending',\n      ict_approved_at: request.ict_approved_at,\n      ict_notes: request.ict_notes,\n      ict_approved_by: request.ict_approved_by,\n\n      // SMS status (normalized for UI)\n      sms_to_requester_status: request.sms_to_requester_status,\n      sms_to_hod_status: request.sms_to_hod_status,\n      sms_sent_to_requester_at: request.sms_sent_to_requester_at,\n      sms_status:\n        request.sms_status ||\n        request.sms_to_requester_status ||\n        request.sms_to_hod_status ||\n        'pending',\n\n      // Return status\n      return_status: request.return_status || 'not_yet_returned',\n\n      // Assessment timestamps/state\n      device_issued_at: request.device_issued_at,\n      device_received_at: request.device_received_at,\n\n      // Normalized assessment blobs (kept as objects if possible)\n      device_condition_issuing: issuingAssessment,\n      device_condition_receiving: receivingAssessment,\n\n      // Admin approval (separate from ICT approval)\n      admin_approved_by: request.approved_by,\n      admin_approved_at: request.approved_at,\n      admin_notes: request.admin_notes,\n\n      // Timestamps\n      created_at: request.created_at,\n      updated_at: request.updated_at,\n\n      // Raw data for advanced operations\n      _raw: request\n    }\n  },\n\n  /**\n   * Get device display name based on type and custom device\n   * @param {string} deviceType - Device type\n   * @param {string} customDevice - Custom device name\n   * @returns {string} - Display name\n   */\n  getDeviceDisplayName(deviceType, customDevice, deviceInventoryIds = []) {\n    // Base name from type/custom\n    let baseName\n    if (deviceType === 'others' && customDevice) {\n      baseName = customDevice\n    } else {\n      const deviceTypes = {\n        projector: 'Projector',\n        tv_remote: 'TV Remote',\n        hdmi_cable: 'HDMI Cable',\n        monitor: 'Monitor',\n        cpu: 'CPU',\n        keyboard: 'Keyboard',\n        pc: 'PC',\n        others: 'Others'\n      }\n      baseName = deviceTypes[deviceType] || deviceType || 'Unknown Device'\n    }\n\n    const ids = Array.isArray(deviceInventoryIds) ? deviceInventoryIds.filter(Boolean) : []\n    if (ids.length > 1) {\n      const extra = ids.length - 1\n      return `${baseName} + ${extra} more device${extra > 1 ? 's' : ''}`\n    }\n\n    return baseName\n  },\n\n  /**\n   * Format date string for display\n   * @param {string} dateString - ISO date string\n   * @returns {string} - Formatted date\n   */\n  formatDate(dateString) {\n    if (!dateString) return 'N/A'\n\n    try {\n      return new Date(dateString).toLocaleDateString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      })\n    } catch (error) {\n      return dateString\n    }\n  },\n\n  /**\n   * Format datetime string for display\n   * @param {string} dateString - ISO datetime string\n   * @returns {string} - Formatted datetime\n   */\n  formatDateTime(dateString) {\n    if (!dateString) return 'N/A'\n\n    try {\n      return new Date(dateString).toLocaleString('en-US', {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit'\n      })\n    } catch (error) {\n      return dateString\n    }\n  },\n\n  /**\n   * Get CSS class for status badge\n   * @param {string} status - ICT approval status\n   * @returns {string} - CSS classes\n   */\n  getStatusBadgeClass(status) {\n    const statusClasses = {\n      pending: 'bg-yellow-100 text-yellow-800 border-yellow-200',\n      approved: 'bg-green-100 text-green-800 border-green-200',\n      rejected: 'bg-red-100 text-red-800 border-red-200'\n    }\n\n    return statusClasses[status] || statusClasses.pending\n  },\n\n  /**\n   * Get icon for status\n   * @param {string} status - ICT approval status\n   * @returns {string} - Font Awesome icon class\n   */\n  getStatusIcon(status) {\n    const statusIcons = {\n      pending: 'fas fa-clock',\n      approved: 'fas fa-check-circle',\n      rejected: 'fas fa-times-circle'\n    }\n\n    return statusIcons[status] || statusIcons.pending\n  },\n\n  /**\n   * Get text for status\n   * @param {string} status - ICT approval status\n   * @returns {string} - Status text\n   */\n  getStatusText(status) {\n    const statusTexts = {\n      pending: 'Pending',\n      approved: 'Approved',\n      rejected: 'Rejected'\n    }\n\n    return statusTexts[status] || status || 'Unknown'\n  },\n\n  /**\n   * Get CSS class for return status badge\n   * @param {string} returnStatus - Return status\n   * @returns {string} - CSS classes\n   */\n  getReturnStatusBadgeClass(returnStatus) {\n    const statusClasses = {\n      not_yet_returned: 'bg-blue-100 text-blue-800 border-blue-200',\n      returned: 'bg-green-100 text-green-800 border-green-200',\n      returned_but_compromised: 'bg-red-100 text-red-800 border-red-200',\n      out_of_stock: 'bg-yellow-100 text-yellow-800 border-yellow-200', // Treated as pending\n      received: 'bg-green-100 text-green-800 border-green-200', // Same as returned\n      received_compromised: 'bg-red-100 text-red-800 border-red-200' // Compromised received\n    }\n\n    return statusClasses[returnStatus] || statusClasses.not_yet_returned\n  },\n\n  /**\n   * Get icon for return status\n   * @param {string} returnStatus - Return status\n   * @returns {string} - Font Awesome icon class\n   */\n  getReturnStatusIcon(returnStatus) {\n    const statusIcons = {\n      not_yet_returned: 'fas fa-hourglass-half',\n      returned: 'fas fa-check-circle',\n      returned_but_compromised: 'fas fa-exclamation-triangle'\n    }\n\n    return statusIcons[returnStatus] || statusIcons.not_yet_returned\n  },\n\n  /**\n   * Get text for return status\n   * @param {string} returnStatus - Return status\n   * @returns {string} - Return status text\n   */\n  getReturnStatusText(returnStatus) {\n    const statusTexts = {\n      not_yet_returned: 'Not Returned',\n      returned: 'Returned',\n      returned_but_compromised: 'Compromised',\n      received: 'Received',\n      received_compromised: 'Received (Compromised)'\n    }\n\n    return statusTexts[returnStatus] || returnStatus || 'Unknown'\n  },\n\n  /**\n   * Save device condition assessment when issuing device\n   * @param {number} requestId - Request ID\n   * @param {Object} assessmentData - Assessment data\n   * @returns {Promise<Object>} - API response\n   */\n  async saveIssuingAssessment(requestId, assessmentData) {\n    try {\n      devLog.debug('üíæ Saving issuing assessment for request ID:', requestId, assessmentData)\n\n      // Try ICT approval endpoint first (recommended approach)\n      let response\n      try {\n        response = await apiClient.post(\n          `/ict-approval/device-requests/${requestId}/assessment/issuing`,\n          assessmentData\n        )\n        devLog.debug('‚úÖ Successfully saved via ICT approval endpoint')\n      } catch (ictError) {\n        const status = ictError.response?.status\n        devLog.debug('‚ö†Ô∏è ICT approval endpoint failed:', status, ictError.response?.data?.message)\n        // Only fallback for missing/not-implemented routes; surface business/validation errors\n        const shouldFallback = !status || [404, 405, 501].includes(status)\n        if (!shouldFallback) {\n          throw ictError\n        }\n        devLog.debug('‚Ü©Ô∏è Falling back to booking-service endpoint...')\n        // Fallback to booking service endpoint\n        response = await apiClient.post(\n          `/booking-service/bookings/${requestId}/assessment/issuing`,\n          assessmentData\n        )\n        devLog.debug('‚úÖ Successfully saved via booking service endpoint')\n      }\n\n      return {\n        success: true,\n        data: this.transformRequest(response.data.data || response.data),\n        message:\n          response.data.message || 'Device issued and condition assessment saved successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to save issuing assessment:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to save assessment',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  },\n\n  /**\n   * Save device condition assessment when receiving device back\n   * @param {number} requestId - Request ID\n   * @param {Object} assessmentData - Assessment data\n   * @returns {Promise<Object>} - API response\n   */\n  async saveReceivingAssessment(requestId, assessmentData) {\n    try {\n      devLog.debug('üì• Saving receiving assessment for request ID:', requestId, assessmentData)\n\n      // Try ICT approval endpoint first (recommended approach)\n      let response\n      try {\n        response = await apiClient.post(\n          `/ict-approval/device-requests/${requestId}/assessment/receiving`,\n          assessmentData\n        )\n        devLog.debug('‚úÖ Successfully saved via ICT approval endpoint')\n      } catch (ictError) {\n        const status = ictError.response?.status\n        devLog.debug('‚ö†Ô∏è ICT approval endpoint failed:', status, ictError.response?.data?.message)\n        const shouldFallback = !status || [404, 405, 501].includes(status)\n        if (!shouldFallback) {\n          throw ictError\n        }\n        devLog.debug('‚Ü©Ô∏è Falling back to booking-service endpoint...')\n        // Fallback to booking service endpoint\n        response = await apiClient.post(\n          `/booking-service/bookings/${requestId}/assessment/receiving`,\n          assessmentData\n        )\n        devLog.debug('‚úÖ Successfully saved via booking service endpoint')\n      }\n\n      return {\n        success: true,\n        data: this.transformRequest(response.data.data || response.data),\n        message: response.data.message || 'Device received and assessment completed successfully'\n      }\n    } catch (error) {\n      devLog.error('‚ùå Failed to save receiving assessment:', {\n        requestId,\n        error: error.message,\n        status: error.response?.status,\n        responseData: error.response?.data\n      })\n\n      return {\n        success: false,\n        message: error.response?.data?.message || error.message || 'Failed to save assessment',\n        errors: error.response?.data?.errors || {},\n        status: error.response?.status\n      }\n    }\n  }\n}\n\nexport default deviceBorrowingService\n"],"names":["deviceBorrowingService","getAllRequests","params","response","apiClient","get","per_page","devLog","debug","ictError","status","data","message","requests","transformedRequests","Array","isArray","map","request","this","transformRequest","success","current_page","last_page","total","length","error","getPendingRequests","ict_status","getRequestDetails","requestId","sourceEndpoint","_endpoint","_source","includes","reason","purpose","phone_number","borrower_phone","user_phone","user","phone","phoneNumber","isBooking","isBookingRequest","id","detectedType","Error","transformedRequest","request_type","statusText","responseData","details","endpoint","config","url","method","approveRequest","notes","post","ict_notes","bsError","shouldFallback","errors","rejectRequest","trim","deleteRequest","delete","bulkDeleteRequests","requestIds","request_ids","canDeleteRequest","ict_approve","return_status","bookingIndicators","hasBookingFields","filter","field","Object","prototype","hasOwnProperty","call","undefined","isFromBookingEndpoint","bookingFieldsFound","getPhoneNumber","selected","source","parseAssessment","blob","JSON","parse","_","issuingAssessment","device_condition_issuing","issuing_assessment","assessment_issuing","receivingAssessment","device_condition_receiving","receiving_assessment","assessment_receiving","hasSignatureBackend","has_signature","signature","signature_path","request_id","toString","padStart","borrower_id","user_id","borrower_name","name","borrower_email","email","pf_number","department_id","department","departmentInfo","device_type","custom_device","device_name","all_device_names","join","getDeviceDisplayName","device_inventory_ids","device_inventory_id","device_available","booking_date","return_date","return_time","return_date_time","signature_url","ict_approved_at","ict_approved_by","sms_to_requester_status","sms_to_hod_status","sms_sent_to_requester_at","sms_status","device_issued_at","device_received_at","admin_approved_by","approved_by","admin_approved_at","approved_at","admin_notes","created_at","updated_at","_raw","deviceType","customDevice","deviceInventoryIds","baseName","deviceTypes","projector","tv_remote","hdmi_cable","monitor","cpu","keyboard","pc","others","ids","Boolean","extra","formatDate","dateString","Date","toLocaleDateString","year","month","day","formatDateTime","toLocaleString","hour","minute","getStatusBadgeClass","statusClasses","pending","approved","rejected","getStatusIcon","statusIcons","getStatusText","statusTexts","getReturnStatusBadgeClass","returnStatus","not_yet_returned","returned","returned_but_compromised","out_of_stock","received","received_compromised","getReturnStatusIcon","getReturnStatusText","saveIssuingAssessment","assessmentData","saveReceivingAssessment"],"sourceRoot":""}