"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[4710,6530],{1445:function(e,s,t){t.d(s,{A:function(){return k}});var i=t(5796);const a={key:0,class:"fixed inset-0 z-40 flex items-center justify-center pointer-events-none animate-fade-in"},r={class:"pointer-events-auto w-full max-w-lg mx-auto"},o={class:"relative bg-gradient-to-br from-white/20 via-blue-50/30 to-white/10 border-2 border-blue-300/50 backdrop-blur-xl rounded-3xl p-8 shadow-2xl overflow-hidden"},n={class:"relative z-10"},l={class:"flex items-center justify-center gap-6 mb-6"},d={class:"relative flex flex-col items-center"},c={class:"relative mb-3"},u={class:"text-center"},v={class:"text-white text-2xl font-bold tracking-wide mb-1 drop-shadow-md"},p={class:"text-blue-100 text-lg animate-pulse"},m={class:"text-center border-t border-blue-300/30 pt-4"},b={class:"text-teal-200 text-base font-semibold tracking-wider"};function h(e,s,t,h,g,f){return t.show?((0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("div",r,[(0,i.Lk)("div",o,[s[5]||(s[5]=(0,i.Fv)('<div class="absolute inset-0 opacity-10" data-v-94539b4a><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-slide-across" data-v-94539b4a></div><div class="absolute top-4 left-4 w-16 h-16 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.2);" data-v-94539b4a></div><div class="absolute bottom-4 right-4 w-20 h-20 bg-blue-400/20 rounded-full animate-float" style="animation-delay:1s;" data-v-94539b4a></div><div class="absolute top-1/2 left-8 w-12 h-12 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.15);animation-delay:2s;" data-v-94539b4a></div></div>',1)),(0,i.Lk)("div",n,[(0,i.Lk)("div",l,[s[1]||(s[1]=(0,i.Lk)("div",{class:"relative"},[(0,i.Lk)("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-500/30 to-teal-500/30 rounded-2xl backdrop-blur-sm border-2 border-blue-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300"},[(0,i.Lk)("img",{src:"/assets/images/ngao2.png",alt:"National Shield",class:"max-w-12 max-h-12 object-contain drop-shadow-lg"})]),(0,i.Lk)("div",{class:"absolute -inset-1 bg-gradient-to-r from-blue-400 to-teal-400 rounded-2xl opacity-20 blur-sm animate-pulse"})],-1)),(0,i.Lk)("div",d,[(0,i.Lk)("div",c,[s[0]||(s[0]=(0,i.Lk)("div",{class:"rounded-full h-12 w-12 border-2 border-gray-300/20"},null,-1)),(0,i.Lk)("div",{class:(0,i.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",t.forceSpin?"always-spin":"animate-spin"]),style:{"border-top-color":"#ff0000","animation-duration":"2s"}},null,2),(0,i.Lk)("div",{class:(0,i.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",t.forceSpin?"always-spin":"animate-spin"]),style:{"border-bottom-color":"#0000d1","animation-direction":"reverse","animation-duration":"1.5s"}},null,2),(0,i.Lk)("div",{class:(0,i.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",t.forceSpin?"always-spin":"animate-spin"]),style:{"border-right-color":"rgba(255, 0, 0, 0.7)","animation-duration":"2.5s"}},null,2),(0,i.Lk)("div",{class:(0,i.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",t.forceSpin?"always-spin":"animate-spin"]),style:{"border-left-color":"rgba(0, 0, 209, 0.7)","animation-direction":"reverse","animation-duration":"1.8s"}},null,2)]),(0,i.Lk)("div",u,[(0,i.Lk)("div",v,(0,i.v_)(t.loadingTitle),1),(0,i.Lk)("div",p,(0,i.v_)(t.loadingSubtitle),1)])]),s[2]||(s[2]=(0,i.Lk)("div",{class:"relative"},[(0,i.Lk)("div",{class:"w-16 h-16 bg-gradient-to-br from-teal-500/30 to-blue-500/30 rounded-2xl backdrop-blur-sm border-2 border-teal-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300"},[(0,i.Lk)("img",{src:"/assets/images/logo2.png",alt:"MNH Logo",class:"max-w-12 max-h-12 object-contain drop-shadow-lg"})]),(0,i.Lk)("div",{class:"absolute -inset-1 bg-gradient-to-r from-teal-400 to-blue-400 rounded-2xl opacity-20 blur-sm animate-pulse",style:{"animation-delay":"0.5s"}})],-1))]),(0,i.Lk)("div",m,[s[3]||(s[3]=(0,i.Lk)("div",{class:"text-lg font-black tracking-widest mb-1 drop-shadow-sm",style:{color:"#ff0000"}}," MUHIMBILI NATIONAL HOSPITAL ",-1)),(0,i.Lk)("div",b,(0,i.v_)(t.departmentTitle),1)]),s[4]||(s[4]=(0,i.Fv)('<div class="flex justify-center gap-2 mt-4" data-v-94539b4a><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.1s;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;animation-delay:0.2s;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.3s;" data-v-94539b4a></div></div>',1))])])])])):(0,i.Q3)("",!0)}var g={name:"UnifiedLoadingBanner",props:{show:{type:Boolean,default:!0},loadingTitle:{type:String,default:"Loading Requests"},loadingSubtitle:{type:String,default:"Please wait..."},departmentTitle:{type:String,default:"SYSTEM MANAGEMENT"},forceSpin:{type:Boolean,default:!1}}},f=t(1241);const x=(0,f.A)(g,[["render",h],["__scopeId","data-v-94539b4a"]]);var k=x},1911:function(e,s,t){t.r(s),t.d(s,{default:function(){return Ds}});var i=t(5796);const a={class:"h-screen flex flex-col"},r={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-2 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 overflow-y-auto"},n={class:"absolute inset-0 overflow-hidden pointer-events-none"},l={class:"absolute inset-0"},d={class:"max-w-full mx-auto px-2 relative z-10 min-h-full"},c={class:"booking-glass-card rounded-t-2xl p-3 mb-0 border-b border-blue-300/30 animate-fade-in"},u={class:"flex justify-between items-center"},v={class:"w-16 h-16 mr-4 transform hover:scale-110 transition-transform duration-300"},p={class:"w-full h-full bg-gradient-to-br from-blue-500/20 to-teal-500/20 rounded-xl backdrop-blur-sm border-2 border-blue-300/40 flex items-center justify-center shadow-xl hover:shadow-blue-500/25"},m={class:"w-16 h-16 ml-4 transform hover:scale-110 transition-transform duration-300"},b={class:"w-full h-full bg-gradient-to-br from-teal-500/20 to-blue-500/20 rounded-xl backdrop-blur-sm border-2 border-teal-300/40 flex items-center justify-center shadow-xl hover:shadow-teal-500/25"},h={class:"booking-glass-card rounded-b-2xl overflow-hidden animate-slide-up"},g={class:"p-3 space-y-3 pb-28"},f={class:"mb-2"},x={key:0,class:"space-y-4"},k={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},w={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},y={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},_={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},q={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},L={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},A={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},R={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},C={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},S={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-lg font-semibold flex items-center gap-2"},I={class:"px-3 py-2 bg-white/10 border border-blue-300/30 rounded text-white text-lg font-semibold"},E={class:"flex items-center gap-2 mb-3"},D={key:0,class:"flex-1"},P={key:1,class:"ml-auto px-3 py-1 bg-emerald-500/20 text-emerald-200 text-xs font-semibold rounded-full border border-emerald-400/30"},j={class:"flex mb-3 bg-blue-900/40 rounded-lg p-1"},M={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3"},T={class:"assessment-options"},N=["value","disabled"],F={class:"option-content"},O={class:"option-icon"},B={class:"option-text"},$={class:"option-label"},U={class:"option-description"},z={class:"assessment-options"},V=["value","onUpdate:modelValue","disabled"],W={class:"option-content"},X={class:"option-icon"},Q={class:"option-text"},H={class:"option-label"},Y={class:"option-description"},G={class:"grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3"},K={class:"assessment-section"},J={class:"assessment-options"},Z={class:"assessment-option checkbox-option cursor-pointer"},ee=["disabled"],se={class:"assessment-section"},te={class:"assessment-options"},ie={class:"assessment-option checkbox-option cursor-pointer"},ae=["disabled"],re={key:0,class:"mt-3"},oe=["disabled"],ne={key:0,class:"mt-3"},le={key:1,class:"mt-3"},de={class:"font-medium"},ce={key:2,class:"bg-red-500/20 border border-red-400/40 rounded-lg p-6"},ue={class:"text-center space-y-3"},ve={class:"text-red-200 text-base"},pe={class:"flex gap-3 justify-center"},me={key:3,class:"sticky bottom-0 z-40 -mx-3"},be={class:"px-3 py-3 bg-blue-950/80 backdrop-blur-md border-t border-blue-400/20 shadow-[0_-8px_24px_rgba(0,0,0,0.35)]"},he={class:"flex flex-col sm:flex-row gap-2"},ge=["disabled","title"],fe={key:1,class:"flex flex-1 gap-2"},xe=["disabled","title"],ke=["disabled"],we=["disabled"],ye={class:"relative z-10 flex items-center justify-center gap-3"},_e={class:"flex flex-col items-start"},qe={class:"text-xl font-bold tracking-wide"},Le={key:0,class:"absolute top-2 right-2"};function Ae(e,s,t,Ae,Re,Ce){const Se=(0,i.g2)("Header"),Ie=(0,i.g2)("ModernSidebar"),Ee=(0,i.g2)("UnifiedLoadingBanner"),De=(0,i.g2)("AppFooter"),Pe=(0,i.g2)("ApprovalConfirmationModal"),je=(0,i.g2)("PostIssuingActionModal"),Me=(0,i.g2)("RejectRequestModal"),Te=(0,i.g2)("ReceiveConfirmationModal");return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.bF)(Se),(0,i.Lk)("div",r,[(0,i.bF)(Ie),(0,i.Lk)("main",o,[(0,i.bF)(Ee,{show:Re.isLoading||Re.isProcessing||Re.isProcessingAssessment,loadingTitle:Ce.getLoadingTitle(),loadingSubtitle:Ce.getLoadingSubtitle(),departmentTitle:"ICT APPROVAL PANEL",forceSpin:!0},null,8,["show","loadingTitle","loadingSubtitle"]),(0,i.Lk)("div",n,[(0,i.Lk)("div",l,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(15,e=>(0,i.Lk)("div",{key:e,class:"absolute text-white opacity-5 animate-float",style:(0,i.Tr)({left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:3*Math.random()+2+"s",fontSize:15*Math.random()+8+"px"})},[(0,i.Lk)("i",{class:(0,i.C4)(["fas",["fa-laptop","fa-tv","fa-desktop","fa-keyboard","fa-mouse","fa-headphones"][Math.floor(6*Math.random())]])},null,2)],4)),64))])]),(0,i.Lk)("div",d,[(0,i.Lk)("div",c,[(0,i.Lk)("div",u,[(0,i.Lk)("div",v,[(0,i.Lk)("div",p,[(0,i.Lk)("img",{src:"/assets/images/ngao2.png",alt:"National Shield",class:"max-w-12 max-h-12 object-contain",onError:s[0]||(s[0]=(...e)=>Ce.handleImageError&&Ce.handleImageError(...e))},null,32)])]),s[21]||(s[21]=(0,i.Fv)('<div class="text-center flex-1" data-v-69885670><h1 class="text-lg font-bold text-white mb-2 tracking-wide drop-shadow-lg animate-fade-in" data-v-69885670> MUHIMBILI NATIONAL HOSPITAL </h1><div class="relative inline-block mb-2" data-v-69885670><div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-4 py-1 rounded-full text-sm font-bold shadow-xl transform hover:scale-105 transition-all duration-300 border-2 border-blue-400/60" data-v-69885670><span class="relative z-10 flex items-center gap-2" data-v-69885670><i class="fas fa-clipboard-check text-sm" data-v-69885670></i> REQUEST DETAILS &amp; ASSESSMENT </span><div class="absolute inset-0 bg-gradient-to-r from-blue-700 to-blue-800 rounded-full opacity-0 hover:opacity-100 transition-opacity duration-300" data-v-69885670></div></div></div><h2 class="text-sm font-bold text-blue-100 tracking-wide drop-shadow-md animate-fade-in-delay" data-v-69885670> ICT OFFICER REVIEW PANEL </h2></div>',1)),(0,i.Lk)("div",m,[(0,i.Lk)("div",b,[(0,i.Lk)("img",{src:"/assets/images/logo2.png",alt:"Muhimbili Logo",class:"max-w-12 max-h-12 object-contain",onError:s[1]||(s[1]=(...e)=>Ce.handleImageError&&Ce.handleImageError(...e))},null,32)])])])]),(0,i.Lk)("div",h,[(0,i.Lk)("div",g,[(0,i.Lk)("div",f,[(0,i.Lk)("button",{onClick:s[2]||(s[2]=(...e)=>Ce.goBack&&Ce.goBack(...e)),class:"inline-flex items-center px-3 py-1 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition-colors"},[...s[22]||(s[22]=[(0,i.Lk)("i",{class:"fas fa-arrow-left mr-2 text-xs"},null,-1),(0,i.eW)(" Back to Requests List ",-1)])])]),!Re.isLoading&&Object.keys(Re.request).length>0?((0,i.uX)(),(0,i.CE)("div",x,[s[33]||(s[33]=(0,i.Lk)("h3",{class:"text-2xl font-bold text-white"},"Request Information",-1)),(0,i.Lk)("div",k,[(0,i.Lk)("div",null,[s[23]||(s[23]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Request ID",-1)),(0,i.Lk)("div",w,(0,i.v_)(Re.request.request_id||`REQ-${String(Re.request.id).padStart(6,"0")}`),1)]),(0,i.Lk)("div",null,[s[24]||(s[24]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Borrower Name",-1)),(0,i.Lk)("div",y,(0,i.v_)(Re.request.borrower_name||Re.request.borrowerName||"Unknown"),1)]),(0,i.Lk)("div",null,[s[25]||(s[25]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Department",-1)),(0,i.Lk)("div",_,(0,i.v_)(Re.request.department||"Unknown Department"),1)]),(0,i.Lk)("div",null,[s[26]||(s[26]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Phone Number",-1)),(0,i.Lk)("div",q,(0,i.v_)(Re.request.borrower_phone||Re.request.phoneNumber||"No phone provided"),1)]),(0,i.Lk)("div",null,[s[27]||(s[27]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"PF Number",-1)),(0,i.Lk)("div",L,(0,i.v_)(Re.request.pf_number),1)]),(0,i.Lk)("div",null,[s[28]||(s[28]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Device Type",-1)),(0,i.Lk)("div",A,(0,i.v_)(Re.request.device_name||Ce.getDeviceDisplayName(Re.request.device_type,Re.request.custom_device)),1)]),(0,i.Lk)("div",null,[s[29]||(s[29]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Booking Date",-1)),(0,i.Lk)("div",R,(0,i.v_)(Ce.formatDate(Re.request.booking_date||Re.request.bookingDate)),1)]),(0,i.Lk)("div",null,[s[30]||(s[30]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Return Time",-1)),(0,i.Lk)("div",C,(0,i.v_)(Re.request.return_time||Re.request.returnTime||"No time specified"),1)]),(0,i.Lk)("div",null,[s[31]||(s[31]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Current Status",-1)),(0,i.Lk)("div",S,[(0,i.Lk)("i",{class:(0,i.C4)(Ce.getStatusIcon(Re.deviceReceived?"received":Re.requestApproved?"approved":Re.request.ict_approve||Re.request.status))},null,2),(0,i.Lk)("span",{class:(0,i.C4)(Ce.getStatusTextColor(Re.deviceReceived?"received":Re.requestApproved?"approved":Re.request.ict_approve||Re.request.status))},(0,i.v_)(Ce.currentStatusText),3)])])]),(0,i.Lk)("div",null,[s[32]||(s[32]=(0,i.Lk)("label",{class:"block text-base font-bold text-blue-200 mb-2"},"Purpose/Reason",-1)),(0,i.Lk)("div",I,(0,i.v_)(Re.request.reason||Re.request.purpose||"No reason provided"),1)])])):(0,i.Q3)("",!0),!Re.isLoading&&Object.keys(Re.request).length>0?((0,i.uX)(),(0,i.CE)("div",{key:1,class:(0,i.C4)(["bg-blue-800/30 backdrop-blur-sm rounded-lg p-3 border border-blue-600/40 animate-fade-in",Ce.isReadOnly?"readonly-mode":""])},[(0,i.Lk)("div",E,[!1!==Re.request.device_available||Ce.isReadOnly?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",D,[...s[34]||(s[34]=[(0,i.Lk)("div",{class:"px-3 py-2 rounded-md bg-red-500/20 border border-red-400/40 text-red-200 text-sm font-semibold"},[(0,i.Lk)("i",{class:"fas fa-exclamation-triangle mr-2"}),(0,i.eW)(" Device is no longer available. You cannot issue this request. ")],-1)])])),s[35]||(s[35]=(0,i.Lk)("div",{class:"w-6 h-6 bg-gradient-to-br from-blue-500 to-blue-700 rounded-md flex items-center justify-center"},[(0,i.Lk)("i",{class:"fas fa-clipboard-check text-white text-sm"})],-1)),s[36]||(s[36]=(0,i.Lk)("h3",{class:"text-3xl font-bold text-white"},"Device Condition Assessment",-1)),Ce.isReadOnly?((0,i.uX)(),(0,i.CE)("span",P,"Finalized")):(0,i.Q3)("",!0)]),(0,i.Lk)("div",j,[(0,i.Lk)("button",{onClick:s[3]||(s[3]=e=>Re.assessmentType="issuing"),class:(0,i.C4)(["flex-1 py-2 px-3 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 text-xl","issuing"===Re.assessmentType?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"text-blue-200 hover:text-white hover:bg-blue-800/50"])},[...s[37]||(s[37]=[(0,i.Lk)("i",{class:"fas fa-hand-holding text-xs"},null,-1),(0,i.eW)(" Device Issuing ",-1)])],2),(0,i.Lk)("button",{onClick:s[4]||(s[4]=e=>Re.assessmentType="receiving"),"data-tab":"receiving",class:(0,i.C4)(["flex-1 py-2 px-3 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 text-xl","receiving"===Re.assessmentType?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"text-blue-200 hover:text-white hover:bg-blue-800/50"])},[...s[38]||(s[38]=[(0,i.Lk)("i",{class:"fas fa-undo text-xs"},null,-1),(0,i.eW)(" Device Receiving ",-1)])],2)]),(0,i.Lk)("div",M,[(0,i.Lk)("div",{class:(0,i.C4)(["assessment-section physical-section",{"readonly-highlight":Ce.isReadOnly}])},[s[40]||(s[40]=(0,i.Fv)('<div class="assessment-header" data-v-69885670><div class="assessment-icon-wrapper bg-gradient-to-br from-blue-500 to-blue-600" data-v-69885670><i class="fas fa-search-plus text-white text-xl" data-v-69885670></i></div><div data-v-69885670><h4 class="text-3xl font-bold text-white mb-1" data-v-69885670>Physical Condition</h4><p class="text-blue-200 text-xl" data-v-69885670>Assess the overall physical appearance</p></div><span class="optional-badge" data-v-69885670>Required</span></div>',1)),(0,i.Lk)("div",T,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Re.physicalConditions,e=>((0,i.uX)(),(0,i.CE)("label",{key:e.value,class:(0,i.C4)(["assessment-option",Ce.selectedPhysical===e.value?"selected":"",e.value])},[(0,i.bo)((0,i.Lk)("input",{type:"radio",value:e.value,"onUpdate:modelValue":s[5]||(s[5]=e=>Ce.currentAssessment.physical_condition=e),disabled:Ce.isReadOnly,class:"hidden"},null,8,N),[[i.XL,Ce.currentAssessment.physical_condition]]),(0,i.Lk)("div",F,[(0,i.Lk)("div",O,[(0,i.Lk)("i",{class:(0,i.C4)(e.icon)},null,2)]),(0,i.Lk)("div",B,[(0,i.Lk)("span",$,(0,i.v_)(e.label),1),(0,i.Lk)("span",U,(0,i.v_)(e.description),1)]),s[39]||(s[39]=(0,i.Lk)("div",{class:"option-indicator"},[(0,i.Lk)("div",{class:"radio-custom"})],-1))])],2))),128))])],2),(0,i.Lk)("div",{class:(0,i.C4)(["assessment-section functionality-section",{"readonly-highlight":Ce.isReadOnly}])},[s[42]||(s[42]=(0,i.Fv)('<div class="assessment-header" data-v-69885670><div class="assessment-icon-wrapper bg-gradient-to-br from-blue-500 to-blue-600" data-v-69885670><i class="fas fa-cogs text-white text-xl" data-v-69885670></i></div><div data-v-69885670><h4 class="text-3xl font-bold text-white mb-1" data-v-69885670>Device Functionality</h4><p class="text-blue-200 text-xl" data-v-69885670>Test and verify device operations</p></div><span class="required-badge" data-v-69885670>Required</span></div>',1)),(0,i.Lk)("div",z,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(Re.functionalityOptions,e=>((0,i.uX)(),(0,i.CE)("label",{key:e.value,class:(0,i.C4)(["assessment-option",Ce.selectedFunctionality===e.value?"selected":"",e.value.replace("_","-")])},[(0,i.bo)((0,i.Lk)("input",{type:"radio",value:e.value,"onUpdate:modelValue":e=>Ce.currentAssessment.functionality=e,disabled:Ce.isReadOnly,class:"hidden"},null,8,V),[[i.XL,Ce.currentAssessment.functionality]]),(0,i.Lk)("div",W,[(0,i.Lk)("div",X,[(0,i.Lk)("i",{class:(0,i.C4)(e.icon)},null,2)]),(0,i.Lk)("div",Q,[(0,i.Lk)("span",H,(0,i.v_)(e.label),1),(0,i.Lk)("span",Y,(0,i.v_)(e.description),1)]),s[41]||(s[41]=(0,i.Lk)("div",{class:"option-indicator"},[(0,i.Lk)("div",{class:"radio-custom"})],-1))])],2))),128))])],2)]),(0,i.Lk)("div",G,[(0,i.Lk)("div",K,[s[44]||(s[44]=(0,i.Fv)('<div class="assessment-header" data-v-69885670><div class="assessment-icon-wrapper bg-gradient-to-br from-purple-500 to-purple-600" data-v-69885670><i class="fas fa-puzzle-piece text-white text-xl" data-v-69885670></i></div><div data-v-69885670><h4 class="text-2xl font-bold text-white mb-1" data-v-69885670>Accessories</h4><p class="text-blue-200 text-lg" data-v-69885670>Check accessory completeness</p></div><span class="optional-badge" data-v-69885670>Optional</span></div>',1)),(0,i.Lk)("div",J,[(0,i.Lk)("label",Z,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=e=>Ce.currentAssessment.accessories_complete=e),disabled:Ce.isReadOnly,class:"hidden"},null,8,ee),[[i.lH,Ce.currentAssessment.accessories_complete]]),s[43]||(s[43]=(0,i.Fv)('<div class="option-content checkbox-content" data-v-69885670><div class="option-icon checkbox-icon bg-purple-500/20 text-purple-400" data-v-69885670><i class="fas fa-puzzle-piece" data-v-69885670></i></div><div class="option-text" data-v-69885670><span class="option-label" data-v-69885670>All accessories included</span><span class="option-description" data-v-69885670>Cables, chargers, manuals, and original packaging</span></div><div class="option-indicator" data-v-69885670><div class="checkbox-custom" data-v-69885670><i class="fas fa-check" data-v-69885670></i></div></div></div>',1))])])]),(0,i.Lk)("div",se,[s[46]||(s[46]=(0,i.Fv)('<div class="assessment-header" data-v-69885670><div class="assessment-icon-wrapper bg-gradient-to-br from-red-500 to-red-600" data-v-69885670><i class="fas fa-exclamation-triangle text-white text-xl" data-v-69885670></i></div><div data-v-69885670><h4 class="text-2xl font-bold text-white mb-1" data-v-69885670>Damage Check</h4><p class="text-blue-200 text-lg" data-v-69885670>Identify any visible damage or issues</p></div><span class="optional-badge" data-v-69885670>Optional</span></div>',1)),(0,i.Lk)("div",te,[(0,i.Lk)("label",ie,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=e=>Ce.currentAssessment.visible_damage=e),disabled:Ce.isReadOnly,class:"hidden"},null,8,ae),[[i.lH,Ce.currentAssessment.visible_damage]]),s[45]||(s[45]=(0,i.Fv)('<div class="option-content checkbox-content" data-v-69885670><div class="option-icon checkbox-icon bg-red-500/20 text-red-400" data-v-69885670><i class="fas fa-exclamation-triangle" data-v-69885670></i></div><div class="option-text" data-v-69885670><span class="option-label" data-v-69885670>Device has damage/issues</span><span class="option-description" data-v-69885670>Scratches, dents, cracks, or functional problems</span></div><div class="option-indicator" data-v-69885670><div class="checkbox-custom" data-v-69885670><i class="fas fa-check" data-v-69885670></i></div></div></div>',1))]),Ce.currentAssessment.visible_damage?((0,i.uX)(),(0,i.CE)("div",re,[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[8]||(s[8]=e=>Ce.currentAssessment.damage_description=e),rows:"2",disabled:Ce.isReadOnly,class:"w-full px-3 py-2 bg-red-900/30 border-2 border-red-600/40 rounded-xl text-white text-base placeholder-red-300 resize-none focus:outline-none focus:border-red-400 focus:shadow-lg focus:shadow-red-500/20 transition-all duration-300 disabled:opacity-60",placeholder:"Describe the damage or issues in detail..."},null,8,oe),[[i.Jo,Ce.currentAssessment.damage_description]])])):(0,i.Q3)("",!0)])])]),Ce.isReadOnly?((0,i.uX)(),(0,i.CE)("div",ne,[...s[47]||(s[47]=[(0,i.Lk)("div",{class:"p-2 rounded-lg border flex items-center gap-2 bg-blue-500/20 border-blue-400/40 text-blue-200"},[(0,i.Lk)("i",{class:"fas fa-lock text-sm"}),(0,i.Lk)("span",{class:"font-medium"},"This request is completed and read-only. No further actions are available.")],-1)])])):(0,i.Q3)("",!0),Re.assessmentMessage?((0,i.uX)(),(0,i.CE)("div",le,[(0,i.Lk)("div",{class:(0,i.C4)(["p-2 rounded-lg border flex items-center gap-2 animate-fade-in","success"===Re.assessmentMessage.type?"bg-green-500/20 border-green-400/40 text-green-200":"bg-red-500/20 border-red-400/40 text-red-200"])},[(0,i.Lk)("i",{class:(0,i.C4)(["fas text-sm","success"===Re.assessmentMessage.type?"fa-check-circle":"fa-exclamation-circle"])},null,2),(0,i.Lk)("span",de,(0,i.v_)(Re.assessmentMessage.text),1)],2)])):(0,i.Q3)("",!0)],2)):Re.isLoading?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",ce,[(0,i.Lk)("div",ue,[s[50]||(s[50]=(0,i.Lk)("i",{class:"fas fa-exclamation-triangle text-red-400 text-4xl"},null,-1)),s[51]||(s[51]=(0,i.Lk)("h3",{class:"text-red-200 text-xl font-semibold"},"Unable to Load Request Details",-1)),(0,i.Lk)("p",ve,(0,i.v_)(Re.loadError||"There was an error loading the request data."),1),(0,i.Lk)("div",pe,[(0,i.Lk)("button",{onClick:s[9]||(s[9]=e=>Ce.fetchRequestDetails()),class:"px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200"},[...s[48]||(s[48]=[(0,i.Lk)("i",{class:"fas fa-redo mr-2"},null,-1),(0,i.eW)(" Retry ",-1)])]),(0,i.Lk)("button",{onClick:s[10]||(s[10]=e=>Ce.goBack()),class:"px-5 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200"},[...s[49]||(s[49]=[(0,i.Lk)("i",{class:"fas fa-list mr-2"},null,-1),(0,i.eW)(" Back to List ",-1)])])])])])),!Ce.isReadOnly&&!Re.isLoading&&Object.keys(Re.request).length>0&&(Ce.showIssuingAssessmentButton||Ce.showApprovalButton||Ce.showReceivingButton)?((0,i.uX)(),(0,i.CE)("div",me,[(0,i.Lk)("div",be,[(0,i.Lk)("div",he,[Ce.showIssuingAssessmentButton?((0,i.uX)(),(0,i.CE)("button",{key:0,onClick:s[11]||(s[11]=(...e)=>Ce.handleIssuingAssessmentAction&&Ce.handleIssuingAssessmentAction(...e)),disabled:!Ce.issuingAssessmentButtonState.enabled,title:Ce.issuingAssessmentButtonState.tooltip,class:(0,i.C4)(["flex-1 py-2 px-3 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 text-sm",Ce.issuingAssessmentButtonState.classes])},[(0,i.Lk)("i",{class:(0,i.C4)(["text-xs",Ce.issuingAssessmentButtonState.icon])},null,2),(0,i.eW)(" "+(0,i.v_)(Ce.issuingAssessmentButtonState.text),1)],10,ge)):(0,i.Q3)("",!0),Ce.showApprovalButton?((0,i.uX)(),(0,i.CE)("div",fe,[(0,i.Lk)("button",{onClick:s[12]||(s[12]=(...e)=>Ce.approveRequest&&Ce.approveRequest(...e)),disabled:!Ce.canTakeAction||Re.isProcessing||Re.requestApproved||!Re.issuingAssessmentSaved,class:(0,i.C4)(["flex-1 py-2 px-3 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 text-sm",Re.requestApproved?"bg-blue-600 text-white shadow-lg border-2 border-blue-400":Ce.canTakeAction&&!Re.isProcessing&&Re.issuingAssessmentSaved?"bg-gradient-to-r from-green-600 to-green-700 text-white shadow-lg hover:from-green-700 hover:to-green-800 border-2 border-green-500/50 hover:border-green-400":"bg-gray-600 text-gray-300 cursor-not-allowed opacity-50"]),title:Ce.getApproveButtonTooltip()},[(0,i.Lk)("i",{class:(0,i.C4)(["text-xs",Re.isProcessing?"fas fa-spinner fa-spin":Re.requestApproved?"fas fa-check-double":"fas fa-check"])},null,2),(0,i.eW)(" "+(0,i.v_)(Re.isProcessing?"Approving...":Re.requestApproved?"Request Approved":Re.issuingAssessmentSaved?"Approve Request":"Save Assessment First"),1)],10,xe),(0,i.Lk)("button",{onClick:s[13]||(s[13]=(...e)=>Ce.rejectRequest&&Ce.rejectRequest(...e)),disabled:!Ce.canTakeAction||Re.isProcessing||Ce.requestRejected,class:(0,i.C4)(["flex-1 py-2 px-3 rounded-lg font-semibold transition-all duration-300 flex items-center justify-center gap-2 text-sm",Ce.requestRejected?"bg-gray-600 text-white shadow-lg border-2 border-gray-400":Ce.canTakeAction&&!Re.isProcessing?"bg-gradient-to-r from-red-600 to-red-700 text-white shadow-lg hover:from-red-700 hover:to-red-800 border-2 border-red-500/50 hover:border-red-400":"bg-gray-600 text-gray-300 cursor-not-allowed opacity-50"]),title:"Reject this device borrowing request"},[(0,i.Lk)("i",{class:(0,i.C4)(["text-xs",Re.isProcessing?"fas fa-spinner fa-spin":Ce.requestRejected?"fas fa-times-circle":"fas fa-times"])},null,2),(0,i.eW)(" "+(0,i.v_)(Re.isProcessing?"Rejecting...":Ce.requestRejected?"Request Rejected":"Reject Request"),1)],10,ke)])):(0,i.Q3)("",!0),Ce.showReceivingButton?((0,i.uX)(),(0,i.CE)("button",{key:2,onClick:s[14]||(s[14]=(...e)=>Ce.receiveDeviceNow&&Ce.receiveDeviceNow(...e)),disabled:!Ce.canReceiveDevice,class:"flex-1 group relative overflow-hidden px-6 py-3 bg-gradient-to-r from-green-600 via-green-700 to-green-800 text-white rounded-xl font-semibold text-lg transition-all duration-300 hover:shadow-xl hover:shadow-green-500/40 border border-white/10 disabled:opacity-50 disabled:cursor-not-allowed"},[s[55]||(s[55]=(0,i.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-green-700 via-green-800 to-green-900 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),(0,i.Lk)("div",ye,[s[53]||(s[53]=(0,i.Lk)("div",{class:"flex items-center justify-center w-8 h-8 bg-white/20 rounded-full group-hover:bg-white/30 transition-colors duration-300"},[(0,i.Lk)("i",{class:"fas fa-check-circle text-xl"})],-1)),(0,i.Lk)("div",_e,[s[52]||(s[52]=(0,i.Lk)("span",{class:"text-sm opacity-95 tracking-wide"},"Final Action",-1)),(0,i.Lk)("span",qe,(0,i.v_)(Re.isProcessingAssessment?"Processing...":"Receive Now"),1)])]),Re.deviceReceived?((0,i.uX)(),(0,i.CE)("div",Le,[...s[54]||(s[54]=[(0,i.Lk)("div",{class:"w-3 h-3 bg-green-400 rounded-full animate-pulse"},null,-1)])])):(0,i.Q3)("",!0),s[56]||(s[56]=(0,i.Lk)("div",{class:"absolute inset-0 -skew-x-12 bg-gradient-to-r from-transparent via-white/10 to-transparent opacity-0 group-hover:opacity-100 group-hover:animate-shimmer"},null,-1))],8,we)):(0,i.Q3)("",!0)])])])):(0,i.Q3)("",!0),(0,i.bF)(De)])])])])]),(0,i.bF)(Pe,{isVisible:Re.showApprovalModal,requestData:{request_id:Re.request.request_id||`REQ-${String(Re.request.id).padStart(6,"0")}`,borrower:Re.request.borrower_name||"Unknown",device:Re.request.device_name||Ce.getDeviceDisplayName(Re.request.device_type,Re.request.custom_device,Re.request.device_inventory_ids||Re.request._raw?.device_inventory_ids),return_time:Re.request.return_time||Re.request.returnTime},onConfirm:Ce.confirmApproveRequest,onCancel:s[15]||(s[15]=()=>Re.showApprovalModal=!1)},null,8,["isVisible","requestData","onConfirm"]),(0,i.bF)(je,{isVisible:Re.showPostIssuingModal&&!Re.requestApproved,requestData:{request_id:Re.request.request_id||`REQ-${String(Re.request.id).padStart(6,"0")}`,device:Re.request.device_name||Ce.getDeviceDisplayName(Re.request.device_type,Re.request.custom_device,Re.request.device_inventory_ids||Re.request._raw?.device_inventory_ids)},onApprove:s[16]||(s[16]=()=>{Re.showPostIssuingModal=!1,Ce.approveRequest()}),onReject:s[17]||(s[17]=()=>{Re.showPostIssuingModal=!1,Re.showRejectModal=!0}),onClose:s[18]||(s[18]=()=>Re.showPostIssuingModal=!1)},null,8,["isVisible","requestData"]),(0,i.bF)(Me,{isVisible:Re.showRejectModal,defaultNotes:Re.rejectNotes,onConfirm:Ce.confirmReject,onCancel:s[19]||(s[19]=()=>Re.showRejectModal=!1)},null,8,["isVisible","defaultNotes","onConfirm"]),(0,i.bF)(Te,{isVisible:Re.showReceiveModal,requestData:{request_id:Re.request.request_id||`REQ-${String(Re.request.id).padStart(6,"0")}`,device:Re.request.device_name||Ce.getDeviceDisplayName(Re.request.device_type,Re.request.custom_device,Re.request.device_inventory_ids||Re.request._raw?.device_inventory_ids)},onConfirm:Ce.confirmReceive,onCancel:s[20]||(s[20]=()=>Re.showReceiveModal=!1)},null,8,["isVisible","requestData","onConfirm"])])}t(4114);var Re=t(5498),Ce=t(8966),Se=t(9101),Ie=t(1445);const Ee={class:"pointer-events-none absolute inset-0 opacity-10"},De={class:"absolute inset-0"},Pe={class:"relative z-10 p-6 space-y-4"},je={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 bg-blue-800/20 border border-blue-400/30 rounded-xl p-4"},Me={class:"flex items-center justify-between"},Te={class:"text-white text-2xl font-mono font-bold"},Ne={class:"flex items-center justify-between"},Fe={class:"text-white text-xl font-medium truncate max-w-[60%] text-right"},Oe={class:"flex items-center justify-between"},Be={class:"text-white text-xl font-medium truncate max-w-[60%] text-right"},$e={class:"flex items-center justify-between"},Ue={class:"text-blue-100 text-xl font-medium"},ze={class:"relative z-10 p-6 pt-4 border-t border-blue-400/20 flex gap-3"};function Ve(e,s,t,a,r,o){return t.isVisible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:s[3]||(s[3]=(0,i.D$)(s=>e.$emit("cancel"),["self"]))},[(0,i.Lk)("div",{class:"relative bg-blue-900 rounded-2xl shadow-2xl max-w-3xl w-full border border-blue-400/30 overflow-hidden animate-[modalEnter_.25s_ease-out]",onClick:s[2]||(s[2]=(0,i.D$)(()=>{},["stop"]))},[(0,i.Lk)("div",Ee,[(0,i.Lk)("div",De,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(18,e=>(0,i.Lk)("div",{key:e,class:"absolute text-white animate-float",style:(0,i.Tr)({left:100*Math.random()+"%",top:100*Math.random()+"%",fontSize:14*Math.random()+8+"px",animationDelay:2*Math.random()+"s",opacity:.15})},[(0,i.Lk)("i",{class:(0,i.C4)(["fas",["fa-check","fa-shield-check","fa-badge-check","fa-circle-check"][Math.floor(4*Math.random())]])},null,2)],4)),64))])]),s[11]||(s[11]=(0,i.Fv)('<div class="relative z-10 p-6 pb-4 border-b border-blue-400/20" data-v-907c3df2><div class="flex items-center gap-4" data-v-907c3df2><div class="w-16 h-16 rounded-xl bg-blue-600 flex items-center justify-center shadow-lg border border-blue-300/50" data-v-907c3df2><i class="fas fa-check text-white text-xl" data-v-907c3df2></i></div><div class="flex-1" data-v-907c3df2><h3 class="text-4xl font-extrabold text-white tracking-wide" data-v-907c3df2>Approve Request?</h3><p class="text-blue-200 text-xl" data-v-907c3df2>Please review the details before confirming.</p></div></div></div>',1)),(0,i.Lk)("div",Pe,[(0,i.Lk)("div",je,[(0,i.Lk)("div",Me,[s[4]||(s[4]=(0,i.Lk)("span",{class:"text-blue-200 text-xl font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-hashtag mr-2 text-blue-300 text-xl"}),(0,i.eW)(" Request ")],-1)),(0,i.Lk)("span",Te,(0,i.v_)(t.requestData.request_id),1)]),(0,i.Lk)("div",Ne,[s[5]||(s[5]=(0,i.Lk)("span",{class:"text-blue-200 text-xl font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-user mr-2 text-blue-300 text-xl"}),(0,i.eW)(" Borrower ")],-1)),(0,i.Lk)("span",Fe,(0,i.v_)(t.requestData.borrower),1)]),(0,i.Lk)("div",Oe,[s[6]||(s[6]=(0,i.Lk)("span",{class:"text-blue-200 text-xl font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-laptop mr-2 text-blue-300 text-xl"}),(0,i.eW)(" Device ")],-1)),(0,i.Lk)("span",Be,(0,i.v_)(t.requestData.device),1)]),(0,i.Lk)("div",$e,[s[7]||(s[7]=(0,i.Lk)("span",{class:"text-blue-200 text-xl font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-clock mr-2 text-blue-300 text-xl"}),(0,i.eW)(" Return ")],-1)),(0,i.Lk)("span",Ue,(0,i.v_)(t.requestData.return_time||"â€”"),1)])]),s[8]||(s[8]=(0,i.Lk)("div",{class:"flex items-start gap-3 bg-blue-500/10 border border-blue-400/30 rounded-xl p-4"},[(0,i.Lk)("div",{class:"w-5 h-5 rounded-full bg-blue-500/20 flex items-center justify-center mt-0.5"},[(0,i.Lk)("i",{class:"fas fa-info text-blue-400 text-xs"})]),(0,i.Lk)("p",{class:"text-blue-100 text-xl"}," Approval will notify the requester and move this booking to the issuing/receiving workflow. ")],-1))]),(0,i.Lk)("div",ze,[(0,i.Lk)("button",{class:"flex-1 px-5 py-4 bg-white/5 hover:bg-white/10 text-blue-100 border border-white/10 rounded-xl transition-all duration-300",onClick:s[0]||(s[0]=s=>e.$emit("cancel"))},[...s[9]||(s[9]=[(0,i.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,i.eW)("Cancel ",-1)])]),(0,i.Lk)("button",{class:"flex-1 px-5 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300",onClick:s[1]||(s[1]=s=>e.$emit("confirm"))},[...s[10]||(s[10]=[(0,i.Lk)("i",{class:"fas fa-check mr-2"},null,-1),(0,i.eW)("Approve Now ",-1)])])])])])):(0,i.Q3)("",!0)}var We={name:"ApprovalConfirmationModal",props:{isVisible:{type:Boolean,default:!1},requestData:{type:Object,default:()=>({request_id:"REQ-000000",borrower:"Unknown",device:"Device",return_time:null})}}},Xe=t(1241);const Qe=(0,Xe.A)(We,[["render",Ve],["__scopeId","data-v-907c3df2"]]);var He=Qe;const Ye={class:"pointer-events-none absolute inset-0 opacity-10"},Ge={class:"absolute inset-0"},Ke={class:"relative z-10 p-6 space-y-4"},Je={class:"grid grid-cols-1 sm:grid-cols-2 gap-3 border border-blue-400/30 rounded-xl p-4"},Ze={class:"flex items-center justify-between"},es={class:"text-white font-mono font-bold"},ss={class:"flex items-center justify-between"},ts={class:"text-white font-medium truncate max-w-[60%] text-right"},is={class:"relative z-10 p-6 pt-4 border-t border-blue-400/20 grid grid-cols-1 sm:grid-cols-2 gap-3"};function as(e,s,t,a,r,o){return t.isVisible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:s[3]||(s[3]=(0,i.D$)(s=>e.$emit("close"),["self"]))},[(0,i.Lk)("div",{class:"relative bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 rounded-2xl shadow-2xl max-w-xl w-full border border-blue-400/30 overflow-hidden animate-[modalEnter_.25s_ease-out]",onClick:s[2]||(s[2]=(0,i.D$)(()=>{},["stop"]))},[(0,i.Lk)("div",Ye,[(0,i.Lk)("div",Ge,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(14,e=>(0,i.Lk)("div",{key:e,class:"absolute text-white animate-float",style:(0,i.Tr)({left:100*Math.random()+"%",top:100*Math.random()+"%",fontSize:14*Math.random()+8+"px",animationDelay:2*Math.random()+"s",opacity:.12})},[(0,i.Lk)("i",{class:(0,i.C4)(["fas",["fa-clipboard-check","fa-laptop","fa-check","fa-shield-alt"][Math.floor(4*Math.random())]])},null,2)],4)),64))])]),s[9]||(s[9]=(0,i.Fv)('<div class="relative z-10 p-6 pb-4 border-b border-blue-400/20" data-v-cd990312><div class="flex items-center gap-4" data-v-cd990312><div class="w-14 h-14 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center shadow-lg border border-blue-300/50" data-v-cd990312><i class="fas fa-clipboard-check text-white text-xl" data-v-cd990312></i></div><div class="flex-1" data-v-cd990312><h3 class="text-2xl font-extrabold text-white tracking-wide" data-v-cd990312>Issuing Saved</h3><p class="text-blue-200 text-sm" data-v-cd990312>Proceed to approval to continue the workflow.</p></div></div></div>',1)),(0,i.Lk)("div",Ke,[(0,i.Lk)("div",Je,[(0,i.Lk)("div",Ze,[s[4]||(s[4]=(0,i.Lk)("span",{class:"text-blue-200 text-sm font-medium flex items-center"},[(0,i.Lk)("i",{class:"fas fa-hashtag mr-2 text-blue-300"}),(0,i.eW)("Request")],-1)),(0,i.Lk)("span",es,(0,i.v_)(t.requestData.request_id),1)]),(0,i.Lk)("div",ss,[s[5]||(s[5]=(0,i.Lk)("span",{class:"text-blue-200 text-sm font-medium flex items-center"},[(0,i.Lk)("i",{class:"fas fa-laptop mr-2 text-blue-300"}),(0,i.eW)("Device")],-1)),(0,i.Lk)("span",ts,(0,i.v_)(t.requestData.device),1)])]),s[6]||(s[6]=(0,i.Lk)("div",{class:"flex items-start gap-3 border border-blue-400/30 rounded-xl p-4"},[(0,i.Lk)("div",{class:"w-5 h-5 rounded-full bg-blue-500/20 flex items-center justify-center mt-0.5"},[(0,i.Lk)("i",{class:"fas fa-info text-blue-300 text-xs"})]),(0,i.Lk)("p",{class:"text-blue-100 text-sm"}," You can approve or reject this request now. Approval will notify the requester and mark the device as in use. ")],-1))]),(0,i.Lk)("div",is,[(0,i.Lk)("button",{class:"px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 order-2 sm:order-1",onClick:s[0]||(s[0]=s=>e.$emit("reject"))},[...s[7]||(s[7]=[(0,i.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,i.eW)("Reject Request ",-1)])]),(0,i.Lk)("button",{class:"px-4 py-3 bg-gradient-to-r from-emerald-600 to-green-700 hover:from-emerald-700 hover:to-green-800 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 order-1 sm:order-2",onClick:s[1]||(s[1]=s=>e.$emit("approve"))},[...s[8]||(s[8]=[(0,i.Lk)("i",{class:"fas fa-check mr-2"},null,-1),(0,i.eW)("Approve Request ",-1)])])])])])):(0,i.Q3)("",!0)}var rs={name:"PostIssuingActionModal",props:{isVisible:{type:Boolean,default:!1},requestData:{type:Object,default:()=>({request_id:"REQ-000000",device:"Device"})}}};const os=(0,Xe.A)(rs,[["render",as],["__scopeId","data-v-cd990312"]]);var ns=os;const ls={class:"relative z-10 p-6 space-y-4"},ds={class:"bg-red-800/20 border border-red-400/30 rounded-xl p-4"},cs={key:0,class:"text-red-300 text-xs mt-2"},us={class:"relative z-10 p-6 pt-4 border-t border-red-400/20 flex gap-3"};function vs(e,s,t,a,r,o){return t.isVisible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:s[4]||(s[4]=(0,i.D$)(s=>e.$emit("cancel"),["self"]))},[(0,i.Lk)("div",{class:"relative bg-gradient-to-br from-red-900 via-rose-900 to-red-800 rounded-2xl shadow-2xl max-w-lg w-full border border-red-400/30 overflow-hidden animate-[modalEnter_.25s_ease-out]",onClick:s[3]||(s[3]=(0,i.D$)(()=>{},["stop"]))},[s[8]||(s[8]=(0,i.Fv)('<div class="relative z-10 p-6 pb-4 border-b border-red-400/20" data-v-5b2c3eb4><div class="flex items-center gap-4" data-v-5b2c3eb4><div class="w-14 h-14 rounded-xl bg-gradient-to-br from-red-600 to-rose-600 flex items-center justify-center shadow-lg border border-red-300/50" data-v-5b2c3eb4><i class="fas fa-times text-white text-xl" data-v-5b2c3eb4></i></div><div class="flex-1" data-v-5b2c3eb4><h3 class="text-2xl font-extrabold text-white tracking-wide" data-v-5b2c3eb4>Reject Request</h3><p class="text-red-200 text-sm" data-v-5b2c3eb4>Provide a reason and confirm rejection.</p></div></div></div>',1)),(0,i.Lk)("div",ls,[(0,i.Lk)("div",ds,[s[5]||(s[5]=(0,i.Lk)("label",{class:"block text-red-100 text-sm font-semibold mb-2"},"Rejection Reason",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[0]||(s[0]=e=>r.notesLocal=e),rows:"3",class:"w-full px-3 py-2 bg-red-900/30 border-2 border-red-600/40 rounded-xl text-white placeholder-red-300 resize-none focus:outline-none focus:border-red-400 focus:shadow-lg focus:shadow-red-500/20 transition-all duration-300",placeholder:"Explain why this request is being rejected..."},null,512),[[i.Jo,r.notesLocal]]),r.showError?((0,i.uX)(),(0,i.CE)("p",cs,"Rejection reason is required.")):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",us,[(0,i.Lk)("button",{class:"flex-1 px-4 py-3 bg-white/10 hover:bg-white/15 text-red-100 border border-white/10 rounded-xl transition-all duration-300",onClick:s[1]||(s[1]=s=>e.$emit("cancel"))},[...s[6]||(s[6]=[(0,i.Lk)("i",{class:"fas fa-arrow-left mr-2"},null,-1),(0,i.eW)("Cancel ",-1)])]),(0,i.Lk)("button",{class:"flex-1 px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300",onClick:s[2]||(s[2]=(...e)=>o.confirm&&o.confirm(...e))},[...s[7]||(s[7]=[(0,i.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,i.eW)("Reject Request ",-1)])])])])])):(0,i.Q3)("",!0)}var ps={name:"RejectRequestModal",props:{isVisible:{type:Boolean,default:!1},defaultNotes:{type:String,default:""}},emits:["confirm","cancel"],data(){return{notesLocal:this.defaultNotes,showError:!1}},watch:{defaultNotes(e){this.notesLocal=e}},methods:{confirm(){this.notesLocal&&this.notesLocal.trim()?(this.showError=!1,this.$emit("confirm",this.notesLocal.trim())):this.showError=!0}}};const ms=(0,Xe.A)(ps,[["render",vs],["__scopeId","data-v-5b2c3eb4"]]);var bs=ms;const hs={class:"relative z-10 p-8 space-y-5"},gs={class:"grid grid-cols-1 gap-4 bg-blue-800/20 border border-blue-400/30 rounded-xl p-6 min-h-[220px]"},fs={class:"flex items-center justify-between"},xs={class:"text-white font-mono font-bold text-2xl"},ks={class:"flex items-center justify-between"},ws={class:"text-white font-semibold truncate max-w-[60%] text-right text-2xl"},ys={class:"relative z-10 p-8 pt-6 border-t border-blue-400/20 flex gap-5"};function _s(e,s,t,a,r,o){return t.isVisible?((0,i.uX)(),(0,i.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:s[3]||(s[3]=(0,i.D$)(s=>e.$emit("cancel"),["self"]))},[(0,i.Lk)("div",{class:"relative bg-blue-900 rounded-2xl shadow-2xl max-w-2xl w-full min-h-[440px] border border-blue-400/30 overflow-hidden animate-[modalEnter_.25s_ease-out]",onClick:s[2]||(s[2]=(0,i.D$)(()=>{},["stop"]))},[s[9]||(s[9]=(0,i.Fv)('<div class="relative z-10 p-8 pb-6 border-b border-blue-400/20" data-v-74cb4d5e><div class="flex items-center gap-4" data-v-74cb4d5e><div class="w-14 h-14 rounded-xl bg-gradient-to-br from-emerald-600 to-green-700 flex items-center justify-center shadow-lg border border-emerald-300/50" data-v-74cb4d5e><i class="fas fa-undo text-white text-xl" data-v-74cb4d5e></i></div><div class="flex-1" data-v-74cb4d5e><h3 class="text-4xl font-extrabold text-white tracking-wide" data-v-74cb4d5e>Receive Device?</h3><p class="text-blue-200 text-lg" data-v-74cb4d5e>Confirm to complete this request.</p></div></div></div>',1)),(0,i.Lk)("div",hs,[(0,i.Lk)("div",gs,[(0,i.Lk)("div",fs,[s[4]||(s[4]=(0,i.Lk)("span",{class:"text-blue-200 text-lg font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-hashtag mr-2 text-blue-300"}),(0,i.eW)("Request")],-1)),(0,i.Lk)("span",xs,(0,i.v_)(t.requestData.request_id),1)]),(0,i.Lk)("div",ks,[s[5]||(s[5]=(0,i.Lk)("span",{class:"text-blue-200 text-lg font-semibold flex items-center"},[(0,i.Lk)("i",{class:"fas fa-laptop mr-2 text-blue-300"}),(0,i.eW)("Device")],-1)),(0,i.Lk)("span",ws,(0,i.v_)(t.requestData.device),1)]),s[6]||(s[6]=(0,i.Lk)("div",{class:"text-blue-100 text-lg"}," This will mark the booking as returned (or compromised based on assessment) and update inventory. ",-1))])]),(0,i.Lk)("div",ys,[(0,i.Lk)("button",{class:"flex-1 px-6 py-4 bg-white/10 hover:bg-white/15 text-blue-100 border border-white/10 rounded-xl transition-all duration-300 text-lg",onClick:s[0]||(s[0]=s=>e.$emit("cancel"))},[...s[7]||(s[7]=[(0,i.Lk)("i",{class:"fas fa-arrow-left mr-2"},null,-1),(0,i.eW)("Cancel ",-1)])]),(0,i.Lk)("button",{class:"flex-1 px-6 py-4 bg-gradient-to-r from-emerald-600 to-green-700 hover:from-emerald-700 hover:to-green-800 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 text-lg",onClick:s[1]||(s[1]=s=>e.$emit("confirm"))},[...s[8]||(s[8]=[(0,i.Lk)("i",{class:"fas fa-check mr-2"},null,-1),(0,i.eW)("Confirm Receive ",-1)])])])])])):(0,i.Q3)("",!0)}var qs={name:"ReceiveConfirmationModal",props:{isVisible:{type:Boolean,default:!1},requestData:{type:Object,default:()=>({request_id:"REQ-000000",device:"Device"})}}};const Ls=(0,Xe.A)(qs,[["render",_s],["__scopeId","data-v-74cb4d5e"]]);var As=Ls,Rs=t(4466),Cs=t(274),Ss=t(4710),Is={name:"RequestDetails",components:{Header:Re.A,ModernSidebar:Ce.A,AppFooter:Se.A,UnifiedLoadingBanner:Ie.A,ApprovalConfirmationModal:He,PostIssuingActionModal:ns,RejectRequestModal:bs,ReceiveConfirmationModal:As},data(){return{listRouteBase:"undefined"!==typeof window&&window.location.pathname.startsWith("/secretary-approval/")?"/secretary-approval/requests":"/ict-approval/requests",request:{},isLoading:!1,isProcessing:!1,loadError:null,assessmentType:"issuing",issuingAssessment:{physical_condition:"",functionality:"",accessories_complete:!1,visible_damage:!1,damage_description:"",notes:""},receivingAssessment:{physical_condition:"",functionality:"",accessories_complete:!1,visible_damage:!1,damage_description:"",notes:""},issuingAssessmentNotes:"",receivingAssessmentNotes:"",isProcessingAssessment:!1,issuingAssessmentSaved:!1,receivingAssessmentSaved:!1,assessmentMessage:null,deviceIssued:!1,deviceReceived:!1,requestApproved:!1,showApprovalModal:!1,showPostIssuingModal:!1,showRejectModal:!1,rejectNotes:"",showReceiveModal:!1,physicalConditions:[{value:"excellent",label:"Excellent",icon:"fas fa-star",color:"green-400",description:"Like new, no visible wear or damage"},{value:"good",label:"Good",icon:"fas fa-thumbs-up",color:"blue-400",description:"Minor wear, fully functional appearance"},{value:"fair",label:"Fair",icon:"fas fa-exclamation",color:"yellow-400",description:"Noticeable wear but still acceptable"},{value:"poor",label:"Poor",icon:"fas fa-times",color:"red-400",description:"Significant wear, damage, or deterioration"}],functionalityOptions:[{value:"fully_functional",label:"Fully Functional",icon:"fas fa-check-circle",color:"green-400",description:"All features work perfectly as expected"},{value:"partially_functional",label:"Partially Functional",icon:"fas fa-exclamation-circle",color:"yellow-400",description:"Some features work, others may have issues"},{value:"not_functional",label:"Not Functional",icon:"fas fa-times-circle",color:"red-400",description:"Device does not work or has major failures"}]}},computed:{canTakeAction(){if(!this.request||!this.request.id)return!1;const e="pending"===this.request.ict_approve||"pending"===this.request.ict_status||"pending"===this.request.status||!this.request.ict_approve&&!this.request.ict_status;return this.request.id,this.request.ict_approve,this.request.ict_status,this.request.status,e},requestRejected(){return"rejected"===this.request.ict_approve||"rejected"===this.request.ict_status},currentAssessment(){return"issuing"===this.assessmentType?this.issuingAssessment:this.receivingAssessment},isReadOnly(){const e=(this.request?.status||"").toLowerCase(),s=(this.request?.return_status||"").toLowerCase(),t=["returned","completed","complete","closed","done","finished"],i=["returned","returned_but_compromised"];return this.deviceReceived||t.includes(e)||i.includes(s)||!!this.request?.device_received_at||this.requestRejected},currentAssessmentNotes:{get(){return"issuing"===this.assessmentType?this.issuingAssessmentNotes:this.receivingAssessmentNotes},set(e){"issuing"===this.assessmentType?this.issuingAssessmentNotes=e:this.receivingAssessmentNotes=e}},isIssuingAssessmentComplete(){const e=this.issuingAssessment,s=e.physical_condition&&e.functionality,t=!e.visible_damage||e.damage_description?.trim();return s&&t},finalAssessment(){return this.receivingAssessmentSaved?this.receivingAssessment:this.issuingAssessment},selectedPhysical(){return this.isReadOnly?this.finalAssessment?.physical_condition||"":this.currentAssessment.physical_condition},selectedFunctionality(){return this.isReadOnly?this.finalAssessment?.functionality||"":this.currentAssessment.functionality},isReceivingAssessmentComplete(){const e=this.receivingAssessment,s=e.physical_condition&&e.functionality,t=!e.visible_damage||e.damage_description?.trim();return s&&t},canApproveRequest(){const e=this.canTakeAction&&this.issuingAssessmentSaved&&!this.requestApproved&&!this.isProcessing&&!this.isReadOnly;return this.canTakeAction,this.issuingAssessmentSaved,this.requestApproved,this.isProcessing,e},canSaveIssuingAssessment(){const e="pending"===this.request.ict_approve||"pending"===this.request.ict_status||!this.request.ict_approve&&!this.request.ict_status,s=!1!==this.request.device_available,t=this.isIssuingAssessmentComplete&&!this.issuingAssessmentSaved&&!this.deviceIssued&&e&&s&&!this.isProcessingAssessment&&!this.isReadOnly;return this.isIssuingAssessmentComplete,this.issuingAssessmentSaved,this.isProcessingAssessment,this.request.ict_approve,this.request.ict_status,this.request.status,t},canReceiveDevice(){const e=this.isReceivingAssessmentComplete&&this.requestApproved&&!this.deviceReceived&&!this.isProcessingAssessment&&!this.isReadOnly;return this.isReceivingAssessmentComplete,this.requestApproved,this.deviceReceived,this.isProcessingAssessment,e},showIssuingAssessmentButton(){return"issuing"===this.assessmentType&&!this.deviceReceived&&!this.isReadOnly},showApprovalButton(){const e=this.canTakeAction&&!this.requestApproved&&!this.requestRejected&&"issuing"===this.assessmentType&&!this.isReadOnly,s=this.canTakeAction&&!this.requestApproved&&!this.requestRejected&&"receiving"===this.assessmentType&&this.issuingAssessmentSaved&&!this.isReadOnly,t=e||s;return this.canTakeAction,this.requestApproved,this.requestRejected,this.assessmentType,this.issuingAssessmentSaved,t},showReceivingButton(){return"receiving"===this.assessmentType&&this.requestApproved&&!this.deviceReceived&&!this.isReadOnly},issuingAssessmentButtonState(){const e="pending"===this.request.ict_approve||"pending"===this.request.ict_status||!this.request.ict_approve&&!this.request.ict_status;if(this.isReadOnly)return{enabled:!1,text:"Request Completed (Read-only)",icon:"fas fa-lock",classes:"bg-gray-700 text-gray-300 cursor-not-allowed opacity-60",tooltip:"This request has been completed. Actions are disabled."};if(!1===this.request.device_available)return{enabled:!1,text:"Device Unavailable",icon:"fas fa-ban",classes:"bg-gray-700 text-gray-300 cursor-not-allowed opacity-60",tooltip:"This device is no longer available. Please choose another request."};if(this.deviceIssued&&!this.issuingAssessmentSaved)return{enabled:!1,text:"Already Issued - Proceed to Receiving",icon:"fas fa-check-double",classes:"bg-blue-600 text-white shadow-lg cursor-not-allowed opacity-80",tooltip:"This device was already issued earlier. Switch to Device Receiving to continue."};if(this.issuingAssessmentSaved)return{enabled:!1,text:"Issuing Assessment Saved",icon:"fas fa-check",classes:"bg-gray-700 text-gray-300 cursor-not-allowed opacity-70 border border-gray-500/60",tooltip:"Issuing assessment has been saved. Use the Approve/Reject buttons below to continue."};if(!e){const e=this.request.ict_approve||this.request.ict_status||this.request.status;return{enabled:!1,text:`Cannot Issue (${e||"Unknown"} Status)`,icon:"fas fa-lock",classes:"bg-gray-700 text-gray-400 cursor-not-allowed opacity-60",tooltip:`Device can only be issued for pending requests. Current status: ${e||"Unknown"}`}}return this.isIssuingAssessmentComplete?this.isProcessingAssessment?{enabled:!1,text:"Saving...",icon:"fas fa-spinner fa-spin",classes:"bg-blue-600 text-white opacity-75",tooltip:"Processing assessment..."}:{enabled:!0,text:"Save Issuing Assessment",icon:"fas fa-save",classes:"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg hover:from-blue-700 hover:to-blue-800",tooltip:"Save device condition assessment and issue device"}:{enabled:!1,text:"Complete Assessment First",icon:"fas fa-exclamation-triangle",classes:"bg-yellow-700 text-yellow-200 cursor-not-allowed opacity-60",tooltip:"Please fill in all required assessment fields"}},currentStatusText(){return this.deviceReceived?"returned_but_compromised"===this.request.return_status?"Received (Compromised)":"Received":this.requestApproved?"Approved":this.getStatusText(this.request.ict_approve||this.request.status)}},async mounted(){this.$route.params.id,this.$route;const e=String(this.$route.params.id||"").trim(),s=/^\d+$/.test(e);if(!s||parseInt(e,10)<=0)return console.error("âŒ Invalid route ID:",e),this.loadError="Invalid request ID in the URL.",void(this.isLoading=!1);try{await this.fetchRequestDetails()}catch(t){console.error("âŒ Error in mounted hook:",t),this.isLoading=!1}},methods:{async fetchRequestDetails(){this.isLoading=!0,this.loadError=null;try{const e=this.$route.params.id;if(!e||":id"===e||!/^\d+$/.test(String(e)))throw new Error("Invalid request ID: "+e);const s=await Rs.A.getRequestDetails(e);if(!s.success)return console.error("âŒ Failed to load request details:",s),void(404===s.status?this.loadError="Request not found. It may have been deleted or the ID is incorrect.":400===s.status?this.loadError=s.message||"Invalid request ID.":this.loadError=s.message||"Failed to load request details.");this.request=s.data,this.initializeWorkflowState(),this.request,this.request.id,this.request.status,this.request.ict_approve,this.request.ict_status,this.canTakeAction,this.deviceIssued,this.deviceReceived,this.requestApproved}catch(e){console.error("âŒ Error fetching request details:",e);const s=e?.response?.status;404===s?this.loadError="Request not found. It may have been deleted or the ID is incorrect.":/Invalid request ID/i.test(e?.message)?this.loadError="Invalid request ID in the URL.":this.loadError=e?.response?.data?.message||"Failed to load request details."}finally{this.isLoading=!1}},initializeWorkflowState(){this.requestApproved="approved"===this.request.ict_approve||"approved"===this.request.status,this.deviceIssued=!(!this.request.device_issued_at&&!this.request.device_condition_issuing&&"in_use"!==this.request.status);const e=["returned","returned_but_compromised"];this.deviceReceived=!!(this.request.device_received_at||this.request.device_condition_receiving||e.includes((this.request.return_status||"").toLowerCase())||"returned"===this.request.status||/completed|complete|closed|done|finished/i.test(this.request.status||"")),this.issuingAssessmentSaved=!(!this.request.device_condition_issuing&&!this.deviceIssued),this.receivingAssessmentSaved=!!this.request.device_condition_receiving,this.requestApproved,this.deviceIssued,this.deviceReceived,this.issuingAssessmentSaved,this.receivingAssessmentSaved,this.loadAssessmentsFromRequest(),this.requestApproved&&!this.deviceReceived&&(this.assessmentType="receiving"),this.isReadOnly&&this.receivingAssessmentSaved&&(this.assessmentType="receiving")},async approveRequest(){this.canApproveRequest?this.showApprovalModal=!0:this.showAssessmentMessage("Cannot approve: request is not pending or assessment not saved.","error")},async confirmApproveRequest(){this.isProcessing=!0;try{const e=this.$route.params.id,s=await Rs.A.approveRequest(e,"");if(!s.success)throw new Error(s.message||"Failed to approve request");this.showAssessmentMessage("Device borrowing request approved successfully!","success"),this.request.ict_approve="approved",this.requestApproved=!0,this.deviceIssued=!0,s.data&&(this.request={...this.request,...s.data}),this.requestApproved,this.deviceIssued,this.showApprovalModal=!1,this.$router.push(this.listRouteBase)}catch(e){console.error("Error approving request:",e);const t=e?.response?.status,i=e?.response?.data?.message||e?.message||"";if(403===t)this.showAssessmentMessage("You do not have permission to approve device bookings. Please contact an administrator.","error");else if(400===t&&/pending ICT/i.test(i)){this.showAssessmentMessage("Approval allowed only for pending ICT requests. Refreshing requestâ€¦","error");try{await this.fetchRequestDetails()}catch(s){console.warn("Refresh after approval constraint failed:",s)}this.showApprovalModal=!1,this.showPostIssuingModal=!1}else this.showAssessmentMessage("Error approving request: "+(i||"Please try again"),"error")}finally{this.isProcessing=!1}},async rejectRequest(){this.rejectNotes="",this.showRejectModal=!0},async confirmReject(e){this.showRejectModal=!1,this.isProcessing=!0;try{const s=this.$route.params.id,t=await Rs.A.rejectRequest(s,e.trim());if(!t.success)throw new Error(t.message||"Failed to reject request");this.showAssessmentMessage("Device borrowing request rejected successfully!","success"),this.request.ict_approve="rejected",t.data&&(this.request={...this.request,...t.data}),this.request.id,this.$router.push(this.listRouteBase)}catch(s){console.error("Error rejecting request:",s),alert("Error rejecting request: "+(s.message||"Please try again"))}finally{this.isProcessing=!1}},goBack(){this.$router.push(this.listRouteBase)},getDeviceDisplayName(e,s,t=[]){return Rs.A.getDeviceDisplayName(e,s,t)},formatDate(e){return Rs.A.formatDate(e)},getStatusIcon(e){return"received"===e?"fas fa-check-double text-green-400":"returned_but_compromised"===e?"fas fa-exclamation-triangle text-yellow-400":Rs.A.getStatusIcon(e)},getStatusText(e){return Rs.A.getStatusText(e)},getStatusTextColor(e){switch(e){case"pending":return"text-yellow-400 font-semibold";case"approved":return"text-green-400 font-semibold";case"rejected":return"text-red-400 font-semibold";case"received":return"text-green-400 font-semibold";case"returned_but_compromised":return"text-yellow-400 font-semibold";default:return"text-white font-semibold"}},getApproveButtonTooltip(){return this.requestApproved?"This request has already been approved":this.canTakeAction?this.isProcessing?"Processing request...":this.issuingAssessmentSaved?"Approve this device borrowing request":"Please save the device issuing assessment first before approving":"This request cannot be approved - check request status"},handleImageError(e){console.warn("Image failed to load:",e.target.src),e.target.style.display="none"},getLoadingTitle(){return this.isProcessing?"Processing Request":this.isProcessingAssessment?"Saving Assessment":this.isLoading?"Loading Request Details":"Loading"},getLoadingSubtitle(){return this.isProcessing?"Applying your approval action...":this.isProcessingAssessment?"Persisting device assessment data...":this.isLoading?"Retrieving request information...":"Please wait..."},handleIssuingAssessmentAction(){this.issuingAssessmentSaved?this.requestApproved||this.approveRequest():this.saveIssuingAssessment()},async saveIssuingAssessment(){if(!this.isProcessingAssessment&&!this.issuingAssessmentSaved)if(this.isIssuingAssessmentComplete){try{const e=this.request.device_inventory_id;if(e){const s=await Cs.A.get(`/booking-service/devices/${e}/availability`),t=s.data?.data||s.data;if(!s.data?.success||!1===t?.available){const e=t?.message||"Device is currently unavailable.";return this.showAssessmentMessage(e,"error"),void(this.request.device_available=!1)}}}catch(e){console.warn("Availability precheck failed (continuing to backend):",e?.message)}this.isProcessingAssessment=!0;try{const e=this.$route.params.id,s={physical_condition:this.issuingAssessment.physical_condition,functionality:this.issuingAssessment.functionality,accessories_complete:this.issuingAssessment.accessories_complete,visible_damage:this.issuingAssessment.visible_damage,damage_description:this.issuingAssessment.visible_damage?this.issuingAssessment.damage_description:null,assessment_notes:this.issuingAssessmentNotes||null},t=await Rs.A.saveIssuingAssessment(e,s);if(!t.success)throw new Error(t.message||"Failed to save issuing assessment");this.issuingAssessmentSaved=!0,this.deviceIssued=!0,t.data&&(this.request={...this.request,...t.data}),this.assessmentMessage={type:"success",text:"Issuing assessment saved. Please approve the request to continue to Device Receiving."},this.showPostIssuingModal=this.canTakeAction}catch(s){console.error("âŒ Error saving issuing assessment:",s);const t=s?.response?.status,i=s?.response?.data?.message||s?.message||"";if(400===t&&/already been issued|issue the same device twice/i.test(i)){this.deviceIssued=!0,this.issuingAssessmentSaved=!0,this.assessmentType="receiving",this.showAssessmentMessage("Device already issued for this request. Proceed to Device Receiving.","success"),this.showPostIssuingModal=this.canTakeAction;try{await this.fetchRequestDetails()}catch(e){console.warn("Failed to refresh request details after already-issued notice:",e?.message)}}else this.showAssessmentMessage("Error saving assessment: "+(i||"Please try again"),"error")}finally{this.isProcessingAssessment=!1}}else this.showAssessmentMessage("Please complete all required assessment fields before saving.","error")},async receiveDeviceNow(){this.isProcessingAssessment||this.deviceReceived||(this.isReceivingAssessmentComplete?this.showReceiveModal=!0:alert("Please complete all required assessment fields before receiving the device."))},async confirmReceive(){this.showReceiveModal=!1,this.isProcessingAssessment=!0;try{const s=this.$route.params.id,t={physical_condition:this.receivingAssessment.physical_condition,functionality:this.receivingAssessment.functionality,accessories_complete:this.receivingAssessment.accessories_complete,visible_damage:this.receivingAssessment.visible_damage,damage_description:this.receivingAssessment.visible_damage?this.receivingAssessment.damage_description:null,assessment_notes:this.receivingAssessmentNotes||null},i=await Rs.A.saveReceivingAssessment(s,t);if(!i.success)throw new Error(i.message||"Failed to receive device");{this.deviceReceived=!0,this.receivingAssessmentSaved=!0;let s="returned",t="Device received successfully!";this.receivingAssessment.visible_damage?(s="returned_but_compromised",t="Device received with damage/issues noted."):"not_functional"===this.receivingAssessment.functionality?(s="returned_but_compromised",t="Device received but not functional."):"poor"===this.receivingAssessment.physical_condition&&(s="returned_but_compromised",t="Device received in poor condition."),this.request.status="returned",this.request.return_status=s,this.request.device_received_at=(new Date).toISOString(),i.data&&(this.request={...this.request,...i.data}),this.loadAssessmentsFromRequest(),this.showAssessmentMessage(`${t} The request has been completed and return status updated.`,"success"),this.deviceReceived=!0,this.deviceReceived;try{Ss["default"].clearCache()}catch(e){console.warn("Notification cache clear failed:",e?.message||e)}this.$router.push("/ict-approval/requests")}}catch(s){console.error("âŒ Error receiving device:",s),this.showAssessmentMessage("Error receiving device: "+(s.message||"Please try again"),"error")}finally{this.isProcessingAssessment=!1}},showAssessmentMessage(e,s){this.assessmentMessage={text:e,type:s},setTimeout(()=>{this.assessmentMessage&&this.assessmentMessage.text===e&&(this.assessmentMessage=null)},5e3)},loadAssessmentsFromRequest(){const e=e=>{if(!e)return null;if("object"===typeof e)return e;try{return JSON.parse(e)}catch(s){return null}},s=e(this.request.device_condition_issuing);s&&(this.issuingAssessment={physical_condition:s.physical_condition||this.issuingAssessment.physical_condition||"",functionality:s.functionality||this.issuingAssessment.functionality||"",accessories_complete:!!s.accessories_complete,visible_damage:!!s.visible_damage,damage_description:s.damage_description||"",notes:s.assessment_notes||s.notes||""},this.issuingAssessmentNotes=this.issuingAssessment.notes);const t=e(this.request.device_condition_receiving);t&&(this.receivingAssessment={physical_condition:t.physical_condition||this.receivingAssessment.physical_condition||"",functionality:t.functionality||this.receivingAssessment.functionality||"",accessories_complete:!!t.accessories_complete,visible_damage:!!t.visible_damage,damage_description:t.damage_description||"",notes:t.assessment_notes||t.notes||""},this.receivingAssessmentNotes=this.receivingAssessment.notes)}}};const Es=(0,Xe.A)(Is,[["render",Ae],["__scopeId","data-v-69885670"]]);var Ds=Es},4710:function(e,s,t){t.r(s);t(4603),t(7566),t(8721);var i=t(4373);const a="/api",r=i.A.create({baseURL:a,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),o=i.A.create({baseURL:a,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),n=!1,l=e=>{e.interceptors.request.use(e=>{const s=localStorage.getItem("auth_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e))};l(r),l(o);const d=e=>{e.interceptors.request.use(e=>{if(e.method&&"get"===e.method.toLowerCase())try{const s=new URL(e.url,e.baseURL);s.searchParams.set("_cb",String(Date.now())),e.url=s.pathname+s.search}catch(s){const t=(e.url||"").includes("?")?"&":"?";e.url=`${e.url}${t}_cb=${Date.now()}`}return e},e=>Promise.reject(e))};d(r),d(o);const c={data:null,timestamp:null,maxAge:15e3},u="true"===String({NODE_ENV:"production",VUE_APP_API_TIMEOUT:"30000",VUE_APP_API_URL:"/api",VUE_APP_DEBUG:"false",VUE_APP_LOG_LEVEL:"debug",VUE_APP_NAME:"Mnh Access Management System",VUE_APP_VERSION:"1.0.0",BASE_URL:"/"}.VUE_APP_ENABLE_SMS_RESEND||"false").toLowerCase(),v={isResendEnabled(){return u},async resendSmsGeneric({requestId:e,role:s=null,target:t=null,phone:i=null,channel:a="sms"}){if(!u)return{success:!1,message:"SMS resend not supported by backend; skipped"};const r=e=>{if(!e)return null;const s=String(e).trim(),t=s.startsWith("+"),i=s.replace(/[^\d]/g,"");return t?`+${i}`:i},n=i||null,l=r(n),d={request_id:e,role:s,target:t,notification_type:"generic_sms",resend_only:!0,force:!0,force_resend:!0,resend_sms:!0,send_sms:!0,notification_channel:a,phone:n||void 0,phone_number:l||void 0,recipient_phone:l||void 0,destination_phone:l||void 0,msisdn:l||void 0,contact_phone:l||void 0,requester_phone:n||void 0,requester_phone_number:n||void 0,staff_phone:n||void 0,staff_phone_number:n||void 0},c=[];let v,p;for(let u=0;u<c.length;u++)try{return v=await o.post(c[u],d),{success:!!v.data?.success,data:v.data?.data,message:v.data?.message}}catch(m){p=m;continue}return{success:!1,message:p?.response?.data?.message||p?.message||"No resend endpoints configured"}},async getPendingRequestsCount(e=!1){if(!e&&c.data&&c.timestamp){const e=Date.now()-c.timestamp;if(e<c.maxAge)return n&&Math.round(e/1e3),c.data}let s=null;const t=2;for(let a=1;a<=t;a++)try{const e=await o.get("/notifications/pending-count");if(e.data.success)return c.data=e.data.data,c.timestamp=Date.now(),e.data.data;console.error("âŒ NotificationService: Failed to load pending count:",e.data.message),s=new Error(e.data.message||"Failed to load pending requests count")}catch(i){if(a===t&&n&&console.error("âŒ NotificationService: Error fetching pending count:",i?.message||i),i.response&&(console.error("Response status:",i.response.status),console.error("Response data:",i.response.data),console.error("Response headers:",i.response.headers)),s=i,401===i.response?.status||403===i.response?.status)break;if(500===i.response?.status&&a>=2)break;a<t&&await new Promise(e=>setTimeout(e,1e3*a))}if(s){if(c.data)return console.warn("âš ï¸ NotificationService: Using stale cached data due to API failure"),c.data;n&&(console.error("ðŸš« NotificationService: All retry attempts failed"),console.error("Last error details:",{message:s.message,status:s.response?.status,data:s.response?.data})),n&&console.warn("ðŸ”„ NotificationService: Providing fallback data to prevent UI breakage");const e={total_pending:0,requires_attention:!1,details:null};return c.data=e,c.timestamp=Date.now(),e}return{total_pending:0,requires_attention:!1,details:null}},async getPendingRequestsBreakdown(){try{const e=await o.get("/notifications/breakdown");if(e.data.success)return e.data.data;throw console.error("âŒ NotificationService: Failed to load breakdown:",e.data.message),new Error(e.data.message||"Failed to load breakdown")}catch(e){console.error("âŒ NotificationService: Error fetching breakdown:",e);let s="Network error while loading breakdown";throw e.response?s=e.response.data?.message||"Failed to load breakdown":"ECONNABORTED"===e.code?s="Request timed out - server may be slow":e.message.includes("Network Error")&&(s="Network connection error"),new Error(s)}},clearCache(){c.data=null,c.timestamp=null},getRoleNotificationConfig(e){const s={head_of_department:{routePattern:"/hod-dashboard",menuItems:["/hod-dashboard/request-list"],description:"New requests awaiting HOD approval"},divisional_director:{routePattern:"/divisional-dashboard",menuItems:["/divisional-dashboard/combined-requests"],description:"HOD-approved requests awaiting divisional approval"},ict_director:{routePattern:"/dict-dashboard",menuItems:["/dict-dashboard/combined-requests"],description:"Divisional-approved requests awaiting ICT Director approval"},head_of_it:{routePattern:"/head_of_it-dashboard",menuItems:["/head_of_it-dashboard/combined-requests"],description:"ICT Director-approved requests awaiting Head of IT approval"},ict_officer:{routePattern:"/ict-dashboard",menuItems:["/ict-dashboard/access-requests"],description:"Requests requiring implementation (excludes implemented/completed)"},admin:{routePattern:"/admin-dashboard",menuItems:["/admin-dashboard","/service-users"],description:"System-wide pending requests"}};return s[e]||{routePattern:"/user-dashboard",menuItems:[],description:"No pending approval tasks"}},shouldShowNotificationForRoute(e,s){const t=this.getRoleNotificationConfig(s);return t.menuItems.includes(e)}};s["default"]=v},9101:function(e,s,t){t.d(s,{A:function(){return v}});var i=t(5796);const a={class:"bg-gradient-to-r from-blue-900 via-blue-800 to-blue-900 text-white py-4 px-6 border-t border-blue-600/40 shadow-lg backdrop-blur-sm relative",style:{position:"relative","z-index":"1","margin-top":"auto"}},r={class:"flex flex-col md:flex-row justify-between items-center"},o={class:"text-base text-blue-100 flex items-center space-x-2"},n={class:"font-medium"};function l(e,s,t,l,d,c){return(0,i.uX)(),(0,i.CE)("footer",a,[(0,i.Lk)("div",r,[(0,i.Lk)("div",o,[s[0]||(s[0]=(0,i.Lk)("div",{class:"w-6 h-6 bg-blue-600/30 rounded-full flex items-center justify-center border border-blue-500/40"},[(0,i.Lk)("i",{class:"fas fa-hospital text-blue-300 text-sm"})],-1)),(0,i.Lk)("p",n," Â© "+(0,i.v_)(c.currentYear)+" Muhimbili National Hospital. All rights reserved. ",1)])])])}var d={name:"AppFooter",computed:{currentYear(){return(new Date).getFullYear()}}},c=t(1241);const u=(0,c.A)(d,[["render",l],["__scopeId","data-v-2f68623d"]]);var v=u}}]);
//# sourceMappingURL=6530.80c70e52.js.map