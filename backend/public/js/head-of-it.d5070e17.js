"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[2461,4710],{1445:function(e,t,s){s.d(t,{A:function(){return k}});var a=s(5796);const r={key:0,class:"fixed inset-0 z-40 flex items-center justify-center pointer-events-none animate-fade-in"},i={class:"pointer-events-auto w-full max-w-lg mx-auto"},o={class:"relative bg-gradient-to-br from-white/20 via-blue-50/30 to-white/10 border-2 border-blue-300/50 backdrop-blur-xl rounded-3xl p-8 shadow-2xl overflow-hidden"},l={class:"relative z-10"},n={class:"flex items-center justify-center gap-6 mb-6"},d={class:"relative flex flex-col items-center"},c={class:"relative mb-3"},u={class:"text-center"},p={class:"text-white text-2xl font-bold tracking-wide mb-1 drop-shadow-md"},f={class:"text-blue-100 text-lg animate-pulse"},g={class:"text-center border-t border-blue-300/30 pt-4"},b={class:"text-teal-200 text-base font-semibold tracking-wider"};function m(e,t,s,m,h,x){return s.show?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",i,[(0,a.Lk)("div",o,[t[5]||(t[5]=(0,a.Fv)('<div class="absolute inset-0 opacity-10" data-v-94539b4a><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-slide-across" data-v-94539b4a></div><div class="absolute top-4 left-4 w-16 h-16 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.2);" data-v-94539b4a></div><div class="absolute bottom-4 right-4 w-20 h-20 bg-blue-400/20 rounded-full animate-float" style="animation-delay:1s;" data-v-94539b4a></div><div class="absolute top-1/2 left-8 w-12 h-12 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.15);animation-delay:2s;" data-v-94539b4a></div></div>',1)),(0,a.Lk)("div",l,[(0,a.Lk)("div",n,[t[1]||(t[1]=(0,a.Lk)("div",{class:"relative"},[(0,a.Lk)("div",{class:"w-16 h-16 bg-gradient-to-br from-blue-500/30 to-teal-500/30 rounded-2xl backdrop-blur-sm border-2 border-blue-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300"},[(0,a.Lk)("img",{src:"/assets/images/ngao2.png",alt:"National Shield",class:"max-w-12 max-h-12 object-contain drop-shadow-lg"})]),(0,a.Lk)("div",{class:"absolute -inset-1 bg-gradient-to-r from-blue-400 to-teal-400 rounded-2xl opacity-20 blur-sm animate-pulse"})],-1)),(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[t[0]||(t[0]=(0,a.Lk)("div",{class:"rounded-full h-12 w-12 border-2 border-gray-300/20"},null,-1)),(0,a.Lk)("div",{class:(0,a.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",s.forceSpin?"always-spin":"animate-spin"]),style:{"border-top-color":"#ff0000","animation-duration":"2s"}},null,2),(0,a.Lk)("div",{class:(0,a.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",s.forceSpin?"always-spin":"animate-spin"]),style:{"border-bottom-color":"#0000d1","animation-direction":"reverse","animation-duration":"1.5s"}},null,2),(0,a.Lk)("div",{class:(0,a.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",s.forceSpin?"always-spin":"animate-spin"]),style:{"border-right-color":"rgba(255, 0, 0, 0.7)","animation-duration":"2.5s"}},null,2),(0,a.Lk)("div",{class:(0,a.C4)(["absolute inset-0 rounded-full h-12 w-12 border-4 border-transparent shadow-lg",s.forceSpin?"always-spin":"animate-spin"]),style:{"border-left-color":"rgba(0, 0, 209, 0.7)","animation-direction":"reverse","animation-duration":"1.8s"}},null,2)]),(0,a.Lk)("div",u,[(0,a.Lk)("div",p,(0,a.v_)(s.loadingTitle),1),(0,a.Lk)("div",f,(0,a.v_)(s.loadingSubtitle),1)])]),t[2]||(t[2]=(0,a.Lk)("div",{class:"relative"},[(0,a.Lk)("div",{class:"w-16 h-16 bg-gradient-to-br from-teal-500/30 to-blue-500/30 rounded-2xl backdrop-blur-sm border-2 border-teal-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300"},[(0,a.Lk)("img",{src:"/assets/images/logo2.png",alt:"MNH Logo",class:"max-w-12 max-h-12 object-contain drop-shadow-lg"})]),(0,a.Lk)("div",{class:"absolute -inset-1 bg-gradient-to-r from-teal-400 to-blue-400 rounded-2xl opacity-20 blur-sm animate-pulse",style:{"animation-delay":"0.5s"}})],-1))]),(0,a.Lk)("div",g,[t[3]||(t[3]=(0,a.Lk)("div",{class:"text-lg font-black tracking-widest mb-1 drop-shadow-sm",style:{color:"#ff0000"}}," MUHIMBILI NATIONAL HOSPITAL ",-1)),(0,a.Lk)("div",b,(0,a.v_)(s.departmentTitle),1)]),t[4]||(t[4]=(0,a.Fv)('<div class="flex justify-center gap-2 mt-4" data-v-94539b4a><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.1s;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;animation-delay:0.2s;" data-v-94539b4a></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#0000d1;animation-delay:0.3s;" data-v-94539b4a></div></div>',1))])])])])):(0,a.Q3)("",!0)}var h={name:"UnifiedLoadingBanner",props:{show:{type:Boolean,default:!0},loadingTitle:{type:String,default:"Loading Requests"},loadingSubtitle:{type:String,default:"Please wait..."},departmentTitle:{type:String,default:"SYSTEM MANAGEMENT"},forceSpin:{type:Boolean,default:!1}}},x=s(1241);const v=(0,x.A)(h,[["render",m],["__scopeId","data-v-94539b4a"]]);var k=v},4710:function(e,t,s){s.r(t);s(4603),s(7566),s(8721);var a=s(4373);const r="/api",i=a.A.create({baseURL:r,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),o=a.A.create({baseURL:r,timeout:3e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),l=!1,n=e=>{e.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))};n(i),n(o);const d=e=>{e.interceptors.request.use(e=>{if(e.method&&"get"===e.method.toLowerCase())try{const t=new URL(e.url,e.baseURL);t.searchParams.set("_cb",String(Date.now())),e.url=t.pathname+t.search}catch(t){const s=(e.url||"").includes("?")?"&":"?";e.url=`${e.url}${s}_cb=${Date.now()}`}return e},e=>Promise.reject(e))};d(i),d(o);const c={data:null,timestamp:null,maxAge:15e3},u="true"===String({NODE_ENV:"production",VUE_APP_API_TIMEOUT:"30000",VUE_APP_API_URL:"/api",VUE_APP_DEBUG:"false",VUE_APP_LOG_LEVEL:"debug",VUE_APP_NAME:"Mnh Access Management System",VUE_APP_VERSION:"1.0.0",BASE_URL:"/"}.VUE_APP_ENABLE_SMS_RESEND||"false").toLowerCase(),p={isResendEnabled(){return u},async resendSmsGeneric({requestId:e,role:t=null,target:s=null,phone:a=null,channel:r="sms"}){if(!u)return{success:!1,message:"SMS resend not supported by backend; skipped"};const i=e=>{if(!e)return null;const t=String(e).trim(),s=t.startsWith("+"),a=t.replace(/[^\d]/g,"");return s?`+${a}`:a},l=a||null,n=i(l),d={request_id:e,role:t,target:s,notification_type:"generic_sms",resend_only:!0,force:!0,force_resend:!0,resend_sms:!0,send_sms:!0,notification_channel:r,phone:l||void 0,phone_number:n||void 0,recipient_phone:n||void 0,destination_phone:n||void 0,msisdn:n||void 0,contact_phone:n||void 0,requester_phone:l||void 0,requester_phone_number:l||void 0,staff_phone:l||void 0,staff_phone_number:l||void 0},c=[];let p,f;for(let u=0;u<c.length;u++)try{return p=await o.post(c[u],d),{success:!!p.data?.success,data:p.data?.data,message:p.data?.message}}catch(g){f=g;continue}return{success:!1,message:f?.response?.data?.message||f?.message||"No resend endpoints configured"}},async getPendingRequestsCount(e=!1){if(!e&&c.data&&c.timestamp){const e=Date.now()-c.timestamp;if(e<c.maxAge)return l&&Math.round(e/1e3),c.data}let t=null;const s=2;for(let r=1;r<=s;r++)try{const e=await o.get("/notifications/pending-count");if(e.data.success)return c.data=e.data.data,c.timestamp=Date.now(),e.data.data;console.error("âŒ NotificationService: Failed to load pending count:",e.data.message),t=new Error(e.data.message||"Failed to load pending requests count")}catch(a){if(r===s&&l&&console.error("âŒ NotificationService: Error fetching pending count:",a?.message||a),a.response&&(console.error("Response status:",a.response.status),console.error("Response data:",a.response.data),console.error("Response headers:",a.response.headers)),t=a,401===a.response?.status||403===a.response?.status)break;if(500===a.response?.status&&r>=2)break;r<s&&await new Promise(e=>setTimeout(e,1e3*r))}if(t){if(c.data)return console.warn("âš ï¸ NotificationService: Using stale cached data due to API failure"),c.data;l&&(console.error("ðŸš« NotificationService: All retry attempts failed"),console.error("Last error details:",{message:t.message,status:t.response?.status,data:t.response?.data})),l&&console.warn("ðŸ”„ NotificationService: Providing fallback data to prevent UI breakage");const e={total_pending:0,requires_attention:!1,details:null};return c.data=e,c.timestamp=Date.now(),e}return{total_pending:0,requires_attention:!1,details:null}},async getPendingRequestsBreakdown(){try{const e=await o.get("/notifications/breakdown");if(e.data.success)return e.data.data;throw console.error("âŒ NotificationService: Failed to load breakdown:",e.data.message),new Error(e.data.message||"Failed to load breakdown")}catch(e){console.error("âŒ NotificationService: Error fetching breakdown:",e);let t="Network error while loading breakdown";throw e.response?t=e.response.data?.message||"Failed to load breakdown":"ECONNABORTED"===e.code?t="Request timed out - server may be slow":e.message.includes("Network Error")&&(t="Network connection error"),new Error(t)}},clearCache(){c.data=null,c.timestamp=null},getRoleNotificationConfig(e){const t={head_of_department:{routePattern:"/hod-dashboard",menuItems:["/hod-dashboard/request-list"],description:"New requests awaiting HOD approval"},divisional_director:{routePattern:"/divisional-dashboard",menuItems:["/divisional-dashboard/combined-requests"],description:"HOD-approved requests awaiting divisional approval"},ict_director:{routePattern:"/dict-dashboard",menuItems:["/dict-dashboard/combined-requests"],description:"Divisional-approved requests awaiting ICT Director approval"},head_of_it:{routePattern:"/head_of_it-dashboard",menuItems:["/head_of_it-dashboard/combined-requests"],description:"ICT Director-approved requests awaiting Head of IT approval"},ict_officer:{routePattern:"/ict-dashboard",menuItems:["/ict-dashboard/access-requests"],description:"Requests requiring implementation (excludes implemented/completed)"},admin:{routePattern:"/admin-dashboard",menuItems:["/admin-dashboard","/service-users"],description:"System-wide pending requests"}};return t[e]||{routePattern:"/user-dashboard",menuItems:[],description:"No pending approval tasks"}},shouldShowNotificationForRoute(e,t){const s=this.getRoleNotificationConfig(t);return s.menuItems.includes(e)}};t["default"]=p},6429:function(e,t,s){s.r(t),s.d(t,{default:function(){return we}});var a=s(5796);const r={class:"flex flex-col h-screen"},i={class:"flex flex-1 overflow-hidden"},o={class:"sidebar-narrow"},l={class:"flex-1 p-4 bg-blue-900 overflow-y-auto"},n={class:"max-w-full mx-auto"},d={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},c={class:"text-lg"},u={class:"grid grid-cols-4 gap-4 mb-6"},p={class:"bg-yellow-600/25 border border-yellow-400/40 p-4 rounded-lg"},f={class:"text-white text-3xl font-bold"},g={class:"bg-green-600/25 border border-green-400/40 p-4 rounded-lg"},b={class:"text-white text-3xl font-bold"},m={class:"bg-red-600/25 border border-red-400/40 p-4 rounded-lg"},h={class:"text-white text-3xl font-bold"},x={class:"bg-blue-600/25 border border-blue-400/40 p-4 rounded-lg"},v={class:"text-white text-3xl font-bold"},k={class:"bg-white/10 rounded-lg p-4 mb-6"},_={class:"flex gap-4"},y={class:"bg-white/10 rounded-lg overflow-hidden"},w={class:"w-full"},L=["data-request-id"],C={class:"px-4 py-3"},S={class:"flex items-center space-x-2"},q={class:"flex-shrink-0"},A={key:0,class:"fas fa-clock text-yellow-400 text-base",title:"Pending your approval"},R={key:1,class:"fas fa-check-circle text-green-400 text-base",title:"Processed by you"},I={class:"text-white font-medium text-sm"},T={class:"text-purple-300 text-xs"},E={class:"px-4 py-3"},D={class:"flex flex-nowrap gap-1"},F={key:0,class:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800 whitespace-nowrap"},O={key:1,class:"px-2 py-1 rounded text-xs bg-green-100 text-green-800 whitespace-nowrap"},j={key:2,class:"px-2 py-1 rounded text-xs bg-cyan-100 text-cyan-800 whitespace-nowrap"},P={class:"px-4 py-3"},X={class:"text-white font-medium text-sm"},M={class:"text-blue-300 text-xs"},N={key:0,class:"text-teal-300 text-xs"},Q={class:"text-blue-200 text-xs"},W={class:"px-4 py-3"},U={class:"text-white font-medium text-sm"},H={class:"text-blue-300 text-xs"},B={class:"px-4 py-3"},$={class:"flex flex-col"},V={key:0,class:"mb-1 rounded text-xs font-semibold inline-block bg-red-900/30 text-red-300 border border-red-500/40 px-2 py-0.5",style:{width:"fit-content"}},z={key:1,class:"mt-1 px-1.5 py-0.5 rounded text-[10px] font-semibold bg-emerald-900/30 text-emerald-300 border border-emerald-500/40 w-fit"},K={class:"px-4 py-3"},J={class:"flex items-center space-x-2"},G=["onClick","disabled"],Y={key:0},Z={key:1},ee={key:1,class:"text-xs text-blue-200 ml-1"},te={class:"px-4 py-3 text-center relative"},se={class:"flex justify-center three-dot-menu"},ae=["onClick","aria-label"],re=["onClick"],ie={class:"font-semibold"},oe={key:0,class:"text-center py-12"},le={class:"text-blue-300 text-base"},ne={key:1,class:"px-4 py-3 border-t border-blue-300/30"},de={class:"text-blue-300 text-base"};function ce(e,t,s,ce,ue,pe){const fe=(0,a.g2)("Header"),ge=(0,a.g2)("ModernSidebar"),be=(0,a.g2)("AppFooter"),me=(0,a.g2)("UnifiedLoadingBanner"),he=(0,a.g2)("RequestTimeline");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(fe),(0,a.Lk)("div",i,[(0,a.Lk)("div",o,[(0,a.bF)(ge)]),(0,a.Lk)("main",l,[(0,a.Lk)("div",n,[ue.error?((0,a.uX)(),(0,a.CE)("div",d,[t[5]||(t[5]=(0,a.Lk)("h3",{class:"font-bold text-xl"},"Error",-1)),(0,a.Lk)("p",c,(0,a.v_)(ue.error),1),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>pe.fetchRequests&&pe.fetchRequests(...e)),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 text-base font-medium"}," Retry ")])):(0,a.Q3)("",!0),(0,a.Lk)("div",u,[(0,a.Lk)("div",p,[t[6]||(t[6]=(0,a.Lk)("h3",{class:"text-yellow-200 text-lg font-bold"},"Pending My Approval",-1)),(0,a.Lk)("p",f,(0,a.v_)(ue.stats.pendingHeadOfIt),1)]),(0,a.Lk)("div",g,[t[7]||(t[7]=(0,a.Lk)("h3",{class:"text-green-200 text-lg font-bold"},"Approved by Me",-1)),(0,a.Lk)("p",b,(0,a.v_)(ue.stats.headOfItApproved),1)]),(0,a.Lk)("div",m,[t[8]||(t[8]=(0,a.Lk)("h3",{class:"text-red-200 text-lg font-bold"},"Rejected by Me",-1)),(0,a.Lk)("p",h,(0,a.v_)(ue.stats.headOfItRejected),1)]),(0,a.Lk)("div",x,[t[9]||(t[9]=(0,a.Lk)("h3",{class:"text-blue-200 text-lg font-bold"},"Total Requests",-1)),(0,a.Lk)("p",v,(0,a.v_)(ue.stats.total),1)])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",_,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>ue.searchQuery=e),type:"text",placeholder:"Search by staff name, PF number, or department...",class:"flex-1 px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white placeholder-blue-200/60 text-base"},null,512),[[a.Jo,ue.searchQuery]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>ue.statusFilter=e),class:"px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white text-base status-select"},[...t[10]||(t[10]=[(0,a.Fv)('<option value="" data-v-1723f07f>All My Requests</option><option value="pending" data-v-1723f07f>Show All Pending</option><option value="ict_director_approved" data-v-1723f07f>Pending My Approval</option><option value="head_of_it_approved" data-v-1723f07f>Approved by Me</option><option value="head_of_it_rejected" data-v-1723f07f>Rejected by Me</option><option value="assigned_to_ict" data-v-1723f07f>Assigned to ICT</option><option value="implementation_in_progress" data-v-1723f07f>In Progress</option><option value="completed" data-v-1723f07f>Completed</option>',8)])],512),[[a.u1,ue.statusFilter]]),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>pe.refreshRequests&&pe.refreshRequests(...e)),class:"px-6 py-3 bg-teal-600 text-white rounded hover:bg-teal-700 text-base font-bold"}," Refresh ")])]),(0,a.Lk)("div",y,[(0,a.Lk)("table",w,[t[13]||(t[13]=(0,a.Lk)("thead",{class:"bg-blue-800/50"},[(0,a.Lk)("tr"),(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"Request ID"),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"Request Type"),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," Personal Information "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," ICT Director Approval Date "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"}," Current Status "),(0,a.Lk)("th",{class:"px-4 py-3 text-left text-blue-100 text-sm font-bold"},"SMS Status"),(0,a.Lk)("th",{class:"px-4 py-3 text-center text-blue-100 text-sm font-bold"},"Actions")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(pe.filteredRequests,e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,"data-request-id":e.id,class:(0,a.C4)(["border-t border-blue-300/20 hover:bg-blue-700/30 transition-colors duration-200",pe.isPendingStatus(e.status)?"bg-yellow-900/20 border-l-4 border-yellow-400":"bg-green-900/10 border-l-4 border-green-600"])},[(0,a.Lk)("td",C,[(0,a.Lk)("div",S,[(0,a.Lk)("div",q,[pe.isPendingStatus(e.status)?((0,a.uX)(),(0,a.CE)("i",A)):((0,a.uX)(),(0,a.CE)("i",R))]),(0,a.Lk)("div",null,[(0,a.Lk)("div",I,(0,a.v_)(e.request_id||`REQ-${e.id.toString().padStart(6,"0")}`),1),(0,a.Lk)("div",T,"ID: "+(0,a.v_)(e.id),1)])])]),(0,a.Lk)("td",E,[(0,a.Lk)("div",D,[pe.hasService(e,"jeeva")?((0,a.uX)(),(0,a.CE)("span",F," Jeeva ")):(0,a.Q3)("",!0),pe.hasService(e,"wellsoft")?((0,a.uX)(),(0,a.CE)("span",O," Wellsoft ")):(0,a.Q3)("",!0),pe.hasService(e,"internet")?((0,a.uX)(),(0,a.CE)("span",j," Internet ")):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",P,[(0,a.Lk)("div",X,(0,a.v_)(e.staff_name||e.full_name||"Unknown User"),1),(0,a.Lk)("div",M,(0,a.v_)(e.phone||e.phone_number||"No phone"),1),e.pf_number?((0,a.uX)(),(0,a.CE)("div",N," PF: "+(0,a.v_)(e.pf_number),1)):(0,a.Q3)("",!0),(0,a.Lk)("div",Q," Dept: "+(0,a.v_)(e.department||"Unknown"),1)]),(0,a.Lk)("td",W,[(0,a.Lk)("div",U,(0,a.v_)(pe.formatDate(e.ict_director_approved_at)),1),(0,a.Lk)("div",H,(0,a.v_)(pe.formatTime(e.ict_director_approved_at)),1)]),(0,a.Lk)("td",B,[(0,a.Lk)("div",$,["skipped"===e.divisional_status?((0,a.uX)(),(0,a.CE)("span",V," No Divisional Director â€” Stage Skipped ")):(0,a.Q3)("",!0),(0,a.Lk)("span",{class:(0,a.C4)([pe.getStatusBadgeClass(e.status),"rounded text-sm font-medium inline-block whitespace-nowrap"]),style:{padding:"4px 8px",width:"fit-content"}},(0,a.v_)(pe.getStatusText(e.status)),3),e.has_signature||e.signature?((0,a.uX)(),(0,a.CE)("span",z," Digitally signed ")):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",K,[(0,a.Lk)("div",J,[(0,a.Lk)("div",{class:(0,a.C4)(["w-3 h-3 rounded-full",pe.getSmsStatusColor(pe.getRelevantSmsStatus(e))])},null,2),(0,a.Lk)("span",{class:(0,a.C4)(["text-sm font-medium",pe.getSmsStatusTextColor(pe.getRelevantSmsStatus(e))])},(0,a.v_)(pe.getSmsStatusText(pe.getRelevantSmsStatus(e))),3),["failed","pending"].includes(pe.getRelevantSmsStatus(e))?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t=>pe.retrySendSms(e),disabled:pe.isRetrying(e.id),class:"ml-2 px-2 py-1 text-xs rounded border border-blue-300/50 text-blue-100 hover:bg-blue-700/40 disabled:opacity-50",title:"Retry sending SMS"},[pe.isRetrying(e.id)?((0,a.uX)(),(0,a.CE)("span",Z,[...t[11]||(t[11]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),(0,a.eW)("Retrying",-1)])])):((0,a.uX)(),(0,a.CE)("span",Y,"Retry"))],8,G)):(0,a.Q3)("",!0),pe.getRetryAttempts(e.id)>0?((0,a.uX)(),(0,a.CE)("span",ee," ("+(0,a.v_)(pe.getRetryAttempts(e.id))+") ",1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("td",te,[(0,a.Lk)("div",se,[(0,a.Lk)("button",{onClick:t=>pe.toggleDropdown(e.id),class:(0,a.C4)(["three-dot-button p-2 text-white hover:bg-blue-600/40 rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:scale-105 active:scale-95",{"bg-blue-600/40 shadow-lg":ue.openDropdownId===e.id}]),"aria-label":"Actions for request "+(e.request_id||"REQ-"+e.id.toString().padStart(6,"0"))},[...t[12]||(t[12]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[(0,a.Lk)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],10,ae),(0,a.bo)((0,a.Lk)("div",{class:"dropdown-menu fixed w-48 bg-white rounded-lg shadow-xl border border-gray-200 z-[10000] py-1 min-w-max",style:(0,a.Tr)(pe.getDropdownPositionStyle(e.id)),onClick:t[4]||(t[4]=(0,a.D$)(()=>{},["stop"]))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(pe.getAvailableActions(e),(t,s)=>((0,a.uX)(),(0,a.CE)("button",{key:t.key,onClick:(0,a.D$)(s=>pe.executeAction(t.key,e),["stop"]),class:(0,a.C4)(["w-full text-left px-4 py-2 text-sm transition-all duration-200 flex items-center space-x-3 group focus:outline-none focus:ring-2 focus:ring-inset",pe.getActionButtonClass(t.key,s,pe.getAvailableActions(e).length)])},[(0,a.Lk)("i",{class:(0,a.C4)([[t.icon,pe.getActionIconClass(t.key)],"flex-shrink-0 transition-colors duration-200 text-base"])},null,2),(0,a.Lk)("span",ie,(0,a.v_)(t.label),1)],10,re))),128))],4),[[a.aG,ue.openDropdownId===e.id]])])])],10,L))),128))])]),0===pe.filteredRequests.length?((0,a.uX)(),(0,a.CE)("div",oe,[t[14]||(t[14]=(0,a.Lk)("h3",{class:"text-white text-xl font-medium mb-2"},"No requests found",-1)),(0,a.Lk)("p",le,(0,a.v_)(ue.searchQuery||ue.statusFilter?"No requests match your current filters.":"No requests available for Head of IT review. Requests appear here when approved by ICT Directors."),1)])):(0,a.Q3)("",!0),pe.filteredRequests.length>0?((0,a.uX)(),(0,a.CE)("div",ne,[(0,a.Lk)("div",de," Showing "+(0,a.v_)(pe.filteredRequests.length)+" of "+(0,a.v_)(ue.requests.length)+" requests ",1)])):(0,a.Q3)("",!0)]),(0,a.bF)(be)])])]),(0,a.bF)(me,{show:ue.isLoading,loadingTitle:"Loading Access Requests",loadingSubtitle:"Fetching requests for Head of IT review...",departmentTitle:"HEAD OF IT REQUESTS MANAGEMENT"},null,8,["show"]),(0,a.bF)(he,{show:ue.showTimeline,"request-id":ue.selectedRequestId,onClose:pe.closeTimeline,onUpdated:pe.handleTimelineUpdate},null,8,["show","request-id","onClose","onUpdated"])])}s(4114),s(8111),s(2489),s(116),s(7588),s(3579),s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);var ue=s(5498),pe=s(8966),fe=s(9101),ge=s(373),be=s(1445),me=s(9729),he=s(2398),xe=s(1127),ve=s(4710),ke={name:"HeadOfItRequestList",components:{Header:ue.A,ModernSidebar:pe.A,AppFooter:fe.A,RequestTimeline:ge.A,UnifiedLoadingBanner:be.A},setup(){const{userRole:e}=(0,xe.h)();return{userRole:e}},data(){return{requests:[],searchQuery:"",statusFilter:"",isLoading:!1,stats:{pendingHeadOfIt:0,headOfItApproved:0,headOfItRejected:0,total:0},error:null,openDropdownId:null,showTimeline:!1,selectedRequestId:null,$statusUtils:he.Ay,assignedRequestsThisSession:new Set,lastSmsStatusCache:{},retryAttempts:{},retryTimers:{},maxRetryAttempts:5,retryDelays:[3e3,7e3,15e3,3e4,6e4]}},computed:{filteredRequests(){if(!Array.isArray(this.requests))return console.warn("HeadOfItRequestList: requests is not an array:",this.requests),[];let e=this.requests;if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter(e=>(e.staff_name||e.full_name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t)||(e.request_id||"").toLowerCase().includes(t))}return this.statusFilter&&(e="pending"===this.statusFilter?e.filter(e=>this.isPendingStatus(e.status)):e.filter(e=>e.status===this.statusFilter)),e.sort((e,t)=>{const s=this.isPendingStatus(e.status),a=this.isPendingStatus(t.status);if(s&&!a)return-1;if(!s&&a)return 1;const r=e=>this.isPendingStatus(e.status)?new Date(e.ict_director_approved_at||e.created_at||0):new Date(e.head_of_it_approved_at||e.updated_at||0),i=r(e),o=r(t);return i-o})}},async mounted(){try{this.initializeSessionTracking(),await this.fetchRequests(),document.addEventListener("click",this.closeAllDropdowns)}catch(e){console.error("HeadOfItRequestList: Error during mount:",e),this.error="Failed to initialize component: "+e.message,this.isLoading=!1}},beforeUnmount(){document.removeEventListener("click",this.closeAllDropdowns)},methods:{initializeSessionTracking(){try{const e=sessionStorage.getItem("headOfIt_assignedRequests");if(e){const t=JSON.parse(e);this.assignedRequestsThisSession=new Set(t),Array.from(this.assignedRequestsThisSession)}const t=sessionStorage.getItem("headOfIt_smsStatusCache");t&&(this.lastSmsStatusCache=JSON.parse(t)||{},this.lastSmsStatusCache)}catch(e){console.error("âš ï¸ Failed to restore assigned requests/SMS cache from session:",e),this.assignedRequestsThisSession=new Set,this.lastSmsStatusCache={}}},persistSessionTracking(){try{const e=Array.from(this.assignedRequestsThisSession);sessionStorage.setItem("headOfIt_assignedRequests",JSON.stringify(e))}catch(e){console.error("âš ï¸ Failed to persist assigned requests to session:",e)}},persistSmsCache(){try{sessionStorage.setItem("headOfIt_smsStatusCache",JSON.stringify(this.lastSmsStatusCache||{}))}catch(e){}},async fetchRequests(){this.isLoading=!0,this.error=null;try{const e=await me.A.getPendingRequests();e.success?(e.data.length,this.requests=e.data.requests||[],this.stats={pendingHeadOfIt:this.requests.filter(e=>"ict_director_approved"===e.status).length,headOfItApproved:this.requests.filter(e=>"head_of_it_approved"===e.status).length,headOfItRejected:this.requests.filter(e=>"head_of_it_rejected"===e.status).length,total:this.requests.length}):(console.error("âŒ HeadOfItRequestList: Failed to load requests:",e.message),this.error=e.message,this.requests=[])}catch(e){console.error("âŒ HeadOfItRequestList: Error loading requests:",e),this.error="Network error while loading requests. Please check your connection.",this.requests=[]}finally{this.isLoading=!1}},async refreshRequests(){await this.fetchRequests(),this.initAutoRetryForList()},viewAndProcessRequest(e){this.$router.push(`/head_of_it-dashboard/both-service-form/${e}`)},isPendingStatus(e){const t=["ict_director_approved"];return t.includes(e)},hasService(e,t){return!!e.request_types&&(Array.isArray(e.request_types)?e.request_types.some(e=>e.toLowerCase().includes(t.toLowerCase())):"string"===typeof e.request_types&&e.request_types.toLowerCase().includes(t.toLowerCase()))},getStatusBadgeClass(e){const t={ict_director_approved:"bg-yellow-500 text-yellow-900",head_of_it_approved:"bg-green-500 text-green-900",head_of_it_rejected:"bg-red-500 text-red-900",assigned_to_ict:"bg-blue-500 text-blue-900",implementation_in_progress:"bg-purple-500 text-purple-900",completed:"bg-emerald-500 text-emerald-900"};return t[e]||"bg-gray-500 text-gray-900"},getStatusText(e){const t={ict_director_approved:"Pending Your Approval",head_of_it_approved:"Approved by You",head_of_it_rejected:"Rejected by You",assigned_to_ict:"Assigned to ICT Officer",implementation_in_progress:"Implementation in Progress",completed:"Implementation Completed"};return t[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},formatDate(e){if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-GB")}catch{return"Invalid Date"}},formatTime(e){if(!e)return"N/A";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Time"}},toggleDropdown(e){this.openDropdownId,this.openDropdownId===e?this.openDropdownId=null:this.openDropdownId=e},closeAllDropdowns(e){e&&(e.target.closest(".dropdown-menu")||e.target.closest(".three-dot-button"))||(this.openDropdownId=null)},isTaskAssigned(e){e.id,e.status,e.assigned_ict_officer_id,e.ict_officer_id,e.assigned_to_ict_officer,e.ict_officer,e.ict_officer_name,e.assigned_officer,e.task_assigned_at;const t=["assigned_to_ict","implementation_in_progress","implemented","completed"].includes(e.status),s=!!(e.assigned_ict_officer_id||e.ict_officer_id||e.assigned_to_ict_officer||e.ict_officer||e.ict_officer_name||e.assigned_officer||e.task_assigned_at||e.assignee||e.assignee_id||e.task_assignment||e.task_assignment_id),a=Object.keys(e).some(t=>{const s=t.toLowerCase();return(s.includes("officer")||s.includes("assign"))&&e[t]&&null!==e[t]&&""!==e[t]}),r=t||s||a;return e.id,Object.keys(e),r},isReadOnlyMode(e){return!this.isPendingStatus(e.status)},getAvailableActions(e){const t=[],s=this.userRole,a=e.status,r=this.isTaskAssigned(e);this.isReadOnlyMode(e);e.id,this.isPendingStatus(a);const i={HEAD_OF_IT:"head_of_it",ICT_OFFICER:"ict_officer",ICT_DIRECTOR:"ict_director",DIVISIONAL_DIRECTOR:"divisional_director",HEAD_OF_DEPARTMENT:"hod",STAFF:"staff"};if(s!==i.HEAD_OF_IT&&s)s===i.ICT_OFFICER?(t.push({key:"view_and_process",label:"View Details",icon:"fas fa-eye"}),["assigned_to_ict","implementation_in_progress"].includes(a)&&t.push({key:"update_progress",label:"Update Progress",icon:"fas fa-edit"}),t.push({key:"view_timeline",label:"View Timeline",icon:"fas fa-history"})):(t.push({key:"view_and_process",label:"View Details",icon:"fas fa-eye"}),t.push({key:"view_timeline",label:"View Timeline",icon:"fas fa-history"}));else{this.isPendingStatus(a)?t.push({key:"view_and_process",label:"Approve",icon:"fas fa-check"}):t.push({key:"view_and_process",label:"View Approved Request",icon:"fas fa-eye"});const s="head_of_it_approved"===a,i=!["assigned_to_ict","implementation_in_progress","implemented","completed"].includes(a),o=r,l=!Object.keys(e).some(t=>{const s=t.toLowerCase(),a=e[t];return(s.includes("officer")||s.includes("assign"))&&a&&null!==a&&""!==a&&0!==a}),n=!this.assignedRequestsThisSession.has(e.id),d=s&&i&&!o&&l&&n;e.id,Array.from(this.assignedRequestsThisSession),d&&t.push({key:"assign_task",label:"Assign Task",icon:"fas fa-user-plus"});const c=s&&i&&!o&&l&&n&&!["completed","implemented"].includes(a);e.id,["completed","implemented"].includes(a),Array.from(this.assignedRequestsThisSession),c||s&&i&&(o||l&&n&&["completed","implemented"].includes(a)),c&&t.push({key:"cancel_task",label:"Cancel Task",icon:"fas fa-times-circle"}),t.push({key:"view_timeline",label:"View Timeline",icon:"fas fa-history"})}return t},executeAction(e,t){switch(t.id,this.closeAllDropdowns(),e){case"assign_task":this.assignTask(t);break;case"cancel_task":this.cancelTask(t);break;case"update_progress":this.updateProgress(t);break;case"view_timeline":this.viewTimeline(t);break;case"view_and_process":this.viewAndProcessRequest(t.id);break;default:console.warn("Unknown action:",e)}},assignTask(e){e.id,this.assignedRequestsThisSession.add(e.id),e.id,this.persistSessionTracking(),this.$router.push(`/head_of_it-dashboard/select-ict-officer/${e.id}`)},async cancelTask(e){e.id;const t=confirm(`Are you sure you want to cancel the task for Request ${e.request_id||"REQ-"+e.id.toString().padStart(6,"0")}? This will stop the implementation process.`);if(t){const t=prompt("Please provide a reason for cancelling the task:");if(t&&""!==t.trim())try{const s=await me.A.cancelTaskAssignment(e.id,{reason:t.trim(),cancelled_by:"head_of_it",cancelled_at:(new Date).toISOString()});s.success?(alert(`âœ… Task cancelled successfully for Request ${e.request_id||"REQ-"+e.id.toString().padStart(6,"0")}.\nReason: ${t}`),await this.fetchRequests()):(alert(`âŒ Failed to cancel task: ${s.message}`),console.error("âŒ Task cancellation failed:",s.message))}catch(s){console.error("âŒ Error during task cancellation:",s),alert(`âŒ Error cancelling task: ${s.message||"Network error occurred"}`)}else alert("Cancellation reason is required")}},updateProgress(e){e.id,alert("Update Progress functionality would be implemented here. This might open a modal or dedicated page.")},viewTimeline(e){e.id,this.selectedRequestId=e.id,this.showTimeline=!0},closeTimeline(){this.showTimeline=!1,this.selectedRequestId=null},async handleTimelineUpdate(){await this.fetchRequests(),this.initAutoRetryForList()},shouldShowSeparator(e,t){const s=["cancel_task"],a=["view_timeline","view_and_process"];return!(!s.includes(e.key)||s.includes(t?.key))||!(!a.includes(e.key)||a.includes(t?.key)||"view_and_process"===t?.key)},getRetryAttempts(e){return this.retryAttempts[e]||0},isRetrying(e){return!!this.retryTimers[e]},async retrySendSms(e){if(!e)return;const t=e.id;if(this.retryAttempts[t]||(this.retryAttempts[t]=0),!this.isRetrying(t))try{this.retryTimers[t]=setTimeout(()=>{},0);const s=e.ict_officer_phone||e.assigned_officer_phone||null;await ve["default"].resendSmsGeneric({requestId:t,role:"head_of_it",target:"ict_officer",phone:s}),setTimeout(async()=>{await this.fetchRequests(),clearTimeout(this.retryTimers[t]),delete this.retryTimers[t];const s=this.getRelevantSmsStatus(this.requests.find(e=>e.id===t)||e);"sent"!==s?this.scheduleNextRetry(t,e):this.retryAttempts[t]=0},1200)}catch(s){clearTimeout(this.retryTimers[t]),delete this.retryTimers[t],this.scheduleNextRetry(t,e)}},scheduleNextRetry(e,t){if(this.retryAttempts[e]=(this.retryAttempts[e]||0)+1,this.retryAttempts[e]>this.maxRetryAttempts)return;const s=this.retryDelays[Math.min(this.retryAttempts[e]-1,this.retryDelays.length-1)];this.retryTimers[e]=setTimeout(async()=>{clearTimeout(this.retryTimers[e]),delete this.retryTimers[e],await this.retrySendSms(t)},s)},initAutoRetryForList(){(this.requests||[]).forEach(e=>{const t=this.getRelevantSmsStatus(e);["failed","pending"].includes(t)&&(this.retryTimers[e.id]||0!==(this.retryAttempts[e.id]||0)||this.scheduleNextRetry(e.id,e))})},getRelevantSmsStatus(e){const t=e.status||e.head_it_status,s=this.lastSmsStatusCache&&this.lastSmsStatusCache[e.id],a=e=>{if(void 0===e||null===e)return null;if("boolean"===typeof e)return e?"sent":"pending";if("number"===typeof e)return 1===e?"sent":0===e?"pending":null;if("object"===typeof e){const t=e.status||e.state||e.result||null;return t?a(t):e.delivered_at||e.sent_at?"sent":null}const t=String(e).toLowerCase().trim();return"1"===t||"true"===t||"yes"===t||"y"===t?"sent":"0"===t||"false"===t||"no"===t||"n"===t?"pending":["sent","delivered","successful","success","ok","delivrd","delivery_ok","submitted","accepted","done","complete","completed"].includes(t)?"sent":["failed","fail","error","undelivered","rejected","expired","blocked","blacklisted"].includes(t)?"failed":["queued","queue","processing","pending","in_progress"].includes(t)?"pending":t||null};if("head_of_it_approved"===t||e.head_it_status&&"approved"===String(e.head_it_status).toLowerCase()){const t=e.sms_sent_to_requester_at||e.requester_sms_sent_at||null;if(t)return"sent"!==this.lastSmsStatusCache[e.id]&&(this.lastSmsStatusCache[e.id]="sent",this.persistSmsCache()),"sent";const s=a(e.sms_to_requester_status);if(s)return"pending"!==s&&(this.lastSmsStatusCache[e.id]=s,this.persistSmsCache()),s}const r=e.sms_sent_to_ict_officer_at||e.sms_to_ict_officer_at||e.ict_officer_sms_sent_at||e.sms_sent_to_officer_at||e.officer_sms_sent_at||e.sms_to_officer_at||e.sms_delivered_to_officer_at||e.sms_to_ict_officer_delivered_at||e.ict_officer_sms_delivered_at||e.sms_delivered_at||e.delivered_to_officer_at||e.officer_sms_delivery_at||null;if(r)return"sent"!==this.lastSmsStatusCache[e.id]&&(this.lastSmsStatusCache[e.id]="sent",this.persistSmsCache()),"sent";const i=[e.sms_to_ict_officer_status,e.sms_to_ict_officer,e.sms_status_to_ict_officer,e.ict_officer_sms_status,e.sms_to_ict_status,e.sms_status,e.sms_status_to_officer,e.sms_to_officer_status,e.officer_sms_status,e.sms_ict_officer_status,e.ict_sms_status,e.sms_delivery_status_to_officer,e.delivery_status,e.delivery_state,e.delivery_report_status,e.dlr_status,e.sms_dlr_status,e.sms_delivery_report_status],o=i.map(e=>{if("object"===typeof e&&e){const t=e.status||e.state||e.result||(e.delivered_at?"delivered":null);return a(t)}return a(e)}).filter(Boolean);if(o.length){const t=o.find(e=>"pending"!==e),s=t||o[0];return"pending"!==s&&this.lastSmsStatusCache[e.id]!==s&&(this.lastSmsStatusCache[e.id]=s,this.persistSmsCache()),s}if("head_of_it_approved"===t||"assigned_to_ict"===e.status||"implementation_in_progress"===e.status)return s||"pending";const l=a(e.sms_to_requester_status);return"implemented"===t||"completed"===t?(l&&"pending"!==l&&(this.lastSmsStatusCache[e.id]=l),l||s||"pending"):s||"pending"},getSmsStatusText(e){const t={sent:"Delivered",pending:"Pending",failed:"Failed"};return t[e]||"Pending"},getSmsStatusColor(e){const t={sent:"bg-green-500",pending:"bg-yellow-500",failed:"bg-red-500"};return t[e]||"bg-gray-400"},getSmsStatusTextColor(e){const t={sent:"text-green-400",pending:"text-yellow-400",failed:"text-red-400"};return t[e]||"text-gray-400"},getDropdownPositionStyle(e){const t=document.querySelector(`[data-request-id="${e}"] .three-dot-button`);if(!t)return{position:"fixed",top:"auto",left:"auto",right:"1rem",boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1)"};const s=t.getBoundingClientRect(),a=window.innerHeight,r=window.innerWidth,i=192,o=200;let l=s.bottom+8,n=s.right-i;return l+o>a&&(l=s.top-o-8),n<16&&(n=s.left),n+i>r-16&&(n=r-i-16),{position:"fixed",top:`${l}px`,left:`${n}px`,boxShadow:"0 10px 25px rgba(0, 0, 0, 0.15), 0 4px 6px rgba(0, 0, 0, 0.1)"}},getActionButtonClass(e,t,s){const a={view_and_process:"bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:ring-green-500",view_timeline:"bg-indigo-50 text-indigo-800 border-b border-indigo-200 hover:bg-indigo-100 focus:bg-indigo-100 focus:ring-indigo-500",assign_task:"bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:ring-green-500",view_progress:"bg-orange-50 text-orange-800 border-b border-orange-200 hover:bg-orange-100 focus:bg-orange-100 focus:ring-orange-500",update_progress:"bg-purple-50 text-purple-800 border-b border-purple-200 hover:bg-purple-100 focus:bg-purple-100 focus:ring-purple-500",cancel_task:"bg-red-50 text-red-800 hover:bg-red-100 focus:bg-red-100 focus:ring-red-500"};let r=a[e]||"bg-gray-50 text-gray-800 hover:bg-gray-100 focus:bg-gray-100 focus:ring-gray-500";return 0===t&&(r+=" first:rounded-t-lg"),t===s-1&&(r+=" last:rounded-b-lg"),r},getActionIconClass(e){const t={view_and_process:"text-green-600 group-hover:text-green-700 group-focus:text-green-700",view_timeline:"text-indigo-600 group-hover:text-indigo-700 group-focus:text-indigo-700",assign_task:"text-green-600 group-hover:text-green-700 group-focus:text-green-700",view_progress:"text-orange-600 group-hover:text-orange-700 group-focus:text-orange-700",update_progress:"text-purple-600 group-hover:text-purple-700 group-focus:text-purple-700",cancel_task:"text-red-600 group-hover:text-red-700 group-focus:text-red-700"};return t[e]||"text-gray-600 group-hover:text-gray-700 group-focus:text-gray-700"}}},_e=s(1241);const ye=(0,_e.A)(ke,[["render",ce],["__scopeId","data-v-1723f07f"]]);var we=ye},9054:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ke}});var a=s(5796);const r={class:"flex flex-col h-screen"},i={class:"flex flex-1 overflow-hidden"},o={class:"flex-1 p-2 overflow-y-auto relative bg-blue-900",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"}},l={class:"absolute inset-0 overflow-hidden"},n={class:"absolute inset-0 opacity-5"},d={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},c={class:"max-w-full mx-auto relative z-10 px-4"},u={class:"medical-glass-card rounded-t-3xl p-4 mb-0 border-b border-blue-300/30"},p={class:"medical-glass-card rounded-none border-t-0 border-b border-blue-300/30"},f={class:"p-4"},g={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},b={class:"flex-1 max-w-xl"},m={class:"relative"},h={class:"flex flex-wrap gap-3 items-center"},x={class:"relative"},v={class:"relative"},k=["disabled"],_={key:0,class:"mt-3 flex flex-wrap gap-2"},y={key:0,class:"inline-flex items-center px-2 py-1 bg-green-600/30 text-green-200 text-sm rounded-md border border-green-400/30"},w={key:1,class:"inline-flex items-center px-2 py-1 bg-blue-600/30 text-blue-200 text-sm rounded-md border border-blue-400/30"},L={key:2,class:"inline-flex items-center px-2 py-1 bg-yellow-600/30 text-yellow-200 text-sm rounded-md border border-yellow-400/30"},C={class:"medical-glass-card rounded-b-3xl overflow-hidden"},S={class:"p-6"},q={key:0,class:"text-center py-12"},A={key:1,class:"text-center py-12"},R={key:2,class:"text-center py-12"},I={key:3,class:"overflow-hidden rounded-xl border border-blue-300/20"},T={class:"overflow-x-auto"},E={class:"w-full"},D={class:"divide-y divide-blue-300/10"},F={class:"px-6 py-4 whitespace-nowrap"},O={class:"flex items-center"},j={class:"text-base font-medium text-white"},P={class:"px-6 py-4"},X={class:"text-base font-medium text-white"},M={class:"text-sm text-blue-300"},N={class:"px-6 py-4"},Q={class:"text-base text-white"},W={class:"px-6 py-4"},U={class:"flex flex-wrap gap-1"},H={class:"px-6 py-4 whitespace-nowrap"},B={class:"px-6 py-4 whitespace-nowrap text-base text-gray-300"},$={class:"px-6 py-4 whitespace-nowrap text-center"},V={class:"flex items-center justify-center space-x-2"},z=["onClick","title"],K={key:4,class:"mt-8 flex justify-center"},J={class:"flex items-center space-x-2"},G=["disabled"],Y={class:"text-base text-white mx-4"},Z=["disabled"],ee={class:"flex items-center justify-between p-6 border-b border-blue-300/20"},te={class:"flex items-center space-x-3"},se={class:"text-xl font-bold text-white"},ae={class:"text-sm text-blue-300"},re={class:"p-6 space-y-6"},ie={class:"bg-blue-600/10 border border-blue-400/20 rounded-lg p-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},le={class:"space-y-2"},ne={class:"flex justify-between"},de={class:"flex justify-between"},ce={class:"text-white font-medium"},ue={key:0,class:"flex justify-between"},pe={class:"text-white font-medium"},fe={class:"space-y-2"},ge={class:"flex justify-between"},be={class:"flex flex-wrap gap-1"},me={class:"flex justify-between"},he={class:"text-white font-medium"},xe={class:"flex items-start space-x-3"},ve={class:"flex-1"},ke={class:"flex items-center space-x-2 mb-3"},_e={class:"text-white leading-relaxed whitespace-pre-line"},ye={key:0},we={key:1},Le={class:"text-sm text-teal-300"},Ce={key:1,class:"bg-gradient-to-r from-purple-600/20 to-pink-600/20 border border-purple-400/30 rounded-lg p-4"},Se={class:"flex items-start space-x-3"},qe={class:"flex-1"},Ae={class:"flex items-center space-x-2 mb-3"},Re={class:"text-sm text-purple-300"},Ie={class:"bg-purple-900/20 rounded-lg p-3 mb-3"},Te={class:"text-white leading-relaxed whitespace-pre-line"},Ee={class:"text-sm text-purple-300"},De={key:2,class:"bg-purple-600/10 border border-purple-400/20 rounded-lg p-4"},Fe={class:"space-y-3"},Oe={key:0,class:"space-y-2"},je={class:"flex flex-wrap gap-2"},Pe={key:1,class:"space-y-2"},Xe={class:"flex flex-wrap gap-2"},Me={key:2,class:"space-y-2"},Ne={class:"flex flex-wrap gap-2"};function Qe(e,t,s,Qe,We,Ue){const He=(0,a.g2)("Header"),Be=(0,a.g2)("ModernSidebar"),$e=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(He),(0,a.Lk)("div",i,[(0,a.bF)(Be),(0,a.Lk)("main",o,[(0,a.Lk)("div",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.bF)($e,{to:"/head_of_it-dashboard",class:"p-2 rounded-lg bg-teal-600/20 hover:bg-teal-600/30 transition-colors"},{default:(0,a.k6)(()=>[...t[19]||(t[19]=[(0,a.Lk)("i",{class:"fas fa-arrow-left text-teal-300 hover:text-white"},null,-1)])]),_:1})]),(0,a.Lk)("div",p,[(0,a.Lk)("div",f,[(0,a.Lk)("div",g,[(0,a.Lk)("div",b,[(0,a.Lk)("div",m,[t[21]||(t[21]=(0,a.Lk)("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-search text-teal-300"})],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>Qe.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>Qe.debouncedSearch&&Qe.debouncedSearch(...e)),type:"text",placeholder:"Search by staff name, PF number, or request ID...",class:"w-full pl-10 pr-4 py-2.5 bg-white/10 border border-teal-300/30 rounded-lg focus:border-teal-400 focus:outline-none text-white placeholder-teal-200/60 backdrop-blur-sm transition-colors"},null,544),[[a.Jo,Qe.searchQuery]]),Qe.searchQuery?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[2]||(t[2]=(...e)=>Qe.clearSearch&&Qe.clearSearch(...e)),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-teal-300 hover:text-white"},[...t[20]||(t[20]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",h,[(0,a.Lk)("div",x,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>Qe.statusFilter=e),onChange:t[4]||(t[4]=(...e)=>Qe.applyFilters&&Qe.applyFilters(...e)),class:"appearance-none bg-white/10 border border-teal-300/30 rounded-lg px-4 py-2.5 pr-10 text-white text-sm focus:border-teal-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[22]||(t[22]=[(0,a.Fv)('<option value="" class="bg-blue-900 text-white" data-v-b66498ca>All Statuses</option><option value="ict_director_approved" class="bg-blue-900 text-white" data-v-b66498ca> ICT Director Approved </option><option value="ict_director_rejected" class="bg-blue-900 text-white" data-v-b66498ca> ICT Director Rejected </option><option value="pending_head_it" class="bg-blue-900 text-white" data-v-b66498ca> Pending Head IT </option><option value="head_it_approved" class="bg-blue-900 text-white" data-v-b66498ca> Head IT Approved </option><option value="implemented" class="bg-blue-900 text-white" data-v-b66498ca> Implemented </option>',6)])],544),[[a.u1,Qe.statusFilter]]),t[23]||(t[23]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-teal-300"})],-1))]),(0,a.Lk)("div",v,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>Qe.requestTypeFilter=e),onChange:t[6]||(t[6]=(...e)=>Qe.applyFilters&&Qe.applyFilters(...e)),class:"appearance-none bg-white/10 border border-teal-300/30 rounded-lg px-4 py-2.5 pr-10 text-white text-sm focus:border-teal-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[24]||(t[24]=[(0,a.Lk)("option",{value:"",class:"bg-blue-900 text-white"},"All Request Types",-1),(0,a.Lk)("option",{value:"jeeva_access",class:"bg-blue-900 text-white"}," Jeeva Access ",-1),(0,a.Lk)("option",{value:"wellsoft",class:"bg-blue-900 text-white"},"Wellsoft",-1),(0,a.Lk)("option",{value:"internet_access_request",class:"bg-blue-900 text-white"}," Internet Access ",-1)])],544),[[a.u1,Qe.requestTypeFilter]]),t[25]||(t[25]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-teal-300"})],-1))]),Qe.hasActiveFilters?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[7]||(t[7]=(...e)=>Qe.clearAllFilters&&Qe.clearAllFilters(...e)),class:"px-3 py-2.5 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors border border-red-400/30 text-sm flex items-center",title:"Clear all filters"},[...t[26]||(t[26]=[(0,a.Lk)("i",{class:"fas fa-times mr-1"},null,-1),(0,a.eW)(" Clear ",-1)])])):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>Qe.refreshRecommendations&&Qe.refreshRecommendations(...e)),disabled:Qe.loading,class:"px-4 py-2.5 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm flex items-center",title:"Refresh recommendations list"},[(0,a.Lk)("i",{class:(0,a.C4)(["fas fa-sync-alt mr-2",{"animate-spin":Qe.loading}])},null,2),t[27]||(t[27]=(0,a.eW)(" Refresh ",-1))],8,k)])]),Qe.hasActiveFilters?((0,a.uX)(),(0,a.CE)("div",_,[t[31]||(t[31]=(0,a.Lk)("span",{class:"text-sm text-teal-300 mr-2"},"Active filters:",-1)),Qe.statusFilter?((0,a.uX)(),(0,a.CE)("span",y,[(0,a.eW)(" Status: "+(0,a.v_)(Qe.getStatusLabel(Qe.statusFilter))+" ",1),(0,a.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>Qe.clearStatusFilter&&Qe.clearStatusFilter(...e)),class:"ml-1 text-green-300 hover:text-white"},[...t[28]||(t[28]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0),Qe.requestTypeFilter?((0,a.uX)(),(0,a.CE)("span",w,[(0,a.eW)(" Type: "+(0,a.v_)(Qe.getRequestTypeLabel(Qe.requestTypeFilter))+" ",1),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>Qe.clearRequestTypeFilter&&Qe.clearRequestTypeFilter(...e)),class:"ml-1 text-blue-300 hover:text-white"},[...t[29]||(t[29]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0),Qe.searchQuery?((0,a.uX)(),(0,a.CE)("span",L,[(0,a.eW)(' Search: "'+(0,a.v_)(Qe.searchQuery)+'" ',1),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>Qe.clearSearch&&Qe.clearSearch(...e)),class:"ml-1 text-yellow-300 hover:text-white"},[...t[30]||(t[30]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",C,[(0,a.Lk)("div",S,[Qe.loading&&0===Qe.recommendations.length?((0,a.uX)(),(0,a.CE)("div",q,[...t[32]||(t[32]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-4xl text-teal-400 mb-4"},null,-1),(0,a.Lk)("p",{class:"text-white text-lg"},"Loading ICT Director recommendations...",-1)])])):Qe.loading||0!==Qe.filteredRecommendations.length||Qe.hasActiveFilters?!Qe.loading&&0===Qe.filteredRecommendations.length&&Qe.hasActiveFilters?((0,a.uX)(),(0,a.CE)("div",R,[t[38]||(t[38]=(0,a.Fv)('<div class="mb-6" data-v-b66498ca><i class="fas fa-search text-6xl text-gray-400 mb-4" data-v-b66498ca></i></div><h3 class="text-xl font-semibold text-white mb-2" data-v-b66498ca>No Results Found</h3><p class="text-gray-300 max-w-md mx-auto mb-4" data-v-b66498ca> No recommendations match your current search and filter criteria. </p><div class="space-y-2" data-v-b66498ca><p class="text-sm text-teal-300" data-v-b66498ca>Try:</p><ul class="text-sm text-gray-400 space-y-1 max-w-sm mx-auto" data-v-b66498ca><li data-v-b66498ca>â€¢ Clearing your search terms</li><li data-v-b66498ca>â€¢ Adjusting your filters</li><li data-v-b66498ca>â€¢ Checking different status options</li></ul></div>',4)),(0,a.Lk)("button",{onClick:t[13]||(t[13]=(...e)=>Qe.clearAllFilters&&Qe.clearAllFilters(...e)),class:"mt-6 px-6 py-3 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors border border-red-400/30"},[...t[37]||(t[37]=[(0,a.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,a.eW)(" Clear All Filters ",-1)])])])):((0,a.uX)(),(0,a.CE)("div",I,[(0,a.Lk)("div",T,[(0,a.Lk)("table",E,[t[41]||(t[41]=(0,a.Lk)("thead",{class:"bg-gradient-to-r from-blue-600/20 to-indigo-600/20 border-b border-blue-300/20"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-hashtag mr-2"}),(0,a.eW)("Request ID ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-user mr-2"}),(0,a.eW)("Staff Details ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-building mr-2"}),(0,a.eW)("Department ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-layer-group mr-2"}),(0,a.eW)("Request Type ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,a.eW)("Current Status ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-calendar mr-2"}),(0,a.eW)("Date ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-center text-sm font-semibold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-cogs mr-2"}),(0,a.eW)("Actions ")])])],-1)),(0,a.Lk)("tbody",D,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.filteredRecommendations,(e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:(0,a.C4)(["hover:bg-blue-600/10 transition-colors duration-200",s%2===0?"bg-blue-950/20":"bg-blue-950/10"])},[(0,a.Lk)("td",F,[(0,a.Lk)("div",O,[t[39]||(t[39]=(0,a.Lk)("div",{class:"w-8 h-8 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-lg flex items-center justify-center mr-3"},[(0,a.Lk)("i",{class:"fas fa-file-alt text-white text-sm"})],-1)),(0,a.Lk)("div",j,(0,a.v_)(Qe.formatRequestId(e.id)),1)])]),(0,a.Lk)("td",P,[(0,a.Lk)("div",X,(0,a.v_)(e.staff_name),1),(0,a.Lk)("div",M,(0,a.v_)(e.pf_number),1)]),(0,a.Lk)("td",N,[(0,a.Lk)("div",Q,(0,a.v_)(e.department?.name||"N/A"),1)]),(0,a.Lk)("td",W,[(0,a.Lk)("div",U,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.request_type,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"inline-flex px-2 py-1 text-sm rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/20"},(0,a.v_)(Qe.getRequestTypeLabel(e)),1))),128))])]),(0,a.Lk)("td",H,[(0,a.Lk)("span",{class:(0,a.C4)(["inline-flex px-2 py-1 text-sm font-medium rounded-md border",Qe.getStatusClass(e.current_stage||e.status)])},(0,a.v_)(Qe.getStatusLabel(e.current_stage||e.status)),3)]),(0,a.Lk)("td",B,(0,a.v_)(Qe.formatDate(e.ict_director_approved_at||e.updated_at)),1),(0,a.Lk)("td",$,[(0,a.Lk)("div",V,[(0,a.Lk)("button",{onClick:t=>Qe.viewRequestDetails(e),class:"inline-flex items-center px-3 py-1.5 text-sm font-medium rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/30 hover:bg-blue-600/50 transition-colors duration-200",title:`View details for ${Qe.formatRequestId(e.id)}`},[...t[40]||(t[40]=[(0,a.Lk)("i",{class:"fas fa-eye mr-1"},null,-1),(0,a.eW)(" View ",-1)])],8,z)])])],2))),128))])])])])):((0,a.uX)(),(0,a.CE)("div",A,[t[34]||(t[34]=(0,a.Lk)("div",{class:"mb-6"},[(0,a.Lk)("i",{class:"fas fa-book-open text-6xl text-gray-400 mb-4"})],-1)),t[35]||(t[35]=(0,a.Lk)("h3",{class:"text-xl font-semibold text-white mb-2"},"No Recommendations Found",-1)),t[36]||(t[36]=(0,a.Lk)("p",{class:"text-gray-300 max-w-md mx-auto"}," There are currently no recommendations, rejection reasons, or comments from ICT Director for requests across all departments. ",-1)),(0,a.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>Qe.refreshRecommendations&&Qe.refreshRecommendations(...e)),class:"mt-6 px-6 py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors"},[...t[33]||(t[33]=[(0,a.Lk)("i",{class:"fas fa-sync-alt mr-2"},null,-1),(0,a.eW)(" Check Again ",-1)])])])),Qe.pagination.total>Qe.pagination.per_page?((0,a.uX)(),(0,a.CE)("div",K,[(0,a.Lk)("div",J,[(0,a.Lk)("button",{onClick:t[14]||(t[14]=e=>Qe.changePage(Qe.pagination.current_page-1)),disabled:Qe.pagination.current_page<=1,class:"px-3 py-2 bg-blue-600/30 hover:bg-blue-600/50 text-blue-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...t[42]||(t[42]=[(0,a.Lk)("i",{class:"fas fa-chevron-left"},null,-1)])],8,G),(0,a.Lk)("span",Y," Page "+(0,a.v_)(Qe.pagination.current_page)+" of "+(0,a.v_)(Qe.pagination.last_page),1),(0,a.Lk)("button",{onClick:t[15]||(t[15]=e=>Qe.changePage(Qe.pagination.current_page+1)),disabled:Qe.pagination.current_page>=Qe.pagination.last_page,class:"px-3 py-2 bg-blue-600/30 hover:bg-blue-600/50 text-blue-200 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...t[43]||(t[43]=[(0,a.Lk)("i",{class:"fas fa-chevron-right"},null,-1)])],8,Z)])])):(0,a.Q3)("",!0)])])])])]),Qe.showDetailsModal?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",onClick:t[18]||(t[18]=(...e)=>Qe.closeDetailsModal&&Qe.closeDetailsModal(...e))},[(0,a.Lk)("div",{class:"backdrop-blur-md rounded-2xl border-2 border-blue-400/30 max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"},onClick:t[17]||(t[17]=(0,a.D$)(()=>{},["stop"]))},[(0,a.Lk)("div",ee,[(0,a.Lk)("div",te,[t[44]||(t[44]=(0,a.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-file-alt text-white"})],-1)),(0,a.Lk)("div",null,[(0,a.Lk)("h3",se,(0,a.v_)(Qe.formatRequestId(Qe.selectedRequest?.id)),1),(0,a.Lk)("p",ae,(0,a.v_)(Qe.selectedRequest?.staff_name)+" ("+(0,a.v_)(Qe.selectedRequest?.pf_number)+") - "+(0,a.v_)(Qe.selectedRequest?.department?.name),1)])]),(0,a.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>Qe.closeDetailsModal&&Qe.closeDetailsModal(...e)),class:"p-2 rounded-lg bg-red-600/20 hover:bg-red-600/30 text-red-300 hover:text-white transition-colors"},[...t[45]||(t[45]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])]),(0,a.Lk)("div",re,[(0,a.Lk)("div",ie,[t[51]||(t[51]=(0,a.Lk)("h4",{class:"font-semibold text-blue-200 mb-3 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,a.eW)(" Request Overview ")],-1)),(0,a.Lk)("div",oe,[(0,a.Lk)("div",le,[(0,a.Lk)("div",ne,[t[46]||(t[46]=(0,a.Lk)("span",{class:"text-gray-300"},"Current Status:",-1)),(0,a.Lk)("span",{class:(0,a.C4)(["px-2 py-1 text-sm rounded-md border",Qe.getStatusClass(Qe.selectedRequest?.current_stage||Qe.selectedRequest?.status)])},(0,a.v_)(Qe.getStatusLabel(Qe.selectedRequest?.current_stage||Qe.selectedRequest?.status)),3)]),(0,a.Lk)("div",de,[t[47]||(t[47]=(0,a.Lk)("span",{class:"text-gray-300"},"Access Type:",-1)),(0,a.Lk)("span",ce,(0,a.v_)(Qe.selectedRequest?.access_type||"N/A"),1)]),Qe.selectedRequest?.temporary_until?((0,a.uX)(),(0,a.CE)("div",ue,[t[48]||(t[48]=(0,a.Lk)("span",{class:"text-gray-300"},"Valid Until:",-1)),(0,a.Lk)("span",pe,(0,a.v_)(Qe.formatDate(Qe.selectedRequest?.temporary_until)),1)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",fe,[(0,a.Lk)("div",ge,[t[49]||(t[49]=(0,a.Lk)("span",{class:"text-gray-300"},"Request Types:",-1)),(0,a.Lk)("div",be,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedRequest?.request_type,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-2 py-1 text-sm rounded-md bg-blue-600/30 text-blue-200 border border-blue-400/20"},(0,a.v_)(Qe.getRequestTypeLabel(e)),1))),128))])]),(0,a.Lk)("div",me,[t[50]||(t[50]=(0,a.Lk)("span",{class:"text-gray-300"},"Department:",-1)),(0,a.Lk)("span",he,(0,a.v_)(Qe.selectedRequest?.department?.name||"N/A"),1)])])])]),Qe.selectedRequest?.ict_director_info?.comments||Qe.selectedRequest?.ict_director_info?.rejection_reasons?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,a.C4)(["border rounded-lg p-4","rejected"===Qe.selectedRequest?.ict_director_info?.status?"bg-gradient-to-r from-red-600/20 to-red-700/20 border-red-400/30":"bg-gradient-to-r from-teal-600/20 to-cyan-600/20 border border-teal-400/30"])},[(0,a.Lk)("div",xe,[(0,a.Lk)("div",{class:(0,a.C4)(["w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0","rejected"===Qe.selectedRequest?.ict_director_info?.status?"bg-gradient-to-br from-red-500 to-red-600":"bg-gradient-to-br from-teal-500 to-cyan-600"])},[(0,a.Lk)("i",{class:(0,a.C4)(["text-white","rejected"===Qe.selectedRequest?.ict_director_info?.status?"fas fa-times-circle":"fas fa-user-tie"])},null,2)],2),(0,a.Lk)("div",ve,[(0,a.Lk)("div",ke,[(0,a.Lk)("h4",{class:(0,a.C4)(["font-semibold","rejected"===Qe.selectedRequest?.ict_director_info?.status?"text-red-200":"text-teal-200"])}," ICT Director "+(0,a.v_)("rejected"===Qe.selectedRequest?.ict_director_info?.status?"Rejection Reasons":"Recommendations"),3),(0,a.Lk)("span",{class:(0,a.C4)(["text-sm","rejected"===Qe.selectedRequest?.ict_director_info?.status?"text-red-300":"text-teal-300"])},(0,a.v_)(Qe.selectedRequest?.ict_director_info?.approved_by||"ICT Director"),3)]),(0,a.Lk)("div",{class:(0,a.C4)(["rounded-lg p-3 mb-3","rejected"===Qe.selectedRequest?.ict_director_info?.status?"bg-red-900/20":"bg-teal-900/20"])},[(0,a.Lk)("p",_e,["rejected"===Qe.selectedRequest?.ict_director_info?.status?((0,a.uX)(),(0,a.CE)("span",ye,(0,a.v_)(Qe.selectedRequest?.ict_director_info?.rejection_reasons||Qe.selectedRequest?.ict_director_info?.comments||"No rejection reasons provided"),1)):((0,a.uX)(),(0,a.CE)("span",we,(0,a.v_)(Qe.selectedRequest?.ict_director_info?.comments||"No comments provided"),1))])],2),(0,a.Lk)("div",Le,[t[52]||(t[52]=(0,a.Lk)("i",{class:"fas fa-calendar mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(Qe.formatDate(Qe.selectedRequest?.ict_director_info?.approved_at||Qe.selectedRequest?.updated_at)),1)])])])],2)):(0,a.Q3)("",!0),Qe.selectedRequest?.head_it_info?.comments?((0,a.uX)(),(0,a.CE)("div",Ce,[(0,a.Lk)("div",Se,[t[55]||(t[55]=(0,a.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-full flex items-center justify-center flex-shrink-0"},[(0,a.Lk)("i",{class:"fas fa-user-cog text-white"})],-1)),(0,a.Lk)("div",qe,[(0,a.Lk)("div",Ae,[t[53]||(t[53]=(0,a.Lk)("h4",{class:"font-semibold text-purple-200"},"Head of IT Response",-1)),(0,a.Lk)("span",Re,(0,a.v_)(Qe.selectedRequest?.head_it_info?.approved_by||"Head of IT"),1)]),(0,a.Lk)("div",Ie,[(0,a.Lk)("p",Te,(0,a.v_)(Qe.selectedRequest?.head_it_info?.comments||"No response provided"),1)]),(0,a.Lk)("div",Ee,[t[54]||(t[54]=(0,a.Lk)("i",{class:"fas fa-calendar mr-1"},null,-1)),(0,a.eW)(" "+(0,a.v_)(Qe.formatDate(Qe.selectedRequest?.head_it_info?.approved_at)),1)])])])])):(0,a.Q3)("",!0),Qe.hasModules(Qe.selectedRequest)?((0,a.uX)(),(0,a.CE)("div",De,[t[59]||(t[59]=(0,a.Lk)("h4",{class:"font-semibold text-purple-200 mb-3 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-cube mr-2"}),(0,a.eW)(" Modules & Services Requested ")],-1)),(0,a.Lk)("div",Fe,[Qe.selectedRequest?.wellsoft_modules_selected?.length?((0,a.uX)(),(0,a.CE)("div",Oe,[t[56]||(t[56]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Wellsoft Modules:",-1)),(0,a.Lk)("div",je,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedRequest.wellsoft_modules_selected,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-yellow-600/30 text-yellow-200 text-sm rounded-lg border border-yellow-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0),Qe.selectedRequest?.jeeva_modules_selected?.length?((0,a.uX)(),(0,a.CE)("div",Pe,[t[57]||(t[57]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Jeeva Modules:",-1)),(0,a.Lk)("div",Xe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedRequest.jeeva_modules_selected,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-purple-600/30 text-purple-200 text-sm rounded-lg border border-purple-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0),Qe.selectedRequest?.internet_purposes?.length?((0,a.uX)(),(0,a.CE)("div",Me,[t[58]||(t[58]=(0,a.Lk)("span",{class:"text-base text-gray-300 font-medium"},"Internet Access Purposes:",-1)),(0,a.Lk)("div",Ne,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Qe.selectedRequest.internet_purposes,e=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:"px-3 py-1 bg-green-600/30 text-green-200 text-sm rounded-lg border border-green-400/30"},(0,a.v_)(e),1))),128))])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0)])}s(8111),s(2489);var We=s(5498),Ue=s(8966),He=s(1127),Be=s(9729),$e={name:"HeadOfItDictRecommendations",components:{Header:We.A,ModernSidebar:Ue.A},setup(){const{requireRole:e,ROLES:t}=(0,He.h)(),s=(0,a.KR)(!1),r=(0,a.KR)([]),i=(0,a.KR)({current_page:1,last_page:1,per_page:10,total:0}),o=(0,a.KR)(""),l=(0,a.KR)(""),n=(0,a.KR)(""),d=(0,a.KR)(null),c=(0,a.KR)(!1),u=(0,a.KR)(null),p={jeeva_access:"Jeeva Access",wellsoft:"Wellsoft",internet_access_request:"Internet Access"},f={pending:"Pending",pending_hod:"Pending HOD",hod_approved:"HOD Approved",hod_rejected:"HOD Rejected",pending_divisional:"Pending Divisional",divisional_approved:"Divisional Approved",divisional_rejected:"Divisional Rejected",pending_ict_director:"Pending ICT Director",ict_director_approved:"ICT Director Approved",ict_director_rejected:"ICT Director Rejected",pending_head_it:"Pending Head IT",head_it_approved:"Head IT Approved",head_it_rejected:"Head IT Rejected",pending_ict_officer:"Pending ICT Officer",ict_officer_rejected:"ICT Officer Rejected",implemented:"Implemented",completed:"Completed",rejected:"Rejected",unknown:"Status Unknown"},g=(0,a.EW)(()=>r.value.length),b=(0,a.EW)(()=>{let e=[...r.value];if(o.value){const t=o.value.toLowerCase().trim();e=e.filter(e=>(e.staff_name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.id||"").toString().includes(t)||`#${e.id}`.toLowerCase().includes(t)||I(e.id).toLowerCase().includes(t))}return l.value&&(e=e.filter(e=>e.current_stage===l.value||e.status===l.value)),n.value&&(e=e.filter(e=>{const t=Array.isArray(e.request_type)?e.request_type:[e.request_type];return t.includes(n.value)})),e.sort((e,t)=>{const s=new Date(e.ict_director_approved_at||e.updated_at||0),a=new Date(t.ict_director_approved_at||t.updated_at||0);return a-s})}),m=(0,a.EW)(()=>!!(o.value||l.value||n.value)),h=()=>{d.value&&clearTimeout(d.value),d.value=setTimeout(()=>{o.value,w(1)},300)},x=()=>{l.value,n.value,w(1)},v=()=>{o.value="",w(1)},k=()=>{o.value="",l.value="",n.value="",w(1)},_=()=>{l.value="",x()},y=()=>{n.value="",x()},w=async(e=1)=>{try{s.value=!0;const t={page:e,per_page:10};o.value&&o.value.trim()&&(t.search=o.value.trim()),l.value&&(t.status=l.value),n.value&&(t.request_type=n.value);const a=await Be.A.getDictRecommendations(t);a.success?(a.data.data,r.value=a.data.data||[],i.value=a.data.pagination||{current_page:1,last_page:1,per_page:10,total:a.data.data?.length||0}):(console.error("âŒ API returned error:",a.message),r.value=[])}catch(t){console.error("ðŸ’¥ Error fetching DICT recommendations:",t),r.value=[]}finally{s.value=!1}},L=()=>{w(i.value.current_page)},C=e=>{e>=1&&e<=i.value.last_page&&w(e)},S=e=>p[e]||e,q=e=>e?f[e]||e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()):"No Status",A=e=>{const t={pending:"bg-yellow-600/30 text-yellow-200 border-yellow-400/30",pending_hod:"bg-orange-600/30 text-orange-200 border-orange-400/30",hod_approved:"bg-blue-600/30 text-blue-200 border-blue-400/30",hod_rejected:"bg-red-500/30 text-red-200 border-red-400/30",pending_divisional:"bg-purple-600/30 text-purple-200 border-purple-400/30",divisional_approved:"bg-green-600/30 text-green-200 border-green-400/30",divisional_rejected:"bg-red-600/30 text-red-200 border-red-400/30",pending_ict_director:"bg-indigo-600/30 text-indigo-200 border-indigo-400/30",ict_director_approved:"bg-teal-600/30 text-teal-200 border-teal-400/30",ict_director_rejected:"bg-red-600/30 text-red-200 border-red-400/30",pending_head_it:"bg-purple-700/30 text-purple-200 border-purple-500/30",head_it_approved:"bg-pink-600/30 text-pink-200 border-pink-400/30",head_it_rejected:"bg-red-700/30 text-red-200 border-red-500/30",pending_ict_officer:"bg-blue-700/30 text-blue-200 border-blue-500/30",ict_officer_rejected:"bg-red-800/30 text-red-200 border-red-600/30",implemented:"bg-green-700/30 text-green-100 border-green-500/30",completed:"bg-green-800/30 text-green-100 border-green-600/30",rejected:"bg-red-600/30 text-red-200 border-red-400/30",unknown:"bg-gray-600/30 text-gray-200 border-gray-400/30"};return t[e]||"bg-gray-600/30 text-gray-200 border-gray-400/30"},R=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return e}},I=e=>e?`REQ-${e.toString().padStart(6,"0")}`:"N/A",T=e=>e?.wellsoft_modules_selected&&e.wellsoft_modules_selected.length>0||e?.jeeva_modules_selected&&e.jeeva_modules_selected.length>0||e?.internet_purposes&&e.internet_purposes.length>0,E=e=>{u.value=e,c.value=!0},D=()=>{c.value=!1,u.value=null};return(0,a.sV)(()=>{e([t.HEAD_OF_IT]),w()}),{loading:s,recommendations:r,pagination:i,refreshRecommendations:L,changePage:C,getRequestTypeLabel:S,getStatusLabel:q,getStatusClass:A,formatDate:R,formatRequestId:I,hasModules:T,searchQuery:o,statusFilter:l,requestTypeFilter:n,filteredRecommendations:b,totalRecommendations:g,hasActiveFilters:m,debouncedSearch:h,applyFilters:x,clearSearch:v,clearAllFilters:k,clearStatusFilter:_,clearRequestTypeFilter:y,showDetailsModal:c,selectedRequest:u,viewRequestDetails:E,closeDetailsModal:D}}},Ve=s(1241);const ze=(0,Ve.A)($e,[["render",Qe],["__scopeId","data-v-b66498ca"]]);var Ke=ze},9877:function(e,t,s){s.r(t),s.d(t,{default:function(){return Qe}});s(8111),s(116);var a=s(5796);const r={class:"flex flex-col h-screen"},i={class:"flex flex-1 overflow-hidden"},o={class:"sidebar-narrow"},l={class:"flex-1 p-2 relative bg-blue-900 overflow-visible",style:{background:"linear-gradient(\n            135deg,\n            #1e3a8a 0%,\n            #1e40af 25%,\n            #1d4ed8 50%,\n            #1e40af 75%,\n            #1e3a8a 100%\n          )"}},n={class:"absolute inset-0 overflow-visible pointer-events-none"},d={class:"absolute inset-0 opacity-5"},c={class:"grid grid-cols-12 gap-8 h-full transform rotate-45"},u={class:"max-w-full mx-auto relative z-10 px-4"},p={key:0,class:"medical-glass-card rounded-none border-t-0 border-b border-green-300/30"},f={key:1,class:"medical-glass-card rounded-none border-t-0 border-b border-blue-300/30"},g={class:"p-4 bg-red-600/20 border border-red-400/30 rounded-lg"},b={class:"text-lg text-red-200"},m={key:2,class:"medical-glass-card rounded-none border-t-0 border-b border-blue-300/30"},h={class:"p-4 bg-blue-600/20 border border-blue-400/30 rounded-lg flex items-start gap-3"},x={class:"flex-1"},v={class:"text-blue-100 text-base"},k={class:"font-semibold"},_={key:0,class:"ml-2 text-blue-200/80"},y={key:1,class:"ml-2"},w=["disabled"],L={key:0,class:"fas fa-spinner fa-spin mr-2"},C={key:1,class:"fas fa-times mr-2"},S={class:"medical-glass-card rounded-t-3xl border-b border-blue-300/30"},q={class:"p-4"},A={class:"flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between"},R={class:"flex gap-3 items-center flex-1 max-w-2xl"},I={class:"flex-1"},T={class:"relative"},E={class:"flex flex-wrap gap-3 items-center"},D={class:"relative"},F=["disabled"],O={class:"medical-glass-card rounded-b-3xl overflow-visible relative"},j={class:"p-6"},P={key:0,class:"text-center py-12"},X={key:1,class:"overflow-visible rounded-xl border border-blue-300/20"},M={class:"overflow-x-auto overflow-visible relative"},N={class:"w-full"},Q={class:"divide-y divide-blue-300/10"},W={class:"px-6 py-4 text-white text-xl font-semibold"},U={class:"px-6 py-4"},H={class:"flex items-center space-x-3"},B={class:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center"},$={class:"text-white font-bold text-base"},V={class:"text-white font-semibold text-xl"},z={class:"text-blue-300 text-lg"},K={class:"px-6 py-4"},J={class:"text-white text-xl font-mono"},G={class:"px-6 py-4"},Y={class:"text-white text-xl"},Z={class:"px-6 py-4"},ee={class:"px-6 py-4"},te={class:"flex items-center space-x-2"},se={class:"px-6 py-4 text-center relative overflow-visible"},ae={class:"flex justify-center three-dot-menu"},re=["onClick","aria-label"],ie={key:0,class:"text-center py-12"},oe={class:"text-blue-300 text-xl"},le={key:1,class:"bg-blue-800/30 px-6 py-3 border-t border-blue-300/20"},ne={class:"text-blue-300 text-xl font-medium"},de={key:3,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4"},ce={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-300 scale-100"},ue={class:"px-6 py-6"},pe={class:"text-gray-700 text-lg mb-6 text-center"},fe={class:"font-semibold text-blue-600"},ge={class:"flex gap-3"},be=["disabled"],me={key:0,class:"fas fa-spinner fa-spin mr-2"},he={key:1,class:"fas fa-check mr-2"},xe=["disabled"],ve={key:4,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4"},ke={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full transform transition-all duration-500 scale-100"},_e={class:"px-6 py-6 text-center"},ye={class:"text-gray-700 text-lg mb-6"},we={class:"font-semibold text-blue-600"},Le={key:0,class:"fixed inset-0 bg-black/60 flex items-center justify-center z-[10002] backdrop-blur-sm"},Ce={class:"bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden"},Se={class:"p-6 text-center"},qe={class:"text-gray-700 text-lg mb-6"},Ae={class:"font-semibold text-red-600"},Re={class:"flex gap-3"},Ie=["disabled"],Te={key:0,class:"fas fa-spinner fa-spin mr-2"},Ee=["disabled"],De=["disabled","title"];function Fe(e,t,s,Fe,Oe,je){const Pe=(0,a.g2)("Header"),Xe=(0,a.g2)("ModernSidebar");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(Pe),(0,a.Lk)("div",i,[(0,a.Lk)("div",o,[(0,a.bF)(Xe)]),(0,a.Lk)("main",l,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(48,e=>(0,a.Lk)("div",{key:e,class:"bg-white rounded-full w-2 h-2 animate-pulse",style:(0,a.Tr)({animationDelay:.1*e+"s"})},null,4)),64))])])]),(0,a.Lk)("div",u,[Oe.isLoading||!Oe.requestInfo||je.canAssign?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",p,[...t[18]||(t[18]=[(0,a.Fv)('<div class="p-4 bg-green-600/20 border border-green-400/30 rounded-lg flex items-start gap-3" data-v-82ada2d2><div class="w-8 h-8 rounded-full bg-green-500/30 flex items-center justify-center flex-shrink-0" data-v-82ada2d2><i class="fas fa-check text-green-300" data-v-82ada2d2></i></div><div data-v-82ada2d2><h3 class="font-bold text-lg text-green-200" data-v-82ada2d2>Already Implemented</h3><p class="text-green-100 text-base" data-v-82ada2d2> This request has already been implemented by the assigned ICT officer. Task assignment is disabled. </p></div></div>',1)])])),Oe.error?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",g,[t[19]||(t[19]=(0,a.Lk)("h3",{class:"font-bold text-xl text-red-300"},"Error",-1)),(0,a.Lk)("p",b,(0,a.v_)(Oe.error),1),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>je.fetchIctOfficers&&je.fetchIctOfficers(...e)),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 text-base font-medium"}," Retry ")])])):(0,a.Q3)("",!0),!Oe.isLoading&&Oe.requestInfo?.assigned_ict_officer_id?((0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("div",h,[t[22]||(t[22]=(0,a.Lk)("div",{class:"w-8 h-8 rounded-full bg-blue-500/30 flex items-center justify-center flex-shrink-0"},[(0,a.Lk)("i",{class:"fas fa-user-check text-blue-300"})],-1)),(0,a.Lk)("div",x,[t[20]||(t[20]=(0,a.Lk)("h3",{class:"font-bold text-lg text-blue-200"},"Currently assigned to",-1)),(0,a.Lk)("p",v,[(0,a.Lk)("span",k,(0,a.v_)(je.currentAssignee?.name||"ICT Officer #"+Oe.requestInfo.assigned_ict_officer_id),1),je.currentAssignee?.pf_number?((0,a.uX)(),(0,a.CE)("span",_,"(PF: "+(0,a.v_)(je.currentAssignee.pf_number)+")",1)):(0,a.Q3)("",!0),Oe.requestInfo.task_assigned_at?((0,a.uX)(),(0,a.CE)("span",y,"â€” since "+(0,a.v_)(new Date(Oe.requestInfo.task_assigned_at).toLocaleString("en-GB")),1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",null,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>je.openCancelModal(je.currentAssignee)),disabled:Oe.isAssigning,class:"px-4 py-2 bg-red-600/30 hover:bg-red-600/50 text-red-100 rounded-lg transition-colors border border-red-400/30 text-base flex items-center",title:"Cancel current assignment"},[Oe.isAssigning?((0,a.uX)(),(0,a.CE)("i",L)):((0,a.uX)(),(0,a.CE)("i",C)),t[21]||(t[21]=(0,a.eW)(" Cancel Task ",-1))],8,w)])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",S,[(0,a.Lk)("div",q,[(0,a.Lk)("div",A,[(0,a.Lk)("div",R,[(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>je.goBack&&je.goBack(...e)),class:"p-2.5 rounded-lg bg-teal-600/20 hover:bg-teal-600/30 transition-colors flex-shrink-0",title:"Back to request"},[...t[23]||(t[23]=[(0,a.Lk)("i",{class:"fas fa-arrow-left text-teal-300 hover:text-white"},null,-1)])]),(0,a.Lk)("div",I,[(0,a.Lk)("div",T,[t[25]||(t[25]=(0,a.Lk)("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-search text-teal-300"})],-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>Oe.searchQuery=e),type:"text",placeholder:"Search by name, PF number, or phone number...",class:"w-full pl-10 pr-4 py-3 bg-white/10 border border-teal-300/30 rounded-lg focus:border-teal-400 focus:outline-none text-white text-lg placeholder-teal-200/60 backdrop-blur-sm transition-colors"},null,512),[[a.Jo,Oe.searchQuery]]),Oe.searchQuery?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[4]||(t[4]=(...e)=>je.clearSearch&&je.clearSearch(...e)),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-teal-300 hover:text-white"},[...t[24]||(t[24]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)])])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",E,[(0,a.Lk)("div",D,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>Oe.statusFilter=e),class:"appearance-none bg-white/10 border border-teal-300/30 rounded-lg px-4 py-3 pr-10 text-white text-base focus:border-teal-400 focus:outline-none backdrop-blur-sm cursor-pointer"},[...t[26]||(t[26]=[(0,a.Fv)('<option value="" class="bg-blue-900 text-white" data-v-82ada2d2>All Officers</option><option value="Available" class="bg-blue-900 text-white" data-v-82ada2d2>Available</option><option value="Assigned" class="bg-blue-900 text-white" data-v-82ada2d2>Assigned</option><option value="Busy" class="bg-blue-900 text-white" data-v-82ada2d2>Busy</option><option value="Completed" class="bg-blue-900 text-white" data-v-82ada2d2>Completed</option>',5)])],512),[[a.u1,Oe.statusFilter]]),t[27]||(t[27]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none"},[(0,a.Lk)("i",{class:"fas fa-chevron-down text-teal-300"})],-1))]),Oe.searchQuery||Oe.statusFilter?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[6]||(t[6]=(...e)=>je.clearAllFilters&&je.clearAllFilters(...e)),class:"px-4 py-3 bg-red-600/30 hover:bg-red-600/50 text-red-200 rounded-lg transition-colors border border-red-400/30 text-base flex items-center",title:"Clear all filters"},[...t[28]||(t[28]=[(0,a.Lk)("i",{class:"fas fa-times mr-1"},null,-1),(0,a.eW)(" Clear ",-1)])])):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>je.refreshOfficers&&je.refreshOfficers(...e)),disabled:Oe.isLoading,class:"px-5 py-3 bg-teal-600 hover:bg-teal-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-base flex items-center",title:"Refresh officers list"},[(0,a.Lk)("i",{class:(0,a.C4)(["fas fa-sync-alt mr-2",{"animate-spin":Oe.isLoading}])},null,2),t[29]||(t[29]=(0,a.eW)(" Refresh ",-1))],8,F)])])])]),(0,a.Lk)("div",O,[(0,a.Lk)("div",j,[Oe.isLoading?((0,a.uX)(),(0,a.CE)("div",P,[...t[30]||(t[30]=[(0,a.Lk)("i",{class:"fas fa-spinner fa-spin text-4xl text-teal-400 mb-4"},null,-1),(0,a.Lk)("p",{class:"text-white text-xl"},"Loading ICT Officers...",-1)])])):((0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",M,[(0,a.Lk)("table",N,[t[33]||(t[33]=(0,a.Lk)("thead",{class:"bg-gradient-to-r from-blue-600/20 to-indigo-600/20 border-b border-blue-300/20"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-hashtag mr-2"}),(0,a.eW)("S/N ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-user mr-2"}),(0,a.eW)("Full Name ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-id-card mr-2"}),(0,a.eW)("PF Number ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-phone mr-2"}),(0,a.eW)("Phone Number ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,a.eW)("Status ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-left text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-sms mr-2"}),(0,a.eW)("SMS Status ")]),(0,a.Lk)("th",{class:"px-6 py-4 text-center text-xl font-bold text-blue-200 uppercase tracking-wider"},[(0,a.Lk)("i",{class:"fas fa-cogs mr-2"}),(0,a.eW)("Actions ")])])],-1)),(0,a.Lk)("tbody",Q,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(je.filteredOfficers,(e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id,class:(0,a.C4)(["hover:bg-blue-600/10 transition-colors duration-200",s%2===0?"bg-blue-950/20":"bg-blue-950/10"])},[(0,a.Lk)("td",W,(0,a.v_)(s+1),1),(0,a.Lk)("td",U,[(0,a.Lk)("div",H,[(0,a.Lk)("div",B,[(0,a.Lk)("span",$,(0,a.v_)(je.getInitials(e.name)),1)]),(0,a.Lk)("div",null,[(0,a.Lk)("p",V,(0,a.v_)(e.name),1),(0,a.Lk)("p",z,(0,a.v_)(e.position||"ICT Officer"),1)])])]),(0,a.Lk)("td",K,[(0,a.Lk)("span",J,(0,a.v_)(e.pf_number||"N/A"),1)]),(0,a.Lk)("td",G,[(0,a.Lk)("span",Y,(0,a.v_)(e.phone_number||"N/A"),1)]),(0,a.Lk)("td",Z,[(0,a.Lk)("span",{class:(0,a.C4)([je.getStatusBadgeClass(e.status),"px-4 py-2 rounded-full text-lg font-semibold"])},(0,a.v_)(e.status||"Available"),3)]),(0,a.Lk)("td",ee,[(0,a.Lk)("div",te,[(0,a.Lk)("div",{class:(0,a.C4)(["w-4 h-4 rounded-full",je.getSmsStatusColor(e.sms_status)])},null,2),(0,a.Lk)("span",{class:(0,a.C4)(["text-xl font-semibold",je.getSmsStatusTextColor(e.sms_status)])},(0,a.v_)(je.getSmsStatusText(e.sms_status)),3)])]),(0,a.Lk)("td",se,[t[32]||(t[32]=(0,a.Lk)("div",{style:{position:"relative","z-index":"1"}},null,-1)),(0,a.Lk)("div",ae,[(0,a.Lk)("button",{onClick:t=>je.toggleDropdown(e.id,t),class:(0,a.C4)(["three-dot-button p-2 text-white hover:bg-blue-600/40 rounded-full transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:scale-105 active:scale-95",{"bg-blue-600/40 shadow-lg":Oe.openDropdownId===e.id}]),"aria-label":"Actions for officer "+e.name,ref_for:!0,ref:"button-"+e.id},[...t[31]||(t[31]=[(0,a.Lk)("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[(0,a.Lk)("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],10,re)])])],2))),128))])])]),0===je.filteredOfficers.length?((0,a.uX)(),(0,a.CE)("div",ie,[t[34]||(t[34]=(0,a.Lk)("div",{class:"w-16 h-16 bg-blue-500/20 rounded-full flex items-center justify-center mx-auto mb-4"},[(0,a.Lk)("i",{class:"fas fa-users text-blue-400 text-2xl"})],-1)),t[35]||(t[35]=(0,a.Lk)("h3",{class:"text-white text-3xl font-semibold mb-2"},"No ICT Officers Found",-1)),(0,a.Lk)("p",oe,(0,a.v_)(Oe.searchQuery||Oe.statusFilter?"No officers match your current filters.":"No ICT officers available at this time."),1)])):(0,a.Q3)("",!0),je.filteredOfficers.length>0?((0,a.uX)(),(0,a.CE)("div",le,[(0,a.Lk)("p",ne," Showing "+(0,a.v_)(je.filteredOfficers.length)+" of "+(0,a.v_)(Oe.ictOfficers.length)+" officers ",1)])):(0,a.Q3)("",!0)]))])]),Oe.showConfirmModal?((0,a.uX)(),(0,a.CE)("div",de,[(0,a.Lk)("div",ce,[t[38]||(t[38]=(0,a.Lk)("div",{class:"px-6 py-4 text-center rounded-t-2xl",style:{background:"linear-gradient(135deg, #0f52ba 0%, #1e3a8a 100%)"}},[(0,a.Lk)("div",{class:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-lg"},[(0,a.Lk)("i",{class:"fas fa-question text-2xl",style:{color:"#0f52ba"}})]),(0,a.Lk)("h3",{class:"text-xl font-bold text-white"},"Confirm Assignment")],-1)),(0,a.Lk)("div",ue,[(0,a.Lk)("p",pe,[t[36]||(t[36]=(0,a.eW)(" Are you sure you want to assign this task to ",-1)),(0,a.Lk)("span",fe,(0,a.v_)(Oe.selectedOfficer?.name),1),t[37]||(t[37]=(0,a.eW)("? ",-1))]),(0,a.Lk)("div",ge,[(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>je.assignTask&&je.assignTask(...e)),disabled:Oe.isAssigning,class:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 transition duration-200 text-xl font-semibold flex items-center justify-center"},[Oe.isAssigning?((0,a.uX)(),(0,a.CE)("i",me)):((0,a.uX)(),(0,a.CE)("i",he)),(0,a.eW)(" "+(0,a.v_)(Oe.isAssigning?"Assigning...":"Yes, Assign"),1)],8,be),(0,a.Lk)("button",{onClick:t[9]||(t[9]=e=>Oe.showConfirmModal=!1),disabled:Oe.isAssigning,class:"flex-1 bg-gray-500 text-white py-3 px-4 rounded-lg hover:bg-gray-600 transition duration-200 text-xl font-semibold"}," Cancel ",8,xe)])])])])):(0,a.Q3)("",!0),Oe.showSuccessModal?((0,a.uX)(),(0,a.CE)("div",ve,[(0,a.Lk)("div",ke,[t[41]||(t[41]=(0,a.Lk)("div",{class:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 text-center rounded-t-2xl"},[(0,a.Lk)("div",{class:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-3 shadow-lg"},[(0,a.Lk)("i",{class:"fas fa-check text-green-600 text-2xl"})]),(0,a.Lk)("h3",{class:"text-2xl font-bold text-white"},"Task Assigned!")],-1)),(0,a.Lk)("div",_e,[(0,a.Lk)("p",ye,[t[39]||(t[39]=(0,a.eW)(" Task successfully assigned to ",-1)),(0,a.Lk)("span",we,(0,a.v_)(Oe.assignedOfficer?.name),1),t[40]||(t[40]=(0,a.eW)(". ",-1))]),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>je.goBackToRequests&&je.goBackToRequests(...e)),class:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3 px-6 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 text-lg"}," Back to Requests ")])])])):(0,a.Q3)("",!0)]),Oe.showCancelModal?((0,a.uX)(),(0,a.CE)("div",Le,[(0,a.Lk)("div",Ce,[t[45]||(t[45]=(0,a.Lk)("div",{class:"bg-gradient-to-r from-red-600 via-red-700 to-red-800 p-6 text-center shadow-lg"},[(0,a.Lk)("div",{class:"w-16 h-16 bg-red-500/30 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm border border-red-300/40 shadow-lg"},[(0,a.Lk)("i",{class:"fas fa-exclamation-triangle text-white text-2xl"})]),(0,a.Lk)("h3",{class:"text-xl font-bold text-white mb-2"},"Cancel Task Assignment")],-1)),(0,a.Lk)("div",Se,[(0,a.Lk)("p",qe,[t[42]||(t[42]=(0,a.eW)(" Are you sure you want to cancel the task assigned to ",-1)),(0,a.Lk)("span",Ae,(0,a.v_)(Oe.cancelTarget?.name||"Current ICT Officer"),1),t[43]||(t[43]=(0,a.eW)("? ",-1))]),(0,a.Lk)("div",Re,[(0,a.Lk)("button",{onClick:t[11]||(t[11]=e=>je.cancelTask(Oe.cancelTarget)),disabled:Oe.isCancelling,class:"flex-1 bg-red-600 text-white py-3 px-4 rounded-xl font-semibold hover:bg-red-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105"},[Oe.isCancelling?((0,a.uX)(),(0,a.CE)("i",Te)):(0,a.Q3)("",!0),t[44]||(t[44]=(0,a.eW)(" Confirm Cancel ",-1))],8,Ie),(0,a.Lk)("button",{onClick:t[12]||(t[12]=e=>Oe.showCancelModal=!1),disabled:Oe.isCancelling,class:"flex-1 bg-gray-200 text-gray-800 py-3 px-4 rounded-xl font-semibold hover:bg-gray-300 transition-all duration-200"}," Keep Assignment ",8,Ee)])])])])):(0,a.Q3)("",!0),(0,a.bo)((0,a.Lk)("div",{class:"fixed inset-0 pointer-events-none",style:{"z-index":"99999"},onClick:t[17]||(t[17]=(...e)=>je.closeAllDropdowns&&je.closeAllDropdowns(...e))},[(0,a.Lk)("div",{class:"dropdown-menu-portal pointer-events-auto fixed bg-white rounded-lg shadow-xl border border-gray-200 py-1",style:(0,a.Tr)({top:Oe.dropdownCoords.top+"px",left:Oe.dropdownCoords.left+"px",zIndex:1e5,minWidth:"12rem",maxWidth:"16rem",maxHeight:"240px",overflowY:"auto",boxShadow:"0 10px 25px rgba(0,0,0,0.15), 0 4px 6px rgba(0,0,0,0.1)"}),onClick:t[16]||(t[16]=(0,a.D$)(()=>{},["stop"]))},[Oe.requestInfo?.assigned_ict_officer_id||"Assigned"===Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)?.status?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[13]||(t[13]=(0,a.D$)(e=>je.executeAction("assign_task",Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)),["stop"])),disabled:!je.canAssign||"Busy"===Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)?.status||Oe.isAssigning,title:je.canAssign?"":"This request has already been implemented and cannot be reassigned",class:"w-full text-left px-4 py-3 text-xl bg-green-50 text-green-800 border-b border-green-200 hover:bg-green-100 focus:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-inset transition-all duration-200 flex items-center space-x-3 group disabled:opacity-50 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:text-gray-500 first:rounded-t-lg"},[...t[46]||(t[46]=[(0,a.Lk)("i",{class:"fas fa-user-plus text-green-600 group-hover:text-green-700 group-focus:text-green-700 w-4 h-4 flex-shrink-0 transition-colors duration-200 text-xl"},null,-1),(0,a.Lk)("span",{class:"font-semibold"},"Assign Task",-1)])],8,De)),je.hasActiveIctAssignment&&"Assigned"!==Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)?.status?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[14]||(t[14]=(0,a.D$)(e=>je.confirmAssignTask(Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId),{reassign:!0}),["stop"])),class:"w-full text-left px-4 py-3 text-xl bg-amber-50 text-amber-800 border-b border-amber-200 hover:bg-amber-100 focus:bg-amber-100 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-inset transition-all duration-200 flex items-center space-x-3 group"},[...t[47]||(t[47]=[(0,a.Lk)("i",{class:"fas fa-exchange-alt text-amber-600 w-4 h-4"},null,-1),(0,a.Lk)("span",{class:"font-semibold"},"Reassign Task",-1)])])):(0,a.Q3)("",!0),"Assigned"===Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)?.status?((0,a.uX)(),(0,a.CE)("button",{key:2,onClick:t[15]||(t[15]=(0,a.D$)(e=>je.openCancelModal(Oe.ictOfficers.find(e=>e.id===Oe.openDropdownId)),["stop"])),class:"w-full text-left px-4 py-3 text-xl bg-red-50 text-red-800 hover:bg-red-100 focus:bg-red-100 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-inset transition-all duration-200 flex items-center space-x-3 group last:rounded-b-lg"},[...t[48]||(t[48]=[(0,a.Lk)("i",{class:"fas fa-times text-red-600 group-hover:text-red-700 group-focus:text-red-700 w-4 h-4 flex-shrink-0 transition-colors duration-200 text-xl"},null,-1),(0,a.Lk)("span",{class:"font-semibold"},"Cancel Task",-1)])])):(0,a.Q3)("",!0)],4)],512),[[a.aG,Oe.openDropdownId]])])])])}s(4114),s(2489),s(1701),s(3579);var Oe=s(5498),je=s(8966),Pe=s(9729),Xe={name:"SelectIctOfficer",components:{Header:Oe.A,ModernSidebar:je.A},data(){return{requestId:null,requestInfo:null,ictOfficers:[],searchQuery:"",statusFilter:"",isLoading:!1,error:null,showConfirmModal:!1,showSuccessModal:!1,selectedOfficer:null,assignedOfficer:null,isAssigning:!1,showCancelModal:!1,cancelTarget:null,isCancelling:!1,openDropdownId:null,dropdownCoords:{top:0,left:0},dropdownPlacement:"below",dropdownWidth:192,isReassign:!1}},computed:{canAssign(){const e=this.requestInfo?.ict_officer_status||this.requestInfo?.status,t="implemented"===e;return!t},currentAssignee(){if(!this.requestInfo?.assigned_ict_officer_id){const e=this.ictOfficers.find(e=>"Assigned"===e.status);return e||null}return this.ictOfficers.find(e=>e.id===this.requestInfo.assigned_ict_officer_id)||null},hasActiveIctAssignment(){return!(!this.requestInfo?.assigned_ict_officer_id&&!this.ictOfficers.some(e=>"Assigned"===e.status))},filteredOfficers(){let e=[...this.ictOfficers];if(this.searchQuery.trim()){const t=this.searchQuery.toLowerCase();e=e.filter(e=>(e.name||"").toLowerCase().includes(t)||(e.pf_number||"").toLowerCase().includes(t)||(e.phone_number||"").toLowerCase().includes(t))}return this.statusFilter&&(e=e.filter(e=>(e.status||"Available")===this.statusFilter)),e.sort((e,t)=>{const s=e.status||"Available",a=t.status||"Available";return"Available"===s&&"Available"!==a?-1:"Available"!==s&&"Available"===a?1:(e.name||"").localeCompare(t.name||"")})}},async mounted(){this.requestId=this.$route.params.id,this.requestId?(await Promise.all([this.fetchRequestInfo(),this.fetchIctOfficers()]),document.addEventListener("click",this.closeAllDropdowns)):this.error="No request ID provided"},beforeUnmount(){document.removeEventListener("click",this.closeAllDropdowns)},methods:{async fetchRequestInfo(){try{const e=await Pe.A.getRequestById(this.requestId);e.success&&(this.requestInfo=e.data)}catch(e){console.error("Error fetching request info:",e)}},async fetchIctOfficers(){this.isLoading=!0,this.error=null;try{const e=await Pe.A.getIctOfficers(this.requestId);e.success?this.ictOfficers=e.data||[]:this.error=e.message}catch(e){this.error="Failed to load ICT officers"}finally{this.isLoading=!1}},async refreshOfficers(){await this.fetchIctOfficers()},confirmAssignTask(e,t={}){this.selectedOfficer=e,this.isReassign=!0===t.reassign,this.showConfirmModal=!0},async assignTask(){if(this.selectedOfficer){this.isAssigning=!0;try{const t=await Pe.A.assignTaskToIctOfficer(this.requestId,this.selectedOfficer.id,this.selectedOfficer?.phone_number||this.selectedOfficer?.phone||null,this.isReassign);if(t.success){this.assignedOfficer=this.selectedOfficer,this.showConfirmModal=!1,this.showSuccessModal=!0,this.isReassign=!1,this.requestInfo={...this.requestInfo||{},assigned_ict_officer_id:this.selectedOfficer.id,task_assigned_at:(new Date).toISOString()},this.showToast("Task assigned successfully","success");try{const e=sessionStorage.getItem("headOfIt_smsStatusCache"),t=e?JSON.parse(e):{};t[this.requestId]="sent",sessionStorage.setItem("headOfIt_smsStatusCache",JSON.stringify(t))}catch(e){console.warn("HeadOfIT: failed to persist SMS status cache",e)}const t=this.ictOfficers.findIndex(e=>e.id===this.selectedOfficer.id);-1!==t&&(this.ictOfficers[t].status="Assigned",this.ictOfficers[t].sms_status="sent"),setTimeout(()=>{this.fetchIctOfficers()},2e3)}else alert("Failed to assign task: "+t.message)}catch(t){alert("Error assigning task: "+t.message)}finally{this.isAssigning=!1}}},viewProgress(e){alert(`Viewing progress for ${e.name} - Feature coming soon!`)},showToast(e,t="success"){const s=document.createElement("div");s.className="fixed top-4 right-4 toast-notification",s.style.zIndex=9999;const a="error"===t?"bg-red-600":"bg-green-600";s.innerHTML=`\n          <div class="${a} text-white px-4 py-3 rounded-xl shadow-xl font-semibold">\n            ${e}\n          </div>\n        `,document.body.appendChild(s),setTimeout(()=>{s.remove()},2500)},openCancelModal(e){this.cancelTarget=e||{id:this.requestInfo?.assigned_ict_officer_id,name:"Current ICT Officer"},this.showCancelModal=!0},async cancelTask(e){try{this.isCancelling=!0;const t=await Pe.A.cancelTaskAssignment(this.requestId);if(t.success){if(e?.id){const t=this.ictOfficers.findIndex(t=>t.id===e.id);-1!==t&&(this.ictOfficers[t].status="Available")}this.requestInfo={...this.requestInfo||{},assigned_ict_officer_id:null,task_assigned_at:null},this.showCancelModal=!1,this.showToast("Task assignment cancelled","success")}else this.showToast("Failed to cancel task: "+t.message,"error")}catch(t){this.showToast("Error cancelling task: "+(t.message||"Network error"),"error")}finally{this.isCancelling=!1}},getInitials(e){return e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"NA"},getStatusBadgeClass(e){const t={Available:"bg-green-500 text-green-900",Assigned:"bg-blue-500 text-blue-900",Busy:"bg-yellow-500 text-yellow-900",Completed:"bg-gray-500 text-gray-900"};return t[e]||t["Available"]},getSmsStatusText(e){const t={sent:"Delivered",pending:"Pending",failed:"Failed"};return t[e]||"has no task"},getSmsStatusColor(e){const t={sent:"bg-green-500",pending:"bg-yellow-500",failed:"bg-red-500"};return t[e]||"bg-gray-400"},getSmsStatusTextColor(e){const t={sent:"text-green-400",pending:"text-yellow-400",failed:"text-red-400"};return t[e]||"text-gray-400"},hasService(e,t){return!!e?.request_types&&(Array.isArray(e.request_types)?e.request_types.some(e=>e.toLowerCase().includes(t.toLowerCase())):"string"===typeof e.request_types&&e.request_types.toLowerCase().includes(t.toLowerCase()))},goBack(){this.$router.push(`/head_of_it-dashboard/both-service-form/${this.requestId}`)},goBackToRequests(){this.$router.push("/head_of_it-dashboard/combined-requests")},clearSearch(){this.searchQuery=""},clearAllFilters(){this.searchQuery="",this.statusFilter=""},toggleDropdown(e,t){t?.stopPropagation();const s=this.openDropdownId!==e;if(this.openDropdownId=s?e:null,s)try{const e=t?.target?.closest(".three-dot-button");if(!e)return this.dropdownPlacement="below",void(this.dropdownCoords={top:0,left:0});const s=e.getBoundingClientRect(),a=window.innerHeight,r=window.innerWidth,i=a-s.bottom,o=s.top,l=180,n=this.dropdownWidth;this.dropdownPlacement=i<l&&o>i?"above":"below";let d=s.right-n;d=Math.max(8,Math.min(d,r-n-8));let c="below"===this.dropdownPlacement?s.bottom+8:s.top-l-8;c=Math.max(8,Math.min(c,a-8)),this.dropdownCoords={top:c,left:d}}catch(a){this.dropdownPlacement="below",this.dropdownCoords={top:0,left:0}}},calculateDropdownPosition(e){if(!e||!e.target)return;const t=e.target.closest(".three-dot-button");if(!t)return;const s=t.getBoundingClientRect(),a=window.innerWidth<=768,r=a?160:192,i=120;let o=s.bottom+8,l=s.right-r;const n=window.innerWidth,d=window.innerHeight,c=window.pageYOffset||document.documentElement.scrollTop;o+=c,l<10?l=10:l+r>n-10&&(l=n-r-10),a&&(l=Math.max(10,Math.min(l,n-r-10)));const u=d-(s.bottom-c);u<i+20&&(o=s.top+c-i-8),o<c+10&&(o=c+10),this.dropdownPosition={top:o,left:l}},closeAllDropdowns(e){e&&(e.target.closest(".dropdown-menu")||e.target.closest(".three-dot-button"))||(this.openDropdownId=null)},executeAction(e,t){switch(t.id,this.openDropdownId=null,e){case"assign_task":this.confirmAssignTask(t);break;case"view_progress":this.viewProgress(t);break;case"cancel_task":this.cancelTask(t);break;default:console.warn("Unknown action:",e)}}}},Me=s(1241);const Ne=(0,Me.A)(Xe,[["render",Fe],["__scopeId","data-v-82ada2d2"]]);var Qe=Ne}}]);
//# sourceMappingURL=head-of-it.d5070e17.js.map