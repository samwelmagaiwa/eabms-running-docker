"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[9332],{8369:function(e,t,s){s.r(t),s.d(t,{default:function(){return xe}});var r=s(5796);const a={class:"flex flex-col h-screen"},o={class:"flex flex-1 overflow-hidden"},l={class:"flex-1 p-2 bg-blue-900 overflow-y-auto relative z-0"},i={class:"absolute inset-0 overflow-hidden"},n={class:"absolute inset-0"},d={key:0,class:"absolute inset-0 z-40 flex items-center justify-center pointer-events-none animate-fade-in"},c={class:"max-w-full mx-auto relative z-10"},u={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},p={class:"grid grid-cols-4 gap-4 mb-6"},b={class:"bg-yellow-600/25 border border-yellow-400/40 p-4 rounded-lg"},h={class:"text-white text-3xl font-bold"},v={class:"bg-green-600/25 border border-green-400/40 p-4 rounded-lg"},f={class:"text-white text-3xl font-bold"},g={class:"bg-red-600/25 border border-red-400/40 p-4 rounded-lg"},m={class:"text-white text-3xl font-bold"},x={class:"bg-blue-600/25 border border-blue-400/40 p-4 rounded-lg"},y={class:"text-white text-3xl font-bold"},w={class:"bg-white/10 rounded-lg p-4 mb-6"},k={class:"flex flex-col md:flex-row gap-4"},L={key:1,class:"bg-gradient-to-r from-rose-600/25 to-red-600/25 border-2 border-red-400/40 rounded-2xl backdrop-blur-sm overflow-hidden mb-4 animate-slide-up"},q={class:"p-4 flex items-center justify-between"},_={class:"flex items-center"},R={class:"text-sm font-bold text-white"},S={class:"flex items-center space-x-3"},D={class:"bg-white/10 rounded-lg"},C={class:"relative z-0"},A={class:"w-full table-fixed"},E=["data-request-id"],j={class:"px-1 py-3"},T={class:"flex justify-center"},F=["value","disabled"],I={class:"px-1 py-3 text-sm"},B={class:"truncate text-white font-bold"},N={class:"px-1 py-3 text-sm"},M={class:"truncate text-white font-bold"},Q={class:"truncate text-blue-300 text-xs"},z={class:"px-1 py-3 text-sm"},P={class:"truncate text-white font-bold"},X={class:"px-1 py-3 text-sm"},$={class:"truncate text-white font-bold"},U={class:"px-1 py-3 text-sm"},H={class:"truncate text-white font-bold"},V={class:"px-1 py-3 text-sm text-center"},W={class:"flex flex-col items-center space-y-1"},O={key:0,class:"fas fa-check-circle text-green-400 text-lg"},K={key:1,class:"fas fa-times-circle text-red-400 text-lg"},G={key:2,class:"px-1.5 py-0.5 rounded-[10px] text-[10px] font-semibold bg-emerald-900/30 text-emerald-300 border border-emerald-500/40"},J={class:"px-1 py-3 text-sm"},Y={class:"flex flex-col space-y-1"},Z={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-semibold bg-red-900/30 text-red-300 border border-red-500/40"},ee={class:"px-1 py-3 text-sm"},te={class:"px-1 py-3 text-sm text-center"},se={class:"px-2 py-2 text-center"},re={class:"relative inline-block"},ae=["onClick"],oe={class:"relative z-10 flex items-center"},le=["onClick"],ie=["onClick"],ne={key:0,class:"text-center py-12"},de={class:"text-blue-300"},ce={key:0,class:"px-6 py-4 border-t border-blue-300/30 flex items-center justify-between relative z-0"},ue={class:"text-sm text-blue-300"};function pe(e,t,s,pe,be,he){const ve=(0,r.g2)("Header"),fe=(0,r.g2)("ModernSidebar"),ge=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.bF)(ve),(0,r.Lk)("div",o,[(0,r.bF)(fe),(0,r.Lk)("main",l,[(0,r.Lk)("div",i,[(0,r.Lk)("div",n,[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(15,e=>(0,r.Lk)("div",{key:e,class:"absolute text-white opacity-5 animate-float",style:(0,r.Tr)({left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:3*Math.random()+2+"s",fontSize:15*Math.random()+8+"px"})},[(0,r.Lk)("i",{class:(0,r.C4)(["fas",["fa-laptop","fa-tv","fa-desktop","fa-keyboard","fa-mouse","fa-headphones"][Math.floor(6*Math.random())]])},null,2)],4)),64))])]),be.isLoading?((0,r.uX)(),(0,r.CE)("div",d,[...t[7]||(t[7]=[(0,r.Fv)('<div class="pointer-events-auto w-full max-w-lg mx-auto" data-v-0e8dc0d7><div class="relative bg-gradient-to-br from-white/20 via-blue-50/30 to-white/10 border-2 border-blue-300/50 backdrop-blur-xl rounded-3xl p-8 shadow-2xl overflow-hidden" data-v-0e8dc0d7><div class="absolute inset-0 opacity-10" data-v-0e8dc0d7><div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent animate-slide-across" data-v-0e8dc0d7></div><div class="absolute top-4 left-4 w-16 h-16 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.2);" data-v-0e8dc0d7></div><div class="absolute bottom-4 right-4 w-20 h-20 bg-blue-400/20 rounded-full animate-float" style="animation-delay:1s;" data-v-0e8dc0d7></div><div class="absolute top-1/2 left-8 w-12 h-12 rounded-full animate-float" style="background:rgba(255, 0, 0, 0.15);animation-delay:2s;" data-v-0e8dc0d7></div></div><div class="relative z-10" data-v-0e8dc0d7><div class="flex items-center justify-center gap-6 mb-6" data-v-0e8dc0d7><div class="relative" data-v-0e8dc0d7><div class="w-16 h-16 bg-gradient-to-br from-blue-500/30 to-teal-500/30 rounded-2xl backdrop-blur-sm border-2 border-blue-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300" data-v-0e8dc0d7><img src="/assets/images/ngao2.png" alt="National Shield" class="max-w-12 max-h-12 object-contain drop-shadow-lg" data-v-0e8dc0d7></div><div class="absolute -inset-1 bg-gradient-to-r from-blue-400 to-teal-400 rounded-2xl opacity-20 blur-sm animate-pulse" data-v-0e8dc0d7></div></div><div class="relative flex flex-col items-center" data-v-0e8dc0d7><div class="relative mb-3" data-v-0e8dc0d7><div class="rounded-full h-12 w-12 border-2 border-gray-300/20" data-v-0e8dc0d7></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-top-color:#ff0000;animation-duration:2s;" data-v-0e8dc0d7></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-bottom-color:#0000d1;animation-direction:reverse;animation-duration:1.5s;" data-v-0e8dc0d7></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-right-color:rgba(255, 0, 0, 0.7);animation-duration:2.5s;" data-v-0e8dc0d7></div><div class="absolute inset-0 animate-spin rounded-full h-12 w-12 border-4 border-transparent shadow-lg" style="border-left-color:rgba(0, 0, 209, 0.7);animation-direction:reverse;animation-duration:1.8s;" data-v-0e8dc0d7></div></div><div class="text-center" data-v-0e8dc0d7><div class="text-white font-medium text-sm font-bold tracking-wide mb-1 drop-shadow-md" data-v-0e8dc0d7> Loading Device Requests </div><div class="text-blue-300 text-xs animate-pulse" data-v-0e8dc0d7>Please wait...</div></div></div><div class="relative" data-v-0e8dc0d7><div class="w-16 h-16 bg-gradient-to-br from-teal-500/30 to-blue-500/30 rounded-2xl backdrop-blur-sm border-2 border-teal-300/50 flex items-center justify-center shadow-xl hover:scale-105 transition-transform duration-300" data-v-0e8dc0d7><img src="/assets/images/logo2.png" alt="MNH Logo" class="max-w-12 max-h-12 object-contain drop-shadow-lg" data-v-0e8dc0d7></div><div class="absolute -inset-1 bg-gradient-to-r from-teal-400 to-blue-400 rounded-2xl opacity-20 blur-sm animate-pulse" style="animation-delay:0.5s;" data-v-0e8dc0d7></div></div></div><div class="text-center border-t border-blue-300/30 pt-4" data-v-0e8dc0d7><div class="text-sm font-black tracking-widest mb-1 drop-shadow-sm" style="color:#ff0000;" data-v-0e8dc0d7> MUHIMBILI NATIONAL HOSPITAL </div><div class="text-teal-200 text-sm font-semibold tracking-wider" data-v-0e8dc0d7> ICT DEVICE REQUESTS MANAGEMENT </div></div><div class="flex justify-center gap-2 mt-4" data-v-0e8dc0d7><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;" data-v-0e8dc0d7></div><div class="w-2 h-2 bg-blue-400 rounded-full animate-bounce" style="animation-delay:0.1s;" data-v-0e8dc0d7></div><div class="w-2 h-2 rounded-full animate-bounce" style="background:#ff0000;animation-delay:0.2s;" data-v-0e8dc0d7></div><div class="w-2 h-2 bg-blue-300 rounded-full animate-bounce" style="animation-delay:0.3s;" data-v-0e8dc0d7></div></div></div></div></div>',1)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",c,[be.error?((0,r.uX)(),(0,r.CE)("div",u,[t[8]||(t[8]=(0,r.Lk)("h3",{class:"font-bold"},"Error",-1)),(0,r.Lk)("p",null,(0,r.v_)(be.error),1),(0,r.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>he.fetchRequests&&he.fetchRequests(...e)),class:"mt-2 bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700"}," Retry ")])):(0,r.Q3)("",!0),(0,r.Lk)("div",p,[(0,r.Lk)("div",b,[t[9]||(t[9]=(0,r.Lk)("h3",{class:"text-yellow-200 text-lg font-bold"},"Pending",-1)),(0,r.Lk)("p",h,(0,r.v_)(be.stats.pending),1)]),(0,r.Lk)("div",v,[t[10]||(t[10]=(0,r.Lk)("h3",{class:"text-green-200 text-lg font-bold"},"Approved",-1)),(0,r.Lk)("p",f,(0,r.v_)(be.stats.approved),1)]),(0,r.Lk)("div",g,[t[11]||(t[11]=(0,r.Lk)("h3",{class:"text-red-200 text-lg font-bold"},"Rejected",-1)),(0,r.Lk)("p",m,(0,r.v_)(be.stats.rejected),1)]),(0,r.Lk)("div",x,[t[12]||(t[12]=(0,r.Lk)("h3",{class:"text-blue-200 text-lg font-bold"},"Total Requests",-1)),(0,r.Lk)("p",y,(0,r.v_)(be.stats.total),1)])]),(0,r.Lk)("div",w,[(0,r.Lk)("div",k,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>be.searchQuery=e),type:"text",placeholder:"Search by borrower name, department, or device...",class:"flex-1 px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white placeholder-blue-200/60 text-base"},null,512),[[r.Jo,be.searchQuery]]),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>be.ictStatusFilter=e),class:"px-4 py-3 bg-white/20 border border-blue-300/30 rounded text-white text-base"},[...t[13]||(t[13]=[(0,r.Lk)("option",{value:""},"All ICT Status",-1),(0,r.Lk)("option",{value:"pending"},"Pending ICT",-1),(0,r.Lk)("option",{value:"approved"},"Approved",-1),(0,r.Lk)("option",{value:"rejected"},"Rejected",-1)])],512),[[r.u1,be.ictStatusFilter]]),(0,r.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>he.refreshRequests&&he.refreshRequests(...e)),class:"px-6 py-3 bg-teal-600 text-white rounded hover:bg-teal-700 text-base font-bold"},[...t[14]||(t[14]=[(0,r.Lk)("i",{class:"fas fa-sync-alt mr-2"},null,-1),(0,r.eW)(" Refresh ",-1)])])])]),be.selectedRequests.length>0?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("div",q,[(0,r.Lk)("div",_,[t[16]||(t[16]=(0,r.Lk)("div",{class:"w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center mr-3"},[(0,r.Lk)("i",{class:"fas fa-trash text-white"})],-1)),(0,r.Lk)("div",null,[(0,r.Lk)("h3",R,(0,r.v_)(be.selectedRequests.length)+" Request"+(0,r.v_)(be.selectedRequests.length>1?"s":"")+" Selected ",1),t[15]||(t[15]=(0,r.Lk)("p",{class:"text-sm text-red-200"},"Ready for bulk deletion",-1))])]),(0,r.Lk)("div",S,[(0,r.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>he.clearSelection&&he.clearSelection(...e)),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors duration-200 text-sm"},[...t[17]||(t[17]=[(0,r.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,r.eW)(" Clear Selection ",-1)])]),(0,r.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>he.bulkDeleteRequests&&he.bulkDeleteRequests(...e)),class:"px-4 py-2 bg-gradient-to-r from-red-600 to-rose-600 text-white rounded-lg hover:from-red-700 hover:to-rose-700 transition-all duration-200 text-sm font-medium shadow-lg hover:shadow-xl transform hover:scale-105"},[t[18]||(t[18]=(0,r.Lk)("i",{class:"fas fa-trash mr-2"},null,-1)),(0,r.eW)(" Delete Selected ("+(0,r.v_)(be.selectedRequests.length)+") ",1)])])])])):(0,r.Q3)("",!0),(0,r.Lk)("div",D,[(0,r.Lk)("div",C,[(0,r.Lk)("table",A,[t[27]||(t[27]=(0,r.Lk)("thead",{class:"bg-blue-800/50"},[(0,r.Lk)("tr",null,[(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-12"},"Select"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-24"},"ID"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-32"}," Borrower "),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-24"}," Department "),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-20"},"Device"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-20"},"Date"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-16"},"Sign"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-20"},"Status"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-20"},"Return"),(0,r.Lk)("th",{class:"px-1 py-3 text-left text-blue-100 text-sm font-bold w-16"},"SMS"),(0,r.Lk)("th",{class:"px-1 py-3 text-center text-blue-100 text-sm font-bold w-20"}," Actions ")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(he.filteredRequests,e=>((0,r.uX)(),(0,r.CE)("tr",{key:e.id,"data-request-id":e.id,class:(0,r.C4)(["border-t border-blue-300/20 hover:bg-blue-700/30 transition-colors duration-200",{"bg-blue-600/20":be.selectedRequests.includes(e.id)}])},[(0,r.Lk)("td",j,[(0,r.Lk)("div",T,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",value:e.id,"onUpdate:modelValue":t[6]||(t[6]=e=>be.selectedRequests=e),disabled:!he.canDeleteRequest(e),class:(0,r.C4)(["w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2",{"opacity-50 cursor-not-allowed":!he.canDeleteRequest(e)}])},null,10,F),[[r.lH,be.selectedRequests]])])]),(0,r.Lk)("td",I,[(0,r.Lk)("div",B,(0,r.v_)(e.request_id||`REQ-${e.id.toString().padStart(4,"0")}`),1)]),(0,r.Lk)("td",N,[(0,r.Lk)("div",M,(0,r.v_)(e.borrower_name||e.borrowerName||"Unknown"),1),(0,r.Lk)("div",Q,(0,r.v_)(e.borrower_phone||e.phoneNumber||"No phone"),1)]),(0,r.Lk)("td",z,[(0,r.Lk)("div",P,(0,r.v_)(e.department||"Unknown"),1)]),(0,r.Lk)("td",X,[(0,r.Lk)("div",$,(0,r.v_)(e.device_name||he.getDeviceDisplayName(e.device_type||e.deviceType,e.custom_device||e.customDevice,e.device_inventory_ids||e._raw?.device_inventory_ids)),1)]),(0,r.Lk)("td",U,[(0,r.Lk)("div",H,(0,r.v_)(he.formatDate(e.booking_date||e.bookingDate)),1)]),(0,r.Lk)("td",V,[(0,r.Lk)("div",W,[e.has_signature||e.signature?((0,r.uX)(),(0,r.CE)("i",O)):((0,r.uX)(),(0,r.CE)("i",K)),e.has_signature||e.signature?((0,r.uX)(),(0,r.CE)("span",G," Digitally signed ")):(0,r.Q3)("",!0)])]),(0,r.Lk)("td",J,[(0,r.Lk)("div",Y,["skipped"===e.divisional_status?((0,r.uX)(),(0,r.CE)("span",Z," No Divisional Director â€” Stage Skipped ")):(0,r.Q3)("",!0),(0,r.Lk)("span",{class:(0,r.C4)([he.getStatusBadgeClass(e.ict_approve||"pending"),"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold self-start"])},(0,r.v_)(he.getStatusText(e.ict_approve||"pending")),3)])]),(0,r.Lk)("td",ee,[(0,r.Lk)("span",{class:(0,r.C4)([he.getReturnStatusBadgeClass(e.return_status||"not_yet_returned"),"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold"])},(0,r.v_)(he.getReturnStatusText(e.return_status||"not_yet_returned")),3)]),(0,r.Lk)("td",te,[(0,r.Lk)("span",{class:(0,r.C4)([he.getSMSStatusBadgeClass(e.sms_status||"not_sent"),"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold"])},(0,r.v_)(he.getSMSStatusText(e.sms_status||"not_sent")),3)]),(0,r.Lk)("td",se,[(0,r.Lk)("div",re,[(0,r.Lk)("button",{onClick:t=>he.toggleActionsDropdown(e.id),class:"relative inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white text-sm font-medium rounded-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-1 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 group overflow-hidden"},[t[21]||(t[21]=(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-blue-500 via-cyan-500 to-blue-600 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),t[22]||(t[22]=(0,r.Lk)("div",{class:"absolute inset-0 -skew-x-12 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[200%] transition-transform duration-600"},null,-1)),(0,r.Lk)("div",oe,[t[19]||(t[19]=(0,r.Lk)("i",{class:"fas fa-eye text-sm mr-2 group-hover:animate-pulse"},null,-1)),t[20]||(t[20]=(0,r.Lk)("span",{class:"font-medium"},"Actions",-1)),(0,r.Lk)("i",{class:(0,r.C4)(["fas fa-chevron-down ml-2 text-xs transition-all duration-200 group-hover:text-cyan-200",{"rotate-180 text-cyan-300":be.openDropdown===e.id}])},null,2)]),t[23]||(t[23]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-lg border border-blue-400/50 group-hover:border-cyan-400/70 transition-colors duration-200"},null,-1))],8,ae),(0,r.bF)(r.eB,{"enter-active-class":"transition ease-out duration-300","enter-from-class":"opacity-0 scale-90 translate-y-2 rotate-3","enter-to-class":"opacity-100 scale-100 translate-y-0 rotate-0","leave-active-class":"transition ease-in duration-200","leave-from-class":"opacity-100 scale-100 translate-y-0 rotate-0","leave-to-class":"opacity-0 scale-90 translate-y-2 rotate-3"},{default:(0,r.k6)(()=>[be.openDropdown===e.id?((0,r.uX)(),(0,r.CE)("div",{key:0,class:(0,r.C4)(["absolute right-0 w-52 bg-gradient-to-br from-white via-gray-50 to-blue-50 rounded-xl shadow-xl border border-blue-200/50 z-[99999] overflow-hidden backdrop-blur-sm",he.getDropdownPositionClass(e.id)]),style:{"box-shadow":"0 10px 25px -5px rgba(0, 0, 0, 0.15),\n                                0 0 0 1px rgba(59, 130, 246, 0.1),\n                                inset 0 1px 0 rgba(255, 255, 255, 0.1)"}},[(0,r.bF)(ge,{to:`${he.detailRouteBase}/request/${e.id}`,onClick:he.closeDropdown,class:"relative flex items-center px-2 py-1.5 text-sm bg-gradient-to-r from-blue-500 to-blue-600 text-white hover:from-blue-600 hover:to-blue-700 transition-all duration-200 group overflow-hidden border-b border-blue-400/30 rounded-sm"},{default:(0,r.k6)(()=>[...t[24]||(t[24]=[(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[200%] transition-transform duration-500"},null,-1),(0,r.Lk)("i",{class:"fas fa-eye text-xs mr-2 relative z-10"},null,-1),(0,r.Lk)("span",{class:"font-medium relative z-10"},"View Details",-1),(0,r.Lk)("i",{class:"fas fa-arrow-right text-xs ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200 relative z-10"},null,-1)])]),_:1},8,["to","onClick"]),he.shouldShowRejectButton(e)?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t=>he.rejectRequest(e.id),class:"relative w-full flex items-center px-2 py-1.5 text-sm bg-gradient-to-r from-orange-500 to-orange-600 text-white hover:from-orange-600 hover:to-orange-700 transition-all duration-200 group overflow-hidden border-b border-orange-400/30 rounded-sm"},[...t[25]||(t[25]=[(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[200%] transition-transform duration-500"},null,-1),(0,r.Lk)("i",{class:"fas fa-times text-xs mr-2 relative z-10"},null,-1),(0,r.Lk)("span",{class:"font-medium relative z-10"},"Reject Request",-1),(0,r.Lk)("i",{class:"fas fa-ban text-xs ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200 relative z-10"},null,-1)])],8,le)):(0,r.Q3)("",!0),he.shouldShowDeleteButton(e)?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:t=>he.deleteRequest(e.id),class:"relative w-full flex items-center px-2 py-1.5 text-sm bg-gradient-to-r from-red-600 to-red-700 text-white hover:from-red-700 hover:to-red-800 transition-all duration-200 group overflow-hidden rounded-sm"},[...t[26]||(t[26]=[(0,r.Lk)("div",{class:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[200%] transition-transform duration-500"},null,-1),(0,r.Lk)("i",{class:"fas fa-trash text-xs mr-2 relative z-10"},null,-1),(0,r.Lk)("span",{class:"font-medium relative z-10"},"Delete Request",-1),(0,r.Lk)("i",{class:"fas fa-skull-crossbones text-xs ml-auto opacity-0 group-hover:opacity-100 transition-opacity duration-200 relative z-10"},null,-1)])],8,ie)):(0,r.Q3)("",!0)],2)):(0,r.Q3)("",!0)]),_:2},1024)])])],10,E))),128))])]),0===he.filteredRequests.length?((0,r.uX)(),(0,r.CE)("div",ne,[t[28]||(t[28]=(0,r.Lk)("div",{class:"w-24 h-24 bg-gradient-to-br from-blue-500/20 to-teal-500/20 rounded-full flex items-center justify-center mx-auto mb-4"},[(0,r.Lk)("i",{class:"fas fa-inbox text-blue-300 text-3xl"})],-1)),t[29]||(t[29]=(0,r.Lk)("h3",{class:"text-lg font-medium text-white mb-2"},"No requests found",-1)),(0,r.Lk)("p",de,(0,r.v_)(be.searchQuery||be.ictStatusFilter?"Try adjusting your filters":"No device borrowing requests have been submitted yet."),1)])):(0,r.Q3)("",!0)]),he.filteredRequests.length>0?((0,r.uX)(),(0,r.CE)("div",ce,[(0,r.Lk)("div",ue," Showing "+(0,r.v_)(he.filteredRequests.length)+" of "+(0,r.v_)(be.requests.length)+" requests ",1),t[30]||(t[30]=(0,r.Lk)("div",{class:"flex space-x-2"},null,-1))])):(0,r.Q3)("",!0)])])])])])}s(4114),s(8111),s(2489),s(1701);var be=s(5498),he=s(8966),ve=s(4466),fe={name:"RequestsList",components:{Header:be.A,ModernSidebar:he.A},setup(){return{}},data(){return{requests:[],searchQuery:"",ictStatusFilter:"",deviceTypeFilter:"",departmentFilter:"",isLoading:!1,openDropdown:null,isProcessing:!1,stats:{pending:0,approved:0,rejected:0,returned:0,compromised:0,total:0},showApprovalModal:!1,approvalNotes:"",selectedRequestId:null,actionType:null,searchDebounce:null,selectedRequests:[],selectAll:!1,error:null}},computed:{detailRouteBase(){const e=this.$route.path||"";return e.startsWith("/secretary-approval/")?"/secretary-approval":"/ict-approval"},filteredRequests(){let e=this.requests;if(this.searchQuery){const t=this.searchQuery.toLowerCase();e=e.filter(e=>(e.borrower_name||e.borrowerName||"").toLowerCase().includes(t)||(e.department||"").toLowerCase().includes(t)||(e.device_name||this.getDeviceDisplayName(e.device_type||e.deviceType,e.custom_device||e.customDevice,e.device_inventory_ids||e._raw?.device_inventory_ids)).toLowerCase().includes(t)||(e.request_id||"").toLowerCase().includes(t))}return this.ictStatusFilter&&(e=e.filter(e=>(e.ict_approve||"pending")===this.ictStatusFilter)),e}},async mounted(){try{await this.fetchRequests(),document.addEventListener("click",this.closeAllDropdowns)}catch(e){console.error("RequestsList: Error during mount:",e),this.error="Failed to initialize component: "+e.message,this.isLoading=!1}},watch:{ictStatusFilter:{handler(){this.fetchRequests()},immediate:!1},searchQuery:{handler(){clearTimeout(this.searchDebounce),this.searchDebounce=setTimeout(()=>{this.fetchRequests()},300)},immediate:!1}},beforeUnmount(){this.searchDebounce&&clearTimeout(this.searchDebounce),document.removeEventListener("click",this.closeAllDropdowns)},methods:{async fetchRequests(){this.isLoading=!0,this.error=null;try{const e=await ve.A.getAllRequests({search:this.searchQuery||void 0,device_type:this.deviceTypeFilter||void 0,department:this.departmentFilter||void 0,ict_status:this.ictStatusFilter||void 0,per_page:50});if(!e.success)throw console.error("Failed to fetch requests:",e.message),new Error(e.message||"Failed to fetch requests");this.requests=e.data.data||[],this.requests.length,this.requests,await this.fetchStatistics()}catch(e){console.error("Error fetching requests:",e),this.error=e.message||"Unable to load device borrowing requests. Please check your connection and try again.",this.requests=[],this.calculateStats()}finally{this.isLoading=!1}},async fetchStatistics(){this.calculateStats()},calculateStats(){this.stats={pending:this.requests.filter(e=>"pending"===e.ict_approve).length,approved:this.requests.filter(e=>"approved"===e.ict_approve).length,rejected:this.requests.filter(e=>"rejected"===e.ict_approve).length,returned:this.requests.filter(e=>"returned"===e.status).length,compromised:this.requests.filter(e=>"compromised"===e.status).length,total:this.requests.length}},async refreshRequests(){await this.fetchRequests()},viewRequest(e){this.$router.push(`${this.detailRouteBase}/request/${e}`)},getDeviceDisplayName(e,t,s=[]){return ve.A.getDeviceDisplayName(e,t,s)},formatDate(e){return ve.A.formatDate(e)},getStatusBadgeClass(e){return ve.A.getStatusBadgeClass(e)},getStatusIcon(e){return ve.A.getStatusIcon(e)},getStatusText(e){return ve.A.getStatusText(e)},getReturnStatusBadgeClass(e){return ve.A.getReturnStatusBadgeClass(e)},getReturnStatusIcon(e){return ve.A.getReturnStatusIcon(e)},getReturnStatusText(e){return ve.A.getReturnStatusText(e)},getSMSStatusBadgeClass(e){const t={sent:"bg-green-100 text-green-800",not_sent:"bg-gray-100 text-gray-800",failed:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"};return t[e]||t["not_sent"]},getSMSStatusText(e){const t={sent:"Sent",not_sent:"Not Sent",failed:"Failed",pending:"Pending"};return t[e]||"Not Sent"},toggleActionsDropdown(e){this.openDropdown=this.openDropdown===e?null:e},getDropdownPositionClass(e){const t=document.querySelector(`tr[data-request-id="${e}"]`);if(!t)return"top-full mt-2";const s=150,r=t.getBoundingClientRect();let a=t.closest(".bg-white\\/10.rounded-lg.overflow-hidden");if(a){const e=a.getBoundingClientRect(),t=e.bottom-r.bottom,o=r.top-e.top;if(t<s&&o>t)return"bottom-full mb-2"}else{const e=window.innerHeight,t=e-r.bottom,a=r.top;if(t<s&&a>t)return"bottom-full mb-2"}return"top-full mt-2"},closeDropdown(){this.openDropdown=null},closeAllDropdowns(e){e&&(e.target.closest(".fixed.w-52")||e.target.closest('button[class*="from-blue-600"]'))||(this.openDropdown=null)},shouldShowRejectButton(e){const t=(e.ict_approve||"").toLowerCase(),s=(e.return_status||"").toLowerCase(),r=["returned","returned_but_compromised"].includes(s);return!r&&("approved"!==t&&"rejected"!==t)},shouldShowDeleteButton(e){const t=(e.ict_approve||"").toLowerCase(),s=(e.return_status||"").toLowerCase(),r=["returned","returned_but_compromised"].includes(s);return!r&&("approved"!==t&&this.canDeleteRequest(e))},async rejectRequest(e){try{this.selectedRequestId=e,this.actionType="reject";const t=confirm("Are you sure you want to reject this device borrowing request?");if(!t)return;const s=prompt("Please provide a rejection reason (required):");if(!s||""===s.trim())return void alert("Rejection reason is required");this.isProcessing=!0,this.closeDropdown();const r=await ve.A.rejectRequest(e,s);if(!r.success)throw new Error(r.message||"Failed to reject request");{const t=this.requests.findIndex(t=>t.id===e);-1!==t&&(this.requests[t].ict_approve="rejected",this.requests[t].ict_notes=s,this.requests[t].ict_approved_at=(new Date).toISOString()),this.calculateStats(),alert("Device borrowing request rejected successfully!")}}catch(t){console.error("Error rejecting request:",t),alert("Error rejecting request: "+t.message)}finally{this.isProcessing=!1,this.selectedRequestId=null,this.actionType=null}},async deleteRequest(e){try{this.selectedRequestId=e,this.actionType="delete";const t=confirm("Are you sure you want to permanently delete this device borrowing request? This action cannot be undone.");if(!t)return;this.isProcessing=!0,this.closeDropdown();const s=await ve.A.deleteRequest(e);if(!s.success)throw new Error(s.message||"Failed to delete request");{const t=this.requests.findIndex(t=>t.id===e);-1!==t&&this.requests.splice(t,1),this.selectedRequests=this.selectedRequests.filter(t=>t!==e),this.calculateStats(),alert("Device borrowing request deleted successfully!")}}catch(t){console.error("Error deleting request:",t),alert("Error deleting request: "+t.message)}finally{this.isProcessing=!1,this.selectedRequestId=null,this.actionType=null}},toggleSelectAll(){this.selectAll?this.selectedRequests=this.filteredRequests.filter(e=>this.canDeleteRequest(e)).map(e=>e.id):this.selectedRequests=[]},clearSelection(){this.selectedRequests=[],this.selectAll=!1},canDeleteRequest(e){return ve.A.canDeleteRequest(e)},async bulkDeleteRequests(){try{if(0===this.selectedRequests.length)return void alert("No requests selected for deletion.");const e=confirm(`Are you sure you want to permanently delete ${this.selectedRequests.length} selected request${this.selectedRequests.length>1?"s":""}? This action cannot be undone.`);if(!e)return;this.isProcessing=!0,this.actionType="bulk-delete";const t=await ve.A.bulkDeleteRequests(this.selectedRequests);if(!t.success)throw new Error(t.message||"Failed to delete requests");{const e=t.data.deleted_count||0,s=t.data.failed_count||0;if(t.data.deleted_requests){const e=t.data.deleted_requests.map(e=>e.id);this.requests=this.requests.filter(t=>!e.includes(t.id))}this.clearSelection(),this.calculateStats();let r=`Bulk deletion completed. ${e} request${e>1?"s":""} deleted successfully.`;s>0&&(r+=` ${s} request${s>1?"s":""} could not be deleted.`),alert(r),t.data,s>0&&t.data.failed_requests&&console.warn("Failed deletions:",t.data.failed_requests)}}catch(e){console.error("Error in bulk deletion:",e),alert("Error deleting requests: "+e.message)}finally{this.isProcessing=!1,this.actionType=null}}}},ge=s(1241);const me=(0,ge.A)(fe,[["render",pe],["__scopeId","data-v-0e8dc0d7"]]);var xe=me}}]);
//# sourceMappingURL=9332.b376c541.js.map