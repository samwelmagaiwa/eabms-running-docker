"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[1075,7338],{1075:function(e,t,a){a.r(t);var r=a(4373);const s="http://127.0.0.1:8000/api";class o{constructor(){this.api=r.A.create({baseURL:s,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),this.api.interceptors.request.use(e=>{const t=localStorage.getItem("auth_token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))}async sign(e){const t=await this.api.post("/documents/sign",{document_id:e});return{success:!0,data:t.data}}async list(e){const t=await this.api.get(`/documents/${e}/signatures`);return{success:!0,data:t.data.data}}async verify(e){const t=await this.api.get(`/signatures/${e}/verify`);return{success:t.data.success,data:t.data}}}t["default"]=new o},9257:function(e,t,a){a.r(t),a.d(t,{default:function(){return it}});var r=a(5796);const s={class:"flex flex-col h-screen"},o={class:"flex flex-1 overflow-hidden"},i={class:"flex-1 p-3 bg-gradient-to-br from-blue-900 via-blue-800 to-teal-900 overflow-y-auto relative"},n={class:"absolute inset-0 overflow-hidden"},l={class:"absolute inset-0"},d={class:"max-w-12xl mx-auto relative z-10"},c={key:0,class:"min-h-64"},u={key:1,class:"booking-glass-card rounded-b-3xl overflow-hidden animate-slide-up"},m={class:"booking-card bg-gradient-to-r from-blue-600/25 to-blue-700/25 border-2 border-blue-400/40 p-3 rounded-2xl backdrop-blur-sm hover:shadow-2xl hover:shadow-blue-500/20 transition-all duration-500 group"},b={class:"space-y-1.5"},h={class:"grid grid-cols-1 md:grid-cols-2 gap-1.5"},g={class:"group"},p={class:"relative"},v={key:0,class:"text-red-400 text-base mt-1 flex items-center"},f={class:"group"},y={class:"relative"},k={key:0,class:"text-red-400 text-sm mt-1 flex items-center"},x={class:"grid grid-cols-1 md:grid-cols-2 gap-1.5"},w={class:"group"},D={class:"mt-1 max-h-40 overflow-y-auto bg-blue-900/60 border border-blue-400/60 rounded-xl p-2 space-y-1"},_=["value","disabled"],L={class:"flex-1"},I={key:0,class:"text-green-300"},q={key:1,class:"text-orange-300"},T={key:0,class:"text-red-400 text-sm mt-1 flex items-center"},S={class:"group"},R={class:"relative"},C={value:"",class:"bg-blue-800 text-blue-300"},A=["value","selected"],P={key:0,class:"text-red-400 text-sm mt-1 flex items-center"},N={key:0,class:"mt-4 p-4 bg-gradient-to-r from-yellow-500/20 to-orange-500/20 border-2 border-yellow-400/40 rounded-xl backdrop-blur-sm animate-slide-down"},E={class:"flex items-start space-x-3"},B={class:"flex-1"},j={class:"text-base text-yellow-200 leading-relaxed"},F={key:1,class:"group animate-slide-down"},U={class:"relative"},M=["required"],W={key:0,class:"text-red-400 text-sm mt-1 flex items-center"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-1.5"},X={class:"group"},$={class:"relative"},z={key:0,class:"text-red-400 text-base mt-1 flex items-center"},V={class:"group"},Q={class:"relative"},H=["min"],K={key:0,class:"text-red-400 text-base mt-1 flex items-center"},Y={class:"grid grid-cols-1 lg:grid-cols-2 gap-1.5"},J={class:"group"},G={class:"flex flex-col gap-2 items-start w-full"},Z={class:"w-full p-3 border-2 border-blue-300/30 rounded-lg bg-blue-100/10 backdrop-blur-sm"},ee={class:"flex items-center justify-between"},te={class:"flex items-center gap-2"},ae={class:"text-blue-100"},re=["disabled"],se={key:0,class:"mt-2 text-blue-200 text-sm"},oe={class:"list-disc ml-5 mt-1"},ie={key:0,class:"text-red-500 text-base mt-1 flex items-center"},ne={class:"group"},le={class:"relative"},de={key:0,class:"text-red-400 text-sm mt-1 flex items-center"},ce={class:"flex justify-between items-center mt-0.5"},ue={class:"border-t border-blue-300/20 pt-3"},me={class:"flex justify-between items-center"},be=["disabled"],he={key:0,class:"fas fa-paper-plane mr-2"},ge={key:1,class:"fas fa-spinner fa-spin mr-2"},pe={key:0,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in"},ve={class:"bg-gradient-to-br from-white via-blue-50/50 to-blue-100/30 rounded-3xl shadow-2xl max-w-lg w-full transform transition-all duration-500 scale-100 animate-modal-bounce border-2 border-blue-200/50 backdrop-blur-lg"},fe={class:"px-8 pb-6"},ye={class:"bg-gradient-to-r from-blue-50 to-blue-100/50 rounded-2xl p-6 mb-6 border border-blue-200/50 shadow-inner animate-slide-up",style:{"animation-delay":"0.4s"}},ke={class:"space-y-4"},xe={class:"flex items-center p-3 bg-white/60 rounded-xl border border-blue-200/30 hover:bg-white/80 transition-all duration-300 group"},we={class:"flex-1"},De={class:"text-base font-bold text-gray-800"},_e={class:"flex items-center p-3 bg-white/60 rounded-xl border border-blue-200/30 hover:bg-white/80 transition-all duration-300 group"},Le={class:"flex-1"},Ie={class:"text-base font-bold text-gray-800"},qe={class:"flex items-center p-3 bg-white/60 rounded-xl border border-blue-200/30 hover:bg-white/80 transition-all duration-300 group"},Te={class:"flex-1"},Se={class:"text-base font-bold text-gray-800"},Re={key:1,class:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in"},Ce={class:"bg-gradient-to-br from-white via-orange-50/50 to-orange-100/30 rounded-3xl shadow-2xl max-w-lg w-full transform transition-all duration-500 scale-100 animate-modal-bounce border-2 border-orange-200/50 backdrop-blur-lg"},Ae={key:0,class:"px-8 pb-6"},Pe={class:"bg-gradient-to-r from-orange-50 to-orange-100/50 rounded-2xl p-6 mb-6 border border-orange-200/50 shadow-inner animate-slide-up",style:{"animation-delay":"0.4s"}},Ne={class:"space-y-4"},Ee={class:"flex items-center p-3 bg-white/60 rounded-xl border border-orange-200/30 hover:bg-white/80 transition-all duration-300 group"},Be={class:"flex-1"},je={class:"text-base font-bold text-gray-800"},Fe={class:"flex items-center p-3 bg-white/60 rounded-xl border border-orange-200/30 hover:bg-white/80 transition-all duration-300 group"},Ue={class:"flex-1"},Me={class:"text-base font-bold text-gray-800"},We={class:"flex items-center p-3 bg-white/60 rounded-xl border border-orange-200/30 hover:bg-white/80 transition-all duration-300 group"},Oe={class:"flex-1"},Xe={class:"text-base font-bold text-gray-800 capitalize"},$e={class:"flex gap-3"};function ze(e,t,a,ze,Ve,Qe){const He=(0,r.g2)("AppHeader"),Ke=(0,r.g2)("ModernSidebar"),Ye=(0,r.g2)("UnifiedLoadingBanner"),Je=(0,r.g2)("AppFooter");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.bF)(He),(0,r.Lk)("div",o,[(0,r.bF)(Ke),(0,r.Lk)("main",i,[(0,r.bF)(Ye,{show:Qe.globalLoading,loadingTitle:Qe.loadingBannerTitle,loadingSubtitle:Qe.loadingBannerSubtitle,departmentTitle:"ICT EQUIPMENT BOOKING SYSTEM",forceSpin:!0},null,8,["show","loadingTitle","loadingSubtitle"]),(0,r.Lk)("div",n,[(0,r.Lk)("div",l,[((0,r.uX)(),(0,r.CE)(r.FK,null,(0,r.pI)(10,e=>(0,r.Lk)("div",{key:e,class:"absolute text-white opacity-5 animate-float",style:(0,r.Tr)({left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:3*Math.random()+"s",animationDuration:3*Math.random()+2+"s",fontSize:15*Math.random()+8+"px"})},[(0,r.Lk)("i",{class:(0,r.C4)(["fas",["fa-laptop","fa-tv","fa-desktop","fa-keyboard","fa-mouse","fa-headphones"][Math.floor(6*Math.random())]])},null,2)],4)),64))])]),(0,r.Lk)("div",d,[t[56]||(t[56]=(0,r.Fv)('<div class="booking-glass-card rounded-t-3xl p-4 mb-0 border-b border-blue-300/30 animate-fade-in" data-v-4b217841><div class="flex justify-between items-center" data-v-4b217841><div class="w-16 h-16 mr-4 transform hover:scale-110 transition-transform duration-300" data-v-4b217841><div class="w-full h-full bg-gradient-to-br from-blue-500/20 to-teal-500/20 rounded-2xl backdrop-blur-sm border-2 border-blue-300/40 flex items-center justify-center shadow-2xl hover:shadow-blue-500/25" data-v-4b217841><img src="/assets/images/ngao2.png" alt="National Shield" class="max-w-12 max-h-12 object-contain" data-v-4b217841></div></div><div class="text-center flex-1" data-v-4b217841><h1 class="text-3xl font-bold text-white mb-2 tracking-wide drop-shadow-lg animate-fade-in" data-v-4b217841> MUHIMBILI NATIONAL HOSPITAL </h1><div class="relative inline-block mb-2" data-v-4b217841><div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-2 rounded-full text-lg font-bold shadow-2xl transform hover:scale-105 transition-all duration-300 border-2 border-blue-400/60" data-v-4b217841><span class="relative z-10 flex items-center gap-2" data-v-4b217841><i class="fas fa-calendar-check" data-v-4b217841></i> DEVICE BOOKING SERVICE </span><div class="absolute inset-0 bg-gradient-to-r from-blue-700 to-blue-800 rounded-full opacity-0 hover:opacity-100 transition-opacity duration-300" data-v-4b217841></div></div></div><h2 class="text-xl font-bold text-blue-100 tracking-wide drop-shadow-md animate-fade-in-delay" data-v-4b217841> ICT EQUIPMENT RESERVATION SYSTEM </h2></div><div class="w-16 h-16 ml-4 transform hover:scale-110 transition-transform duration-300" data-v-4b217841><div class="w-full h-full bg-gradient-to-br from-teal-500/20 to-blue-500/20 rounded-2xl backdrop-blur-sm border-2 border-teal-300/40 flex items-center justify-center shadow-2xl hover:shadow-teal-500/25" data-v-4b217841><img src="/assets/images/logo2.png" alt="Muhimbili Logo" class="max-w-12 max-h-12 object-contain" data-v-4b217841></div></div></div></div>',1)),Ve.isCheckingPendingRequests?((0,r.uX)(),(0,r.CE)("div",c)):Ve.hasPendingRequest?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("form",{onSubmit:t[17]||(t[17]=(0,r.D$)((...e)=>Qe.submitBooking&&Qe.submitBooking(...e),["prevent"])),class:"p-3 space-y-3"},[(0,r.Lk)("div",m,[t[54]||(t[54]=(0,r.Fv)('<div class="flex items-center space-x-3 mb-2" data-v-4b217841><div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300 border border-blue-300/50" data-v-4b217841><i class="fas fa-calendar-alt text-white text-lg" data-v-4b217841></i></div><h3 class="text-2xl font-bold text-white flex items-center" data-v-4b217841><i class="fas fa-info-circle mr-2 text-blue-300" data-v-4b217841></i> Booking Information </h3></div>',1)),(0,r.Lk)("div",b,[(0,r.Lk)("div",h,[(0,r.Lk)("div",g,[t[24]||(t[24]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-user mr-2 text-blue-300"}),(0,r.eW)(" Name of Borrower "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",p,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>Ve.formData.borrowerName=e),type:"text",readonly:"",class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white text-lg placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50 cursor-not-allowed opacity-90",placeholder:"Auto-populated from your account",title:"This field is automatically filled with your account name",required:""},null,512),[[r.Jo,Ve.formData.borrowerName]]),t[21]||(t[21]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1)),t[22]||(t[22]=(0,r.Lk)("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-300/50"},[(0,r.Lk)("i",{class:"fas fa-lock",title:"Auto-populated from your account"})],-1))]),Ve.errors.borrowerName?((0,r.uX)(),(0,r.CE)("div",v,[t[23]||(t[23]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.borrowerName),1)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",f,[t[27]||(t[27]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-calendar mr-2 text-blue-300"}),(0,r.eW)(" Booking Date "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",y,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>Ve.formData.bookingDate=e),onInput:t[2]||(t[2]=(...e)=>Qe.validateBookingDate&&Qe.validateBookingDate(...e)),onChange:t[3]||(t[3]=(...e)=>Qe.validateBookingDate&&Qe.validateBookingDate(...e)),type:"date",class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white text-lg backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50",required:""},null,544),[[r.Jo,Ve.formData.bookingDate]]),t[25]||(t[25]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))]),Ve.errors.bookingDate?((0,r.uX)(),(0,r.CE)("div",k,[t[26]||(t[26]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.bookingDate),1)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",x,[(0,r.Lk)("div",w,[t[29]||(t[29]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-laptop mr-2 text-blue-300"}),(0,r.eW)(" Type of Device Borrowed "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",D,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Ve.availableDevices,e=>((0,r.uX)(),(0,r.CE)("label",{key:"chk-"+e.id,class:"flex items-center space-x-2 text-sm text-blue-100"},[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",value:String(e.id),"onUpdate:modelValue":t[4]||(t[4]=e=>Ve.formData.deviceInventoryIds=e),onChange:t[5]||(t[5]=(...e)=>Qe.handleDeviceTypeChange&&Qe.handleDeviceTypeChange(...e)),disabled:Ve.isLoadingDevices,class:"h-4 w-4 text-blue-500 rounded border-blue-300 bg-blue-900/60 focus:ring-blue-400"},null,40,_),[[r.lH,Ve.formData.deviceInventoryIds]]),(0,r.Lk)("span",L,[(0,r.eW)((0,r.v_)(e.device_name)+" ",1),e.available_quantity>0?((0,r.uX)(),(0,r.CE)("span",I," - "+(0,r.v_)(e.available_quantity)+" available ",1)):((0,r.uX)(),(0,r.CE)("span",q," - Out of Stock (Can still request) "))])]))),128))]),Ve.errors.deviceType?((0,r.uX)(),(0,r.CE)("div",T,[t[28]||(t[28]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.deviceType),1)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",S,[t[33]||(t[33]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-building mr-2 text-blue-300"}),(0,r.eW)(" Department "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",R,[(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>Ve.formData.department=e),readonly:"",disabled:"",class:"w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white text-lg backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50 cursor-not-allowed opacity-90 appearance-none",required:""},[(0,r.Lk)("option",C,(0,r.v_)(Ve.formData.department?"":"Auto-populated from your account"),1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Ve.departments,e=>((0,r.uX)(),(0,r.CE)("option",{key:e.id,value:e.id,class:"bg-blue-800 text-white",selected:Ve.formData.department==e.id},(0,r.v_)(e.name),9,A))),128))],512),[[r.u1,Ve.formData.department]]),t[30]||(t[30]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1)),t[31]||(t[31]=(0,r.Lk)("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-300/50"},[(0,r.Lk)("i",{class:"fas fa-lock",title:"Auto-populated from your account"})],-1))]),Ve.errors.department?((0,r.uX)(),(0,r.CE)("div",P,[t[32]||(t[32]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.department),1)])):(0,r.Q3)("",!0)])]),Ve.showAvailabilityWarning&&Ve.deviceAvailabilityInfo?((0,r.uX)(),(0,r.CE)("div",N,[(0,r.Lk)("div",E,[t[36]||(t[36]=(0,r.Lk)("div",{class:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-lg flex items-center justify-center shadow-lg flex-shrink-0"},[(0,r.Lk)("i",{class:"fas fa-exclamation-triangle text-white text-sm"})],-1)),(0,r.Lk)("div",B,[t[34]||(t[34]=(0,r.Lk)("h4",{class:"text-base font-bold text-yellow-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-info-circle mr-2"}),(0,r.eW)(" Device Availability Notice ")],-1)),(0,r.Lk)("p",j,(0,r.v_)(Ve.deviceAvailabilityInfo.message),1),t[35]||(t[35]=(0,r.Lk)("p",{class:"text-sm text-yellow-300/80 mt-2 italic"},[(0,r.Lk)("i",{class:"fas fa-lightbulb mr-1"}),(0,r.eW)(" You can still submit your request, and it will be processed when the device becomes available. ")],-1))])])])):(0,r.Q3)("",!0),Ve.showCustomDeviceField?((0,r.uX)(),(0,r.CE)("div",F,[t[39]||(t[39]=(0,r.Lk)("label",{class:"block text-lg font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-edit mr-2 text-blue-300"}),(0,r.eW)(" Specify Device "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",U,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>Ve.formData.customDevice=e),onInput:t[8]||(t[8]=(...e)=>Qe.validateCustomDevice&&Qe.validateCustomDevice(...e)),type:"text",class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white text-lg placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50",placeholder:"Please specify the device you want to borrow",required:"others"===Ve.formData.deviceInventoryId},null,40,M),[[r.Jo,Ve.formData.customDevice]]),t[37]||(t[37]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))]),Ve.errors.customDevice?((0,r.uX)(),(0,r.CE)("div",W,[t[38]||(t[38]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.customDevice),1)])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),(0,r.Lk)("div",O,[(0,r.Lk)("div",X,[t[43]||(t[43]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-phone mr-2 text-blue-300"}),(0,r.eW)(" Phone Number "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",$,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>Ve.formData.phoneNumber=e),type:"tel",readonly:"",class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50 cursor-not-allowed opacity-90",placeholder:"Auto-populated from your account",title:"This field is automatically filled with your account phone number",required:""},null,512),[[r.Jo,Ve.formData.phoneNumber]]),t[40]||(t[40]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1)),t[41]||(t[41]=(0,r.Lk)("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-blue-300/50"},[(0,r.Lk)("i",{class:"fas fa-lock",title:"Auto-populated from your account"})],-1))]),Ve.errors.phoneNumber?((0,r.uX)(),(0,r.CE)("div",z,[t[42]||(t[42]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.phoneNumber),1)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",V,[t[46]||(t[46]=(0,r.Lk)("label",{class:"block text-lg font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-calendar-plus mr-2 text-blue-300"}),(0,r.eW)(" Date of returning "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",Q,[(0,r.bo)((0,r.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>Qe.returnDateTimeModel=e),onInput:t[11]||(t[11]=(...e)=>Qe.validateReturnDateTime&&Qe.validateReturnDateTime(...e)),onChange:t[12]||(t[12]=(...e)=>Qe.validateReturnDateTime&&Qe.validateReturnDateTime(...e)),type:"datetime-local",min:Qe.minReturnDateTime,class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white text-lg backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50",required:""},null,40,H),[[r.Jo,Qe.returnDateTimeModel]]),t[44]||(t[44]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))]),Ve.errors.collectionDate||Ve.errors.returnTime?((0,r.uX)(),(0,r.CE)("div",K,[t[45]||(t[45]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.collectionDate||Ve.errors.returnTime),1)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Y,[(0,r.Lk)("div",J,[t[49]||(t[49]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-signature mr-2 text-blue-300"}),(0,r.eW)(" Signature "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*"),(0,r.Lk)("span",{class:"ml-2 text-base text-blue-300/70 font-normal"},"Digital")],-1)),(0,r.Lk)("div",G,[(0,r.Lk)("div",Z,[(0,r.Lk)("div",ee,[(0,r.Lk)("div",te,[(0,r.Lk)("i",{class:(0,r.C4)(Ve.hasUserSigned?"fas fa-check-circle text-green-400":"fas fa-exclamation-circle text-yellow-300")},null,2),(0,r.Lk)("span",ae,(0,r.v_)(Ve.hasUserSigned?"You have signed this document":"You have not signed yet"),1)]),(0,r.Lk)("button",{type:"button",onClick:t[13]||(t[13]=(...e)=>Qe.signDocument&&Qe.signDocument(...e)),disabled:Ve.hasUserSigned||Ve.isSubmitting,class:"inline-flex items-center px-3 py-1.5 bg-gradient-to-r from-green-500 to-green-600 text-white text-sm font-medium rounded-lg hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:scale-105 border border-blue-400/30"},[(0,r.Lk)("i",{class:(0,r.C4)(Ve.hasUserSigned?"fas fa-check mr-1":"fas fa-pen-fancy mr-1")},null,2),(0,r.eW)(" "+(0,r.v_)(Ve.hasUserSigned?"Signed":"Sign Document"),1)],8,re)]),Ve.signatures.length?((0,r.uX)(),(0,r.CE)("div",se,[t[47]||(t[47]=(0,r.Lk)("span",{class:"opacity-75"},"Signatures:",-1)),(0,r.Lk)("ul",oe,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(Ve.signatures,e=>((0,r.uX)(),(0,r.CE)("li",{key:e.id},(0,r.v_)(e.user_name)+" ‚Äî "+(0,r.v_)(e.signed_at),1))),128))])])):(0,r.Q3)("",!0)]),Ve.errors.digital_signature?((0,r.uX)(),(0,r.CE)("div",ie,[t[48]||(t[48]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.digital_signature),1)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",ne,[t[53]||(t[53]=(0,r.Lk)("label",{class:"block text-xl font-bold text-blue-100 mb-1 flex items-center"},[(0,r.Lk)("i",{class:"fas fa-comment-alt mr-2 text-blue-300"}),(0,r.eW)(" Reason for Borrowing "),(0,r.Lk)("span",{class:"text-red-400 ml-1"},"*")],-1)),(0,r.Lk)("div",le,[(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":t[14]||(t[14]=e=>Ve.formData.reason=e),onInput:t[15]||(t[15]=(...e)=>Qe.handleReasonInput&&Qe.handleReasonInput(...e)),class:"booking-input w-full px-3 py-2 bg-white/15 border-2 border-blue-300/30 rounded-xl focus:border-blue-400 focus:outline-none text-white placeholder-blue-200/60 backdrop-blur-sm transition-all duration-300 hover:bg-white/20 focus:bg-white/20 focus:shadow-lg focus:shadow-blue-500/20 group-hover:border-blue-400/50 resize-none",rows:"2",placeholder:"Explain reason for borrowing... (min 10 chars)",maxlength:"1000",required:""},null,544),[[r.Jo,Ve.formData.reason]]),t[50]||(t[50]=(0,r.Lk)("div",{class:"absolute inset-0 rounded-xl bg-gradient-to-r from-blue-500/10 to-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"},null,-1))]),Ve.errors.reason?((0,r.uX)(),(0,r.CE)("div",de,[t[51]||(t[51]=(0,r.Lk)("i",{class:"fas fa-exclamation-circle mr-1"},null,-1)),(0,r.eW)(" "+(0,r.v_)(Ve.errors.reason),1)])):(0,r.Q3)("",!0),(0,r.Lk)("div",ce,[t[52]||(t[52]=(0,r.Lk)("p",{class:"text-base text-blue-200/60 italic"},"Min 10 chars",-1)),(0,r.Lk)("p",{class:(0,r.C4)(["text-base",Ve.formData.reason.length>=10?"text-green-400":"text-yellow-400"])},(0,r.v_)(Ve.formData.reason.length)+"/1000 ",3)])])])])]),(0,r.Lk)("div",ue,[(0,r.Lk)("div",me,[(0,r.Lk)("button",{type:"button",onClick:t[16]||(t[16]=(...e)=>Qe.goBack&&Qe.goBack(...e)),class:"px-4 py-2 bg-gray-600/80 text-white rounded-xl hover:bg-gray-700/80 transition-all duration-300 font-semibold flex items-center shadow-lg hover:shadow-xl transform hover:scale-105 backdrop-blur-sm border border-gray-500/50"},[...t[55]||(t[55]=[(0,r.Lk)("i",{class:"fas fa-arrow-left mr-2"},null,-1),(0,r.eW)(" Back to Dashboard ",-1)])]),(0,r.Lk)("button",{type:"submit",disabled:Ve.isSubmitting,class:"px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold flex items-center shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none border border-blue-400/50"},[Ve.isSubmitting?((0,r.uX)(),(0,r.CE)("i",ge)):((0,r.uX)(),(0,r.CE)("i",he)),(0,r.eW)(" "+(0,r.v_)(Ve.isSubmitting?"Submitting Booking...":"Submit Booking Request"),1)],8,be)])])],32),(0,r.bF)(Je)]))])])]),Ve.showSuccessModal?((0,r.uX)(),(0,r.CE)("div",pe,[(0,r.Lk)("div",ve,[t[66]||(t[66]=(0,r.Fv)('<div class="relative overflow-hidden rounded-t-3xl" data-v-4b217841><div class="absolute inset-0 bg-gradient-to-r from-blue-500/10 via-blue-600/5 to-blue-500/10 animate-pulse" data-v-4b217841></div><div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-blue-400/20 to-transparent rounded-full blur-2xl animate-float" data-v-4b217841></div><div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-blue-300/15 to-transparent rounded-full blur-xl animate-float" style="animation-delay:1s;" data-v-4b217841></div><div class="relative z-10 p-8 text-center" data-v-4b217841><div class="relative mx-auto mb-6" data-v-4b217841><div class="w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto shadow-2xl animate-bounce-gentle border-4 border-white/50" data-v-4b217841><i class="fas fa-check text-white text-3xl animate-check-mark" data-v-4b217841></i></div><div class="absolute inset-0 w-20 h-20 border-4 border-blue-400/30 rounded-full animate-ping" data-v-4b217841></div><div class="absolute inset-0 w-20 h-20 border-2 border-blue-300/50 rounded-full animate-pulse" data-v-4b217841></div></div><h3 class="text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-3 animate-slide-up" data-v-4b217841> üéâ Booking Submitted Successfully! </h3><p class="text-lg text-gray-600 mb-6 leading-relaxed animate-slide-up" style="animation-delay:0.2s;" data-v-4b217841> Your device booking request has been submitted and is now under review by our ICT team. </p></div></div>',1)),(0,r.Lk)("div",fe,[(0,r.Lk)("div",ye,[t[63]||(t[63]=(0,r.Lk)("div",{class:"flex items-center justify-center mb-4"},[(0,r.Lk)("div",{class:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-3 shadow-lg"},[(0,r.Lk)("i",{class:"fas fa-clipboard-list text-white text-sm"})]),(0,r.Lk)("h4",{class:"text-xl font-bold text-blue-800"},"üìã Booking Details")],-1)),(0,r.Lk)("div",ke,[(0,r.Lk)("div",xe,[t[58]||(t[58]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-laptop text-white text-sm"})],-1)),(0,r.Lk)("div",we,[t[57]||(t[57]=(0,r.Lk)("p",{class:"text-sm font-medium text-blue-600 uppercase tracking-wide"},"Device",-1)),(0,r.Lk)("p",De,(0,r.v_)(Qe.getDeviceDisplayName()),1)])]),(0,r.Lk)("div",_e,[t[60]||(t[60]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-user text-white text-sm"})],-1)),(0,r.Lk)("div",Le,[t[59]||(t[59]=(0,r.Lk)("p",{class:"text-sm font-medium text-blue-600 uppercase tracking-wide"},"Borrower",-1)),(0,r.Lk)("p",Ie,(0,r.v_)(Ve.formData.borrowerName),1)])]),(0,r.Lk)("div",qe,[t[62]||(t[62]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-calendar-check text-white text-sm"})],-1)),(0,r.Lk)("div",Te,[t[61]||(t[61]=(0,r.Lk)("p",{class:"text-sm font-medium text-blue-600 uppercase tracking-wide"}," Return Date ",-1)),(0,r.Lk)("p",Se,(0,r.v_)(Qe.formatDisplayDate(Ve.formData.collectionDate)),1)])])]),t[64]||(t[64]=(0,r.Lk)("div",{class:"mt-4 text-center"},[(0,r.Lk)("span",{class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-yellow-400 to-orange-500 text-white text-base font-bold rounded-full shadow-lg animate-pulse"},[(0,r.Lk)("i",{class:"fas fa-clock mr-2"}),(0,r.eW)(" PENDING REVIEW ")])],-1))]),(0,r.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>Qe.closeSuccessModal&&Qe.closeSuccessModal(...e)),class:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white py-4 px-6 rounded-2xl font-bold text-xl shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-blue-300/50 animate-slide-up border-2 border-blue-500/30",style:{"animation-delay":"0.6s"}},[...t[65]||(t[65]=[(0,r.Lk)("i",{class:"fas fa-home mr-3 text-lg"},null,-1),(0,r.eW)(" Return to Dashboard ",-1)])])]),t[67]||(t[67]=(0,r.Lk)("div",{class:"absolute top-4 right-4 text-blue-300/30 animate-spin-slow"},[(0,r.Lk)("i",{class:"fas fa-cog text-2xl"})],-1)),t[68]||(t[68]=(0,r.Lk)("div",{class:"absolute bottom-4 left-4 text-green-300/30 animate-bounce",style:{"animation-delay":"2s"}},[(0,r.Lk)("i",{class:"fas fa-check-circle text-xl"})],-1))])])):(0,r.Q3)("",!0),Ve.showPendingRequestModal?((0,r.uX)(),(0,r.CE)("div",Re,[(0,r.Lk)("div",Ce,[t[79]||(t[79]=(0,r.Fv)('<div class="relative overflow-hidden rounded-t-3xl" data-v-4b217841><div class="absolute inset-0 bg-gradient-to-r from-orange-500/10 via-yellow-600/5 to-orange-500/10 animate-pulse" data-v-4b217841></div><div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-orange-400/20 to-transparent rounded-full blur-2xl animate-float" data-v-4b217841></div><div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-yellow-300/15 to-transparent rounded-full blur-xl animate-float" style="animation-delay:1s;" data-v-4b217841></div><div class="relative z-10 p-8 text-center" data-v-4b217841><div class="relative mx-auto mb-6" data-v-4b217841><div class="w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center mx-auto shadow-2xl animate-bounce-gentle border-4 border-white/50" data-v-4b217841><i class="fas fa-exclamation-triangle text-white text-3xl animate-check-mark" data-v-4b217841></i></div><div class="absolute inset-0 w-20 h-20 border-4 border-orange-400/30 rounded-full animate-ping" data-v-4b217841></div><div class="absolute inset-0 w-20 h-20 border-2 border-orange-300/50 rounded-full animate-pulse" data-v-4b217841></div></div><h3 class="text-3xl font-bold bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent mb-3 animate-slide-up" data-v-4b217841> ‚ö†Ô∏è Pending Request Found </h3><p class="text-lg text-gray-600 mb-6 leading-relaxed animate-slide-up" style="animation-delay:0.2s;" data-v-4b217841> You already have a pending booking request. Please wait for it to be processed before submitting a new request. </p></div></div>',1)),Ve.pendingRequestInfo?((0,r.uX)(),(0,r.CE)("div",Ae,[(0,r.Lk)("div",Pe,[t[75]||(t[75]=(0,r.Lk)("div",{class:"flex items-center justify-center mb-4"},[(0,r.Lk)("div",{class:"w-8 h-8 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mr-3 shadow-lg"},[(0,r.Lk)("i",{class:"fas fa-clipboard-list text-white text-sm"})]),(0,r.Lk)("h4",{class:"text-xl font-bold text-orange-800"},"üìã Your Pending Request")],-1)),(0,r.Lk)("div",Ne,[(0,r.Lk)("div",Ee,[t[70]||(t[70]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-laptop text-white text-sm"})],-1)),(0,r.Lk)("div",Be,[t[69]||(t[69]=(0,r.Lk)("p",{class:"text-sm font-medium text-orange-600 uppercase tracking-wide"},"Device",-1)),(0,r.Lk)("p",je,(0,r.v_)(Ve.pendingRequestInfo.device_name),1)])]),(0,r.Lk)("div",Fe,[t[72]||(t[72]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-calendar text-white text-sm"})],-1)),(0,r.Lk)("div",Ue,[t[71]||(t[71]=(0,r.Lk)("p",{class:"text-sm font-medium text-orange-600 uppercase tracking-wide"}," Booking Date ",-1)),(0,r.Lk)("p",Me,(0,r.v_)(Qe.formatDisplayDate(Ve.pendingRequestInfo.booking_date)),1)])]),(0,r.Lk)("div",We,[t[74]||(t[74]=(0,r.Lk)("div",{class:"w-10 h-10 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mr-4 shadow-md group-hover:scale-110 transition-transform duration-300"},[(0,r.Lk)("i",{class:"fas fa-clock text-white text-sm"})],-1)),(0,r.Lk)("div",Oe,[t[73]||(t[73]=(0,r.Lk)("p",{class:"text-sm font-medium text-orange-600 uppercase tracking-wide"},"Status",-1)),(0,r.Lk)("p",Xe,(0,r.v_)(Ve.pendingRequestInfo.status)+" / "+(0,r.v_)(Ve.pendingRequestInfo.ict_approve),1)])])]),t[76]||(t[76]=(0,r.Lk)("div",{class:"mt-4 text-center"},[(0,r.Lk)("span",{class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-400 to-yellow-500 text-white text-base font-bold rounded-full shadow-lg animate-pulse"},[(0,r.Lk)("i",{class:"fas fa-hourglass-half mr-2"}),(0,r.eW)(" AWAITING APPROVAL ")])],-1))]),(0,r.Lk)("div",$e,[(0,r.Lk)("button",{onClick:t[19]||(t[19]=(...e)=>Qe.viewPendingRequest&&Qe.viewPendingRequest(...e)),class:"flex-1 bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800 text-white py-4 px-6 rounded-2xl font-bold text-xl shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-orange-300/50 animate-slide-up border-2 border-orange-500/30",style:{"animation-delay":"0.6s"}},[...t[77]||(t[77]=[(0,r.Lk)("i",{class:"fas fa-eye mr-3 text-lg"},null,-1),(0,r.eW)(" View Request ",-1)])]),(0,r.Lk)("button",{onClick:t[20]||(t[20]=(...e)=>Qe.closePendingRequestModal&&Qe.closePendingRequestModal(...e)),class:"flex-1 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-white py-4 px-6 rounded-2xl font-bold text-xl shadow-xl hover:shadow-2xl transform hover:scale-105 transition-all duration-300 focus:outline-none focus:ring-4 focus:ring-gray-300/50 animate-slide-up border-2 border-gray-500/30",style:{"animation-delay":"0.8s"}},[...t[78]||(t[78]=[(0,r.Lk)("i",{class:"fas fa-arrow-left mr-3 text-lg"},null,-1),(0,r.eW)(" Dashboard ",-1)])])])])):(0,r.Q3)("",!0),t[80]||(t[80]=(0,r.Lk)("div",{class:"absolute top-4 right-4 text-orange-300/30 animate-spin-slow"},[(0,r.Lk)("i",{class:"fas fa-cog text-2xl"})],-1)),t[81]||(t[81]=(0,r.Lk)("div",{class:"absolute bottom-4 left-4 text-yellow-300/30 animate-bounce",style:{"animation-delay":"2s"}},[(0,r.Lk)("i",{class:"fas fa-exclamation-circle text-xl"})],-1))])])):(0,r.Q3)("",!0)])}a(4114),a(8111),a(2489),a(116),a(7588);var Ve=a(8966),Qe=a(9101),He=a(6933),Ke=a(1445),Ye=a(6464),Je=a(1035),Ge=(a(1701),a(274));const Ze={async getDeviceBorrowingRequests(e={}){try{const t=await Ge.A.get("/ict-approval/device-requests",{params:{...e,per_page:e.per_page||50}}),a=t.data.data||t.data,r=Array.isArray(a)?a.map(e=>({id:e.id,request_id:e.request_id||`REQ-${e.id.toString().padStart(6,"0")}`,borrower_id:e.user_id||e.borrower_id,borrower_name:e.user?.name||e.borrower_name||e.staff?.name||"Unknown User",borrower_email:e.user?.email||e.borrower_email||e.staff?.email,borrower_phone:e.user?.phone||e.borrower_phone||e.staff?.phone,pf_number:e.user?.pf_number||e.staff?.pf_number,department_id:e.user?.department_id||e.department_id||e.staff?.department_id,department:e.user?.department?.name||e.department||e.staff?.department?.name||"Unknown Department",device_type:e.device_type,custom_device:e.custom_device,device_name:e.device_name||this.getDeviceDisplayName(e.device_type,e.custom_device),device_inventory_id:e.device_inventory_id,device_available:"undefined"!==typeof e.device_available?e.device_available:null,booking_date:e.booking_date,collection_date:e.collection_date,return_date:e.return_date,purpose:e.purpose,signature:e.signature,signature_path:e.signature_path,has_signature:!(!e.signature&&!e.signature_path),status:e.status||"pending",ict_status:e.ict_status||"pending",ict_approval_date:e.ict_approval_date,ict_notes:e.ict_notes,created_at:e.created_at,updated_at:e.updated_at,_raw:e})):[];return{success:!0,data:{data:r,current_page:t.data.current_page||1,last_page:t.data.last_page||1,per_page:t.data.per_page||15,total:t.data.total||r.length}}}catch(t){return console.error("Failed to fetch device borrowing requests:",t),{success:!1,message:t.response?.data?.message||"Failed to fetch device borrowing requests",error:t.message,status:t.response?.status}}},async getDeviceBorrowingRequestDetails(e){try{const t=await Ge.A.get(`/booking-service/bookings/${e}`),a=t.data.data||t.data,r={id:a.id,request_id:a.request_id||`REQ-${a.id.toString().padStart(6,"0")}`,borrower_id:a.user_id,borrower_name:a.borrower_name||"Unknown User",borrower_email:a.user?.email,borrower_phone:a.phone_number,pf_number:a.user?.pf_number,department_id:a.user?.department_id,department:a.departmentInfo?.name||a.department||"Unknown Department",device_type:a.device_type,custom_device:a.custom_device,device_name:this.getDeviceDisplayName(a.device_type,a.custom_device),booking_date:a.booking_date,return_date:a.return_date,return_time:a.return_time,reason:a.reason,signature_path:a.signature_path,signature_url:a.signature_url,has_signature:!!a.signature_path,status:a.status||"pending",ict_status:a.ict_approve||"pending",ict_approval_date:a.ict_approved_at,ict_notes:a.ict_notes,ict_approved_by:a.ict_approved_by_name||a.ictApprovedBy?.name,created_at:a.created_at,updated_at:a.updated_at,_raw:a};return{success:!0,data:r}}catch(t){return console.error("Failed to fetch request details:",t),{success:!1,message:t.response?.data?.message||"Failed to fetch request details",error:t.message,status:t.response?.status}}},async approveDeviceBorrowingRequest(e,t=""){try{const a=await Ge.A.post(`/booking-service/bookings/${e}/ict-approve`,{ict_notes:t});return{success:!0,data:a.data,message:"Device borrowing request approved successfully"}}catch(a){return console.error("Failed to approve request:",a),{success:!1,message:a.response?.data?.message||"Failed to approve request",errors:a.response?.data?.errors||{},status:a.response?.status}}},async rejectDeviceBorrowingRequest(e,t){try{if(!t||""===t.trim())throw new Error("Rejection reason is required");const a=await Ge.A.post(`/booking-service/bookings/${e}/ict-reject`,{ict_notes:t});return{success:!0,data:a.data,message:"Device borrowing request rejected successfully"}}catch(a){return console.error("Failed to reject request:",a),{success:!1,message:a.response?.data?.message||a.message||"Failed to reject request",errors:a.response?.data?.errors||{},status:a.response?.status}}},async getDeviceBorrowingStatistics(){try{const e=await Ge.A.get("/ict-approval/device-requests/statistics"),t=e.data.data||e.data;return{success:!0,data:{pending:t.pending||0,approved:t.approved||0,rejected:t.rejected||0,returned:t.returned||0,compromised:t.compromised||0,total:t.total||0}}}catch(e){return console.error("Failed to fetch statistics:",e),{success:!1,message:e.response?.data?.message||"Failed to fetch statistics",status:e.response?.status}}},async linkUserDetailsToBooking(e,t){try{const a=await Ge.A.post(`/ict-approval/device-requests/${e}/link-user`,{user_id:t,auto_capture:!0});return{success:!0,data:a.data,message:"User details linked to booking request successfully"}}catch(a){return console.error("Failed to link user details:",a),{success:!1,message:a.response?.data?.message||"Failed to link user details",status:a.response?.status}}},getDeviceDisplayName(e,t){if("others"===e||"custom"===e)return t||"Other Device";const a={projector:"Projector",tv_remote:"TV Remote",hdmi_cable:"HDMI Cable",monitor:"Monitor",cpu:"CPU",keyboard:"Keyboard",mouse:"Mouse",pc:"PC",laptop:"Laptop",tablet:"Tablet",headphones:"Headphones",speaker:"Speaker",webcam:"Webcam",printer:"Printer"};return a[e]||(e||"Unknown Device").replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},formatTime(e){if(!e)return"";const t=new Date(e);return t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})},getStatusBadgeClass(e){const t={pending:"bg-yellow-100 text-yellow-800 border border-yellow-200",approved:"bg-green-100 text-green-800 border border-green-200",rejected:"bg-red-100 text-red-800 border border-red-200",returned:"bg-blue-100 text-blue-800 border border-blue-200",compromised:"bg-purple-100 text-purple-800 border border-purple-200"};return t[e]||"bg-gray-100 text-gray-800 border border-gray-200"},getStatusIcon(e){const t={pending:"fas fa-clock",approved:"fas fa-check-circle",rejected:"fas fa-times-circle",returned:"fas fa-undo",compromised:"fas fa-exclamation-triangle"};return t[e]||"fas fa-question-circle"},getStatusText(e){const t={pending:"Pending",approved:"Approved",rejected:"Rejected",returned:"Returned",compromised:"Compromised"};return t[e]||"Unknown"}};var et=Ze,tt=a(1075),at=a(14),rt={name:"BookingService",components:{ModernSidebar:Ve.A,AppFooter:Qe.A,AppHeader:He.A,UnifiedLoadingBanner:Ke.A},setup(){const e=(0,at.useAuthStore)();return{authStore:e}},data(){return{formData:{bookingDate:"",borrowerName:"",deviceInventoryId:"",deviceInventoryIds:[],deviceType:"",customDevice:"",reason:"",department:"",collectionDate:"",returnTime:"",phoneNumber:"",conditionBefore:"",conditionBeforeIssues:"",conditionReturned:"",conditionReturnedIssues:"",status:""},selectedDeviceInfo:null,selectedDevicesCount:0,showCustomDeviceField:!1,errors:{},isSubmitting:!1,showSuccessModal:!1,departments:[],availableDevices:[],isLoadingDevices:!1,deviceAvailabilityInfo:null,showAvailabilityWarning:!1,hasPendingRequest:!1,pendingRequestInfo:null,showPendingRequestModal:!1,isCheckingPendingRequests:!0,signatures:[],hasUserSigned:!1}},async mounted(){try{const e=setTimeout(async()=>{this.isCheckingPendingRequests&&(console.warn("‚ö†Ô∏è Pending requests check taking too long, showing form"),this.isCheckingPendingRequests=!1,this.hasPendingRequest=!1,await this.initializeForm())},1e4);await this.checkPendingRequests(),clearTimeout(e),this.hasPendingRequest||await this.initializeForm()}catch(e){console.error("Error during component initialization:",e),this.isCheckingPendingRequests=!1,this.hasPendingRequest=!1,await this.initializeForm()}},computed:{globalLoading(){return this.isCheckingPendingRequests||this.isSubmitting||this.isLoadingDevices},loadingBannerTitle(){return this.isCheckingPendingRequests?"Checking Your Requests":this.isLoadingDevices?"Loading Devices":this.isSubmitting?"Submitting Booking Request":"Loading"},loadingBannerSubtitle(){return this.isCheckingPendingRequests?"Verifying pending booking requests...":this.isLoadingDevices?"Fetching available devices...":this.isSubmitting?"Please wait while we submit your booking...":"Please wait..."},returnDateTimeModel:{get(){if(!this.formData.collectionDate)return"";const e=(this.formData.returnTime||"17:00").slice(0,5);return`${this.formData.collectionDate}T${e}`},set(e){if(!e)return this.formData.collectionDate="",void(this.formData.returnTime="");const t=String(e).split("T");this.formData.collectionDate=t[0]||"",this.formData.returnTime=(t[1]||"").slice(0,5)}},minReturnDateTime(){const e=(new Date).toISOString().split("T")[0],t=this.formData.bookingDate||e;return`${t}T00:00`}},methods:{async initializeForm(){try{if(await this.loadDepartments(),await this.loadAvailableDevices(),this.populateBorrowerName(),this.populatePhoneNumber(),this.populateDepartment(),this.formData.returnTime,this.formData.returnTime||(this.formData.returnTime="17:00"),!this.formData.collectionDate){const e=(new Date).toISOString().split("T")[0];this.formData.collectionDate=this.formData.bookingDate||e}this.initializeValidation(),await this.loadSignatures()}catch(e){console.error("Error initializing form:",e)}},async checkPendingRequests(){try{this.isCheckingPendingRequests=!0;const t=new AbortController,a=setTimeout(()=>t.abort(),8e3),r=await Ge.A.get("/booking-service/check-pending-requests",{signal:t.signal});if(clearTimeout(a),r.data.success){const t=r.data.pending_request||{},a=!!(t.device_received_at||/returned|completed|closed/i.test(t.return_status||"")||/returned|completed|closed/i.test(t.status||""));if(this.hasPendingRequest=r.data.has_pending_request&&!a,this.hasPendingRequest&&r.data.pending_request){try{const e=r.data.pending_request.id||r.data.pending_request.request_id;if(e){const t=await Ge.A.get(`/booking-service/bookings/${e}`),a=t.data?.data||t.data||{},r=!!(a.device_received_at||/returned|completed|closed/i.test(a.return_status||"")||/returned|completed|closed/i.test(a.status||"")||"number"===typeof a.current_step&&a.current_step>=3);r&&(this.hasPendingRequest=!1,this.showPendingRequestModal=!1)}}catch(e){404===e?.response?.status?(this.hasPendingRequest=!1,this.showPendingRequestModal=!1):console.warn("Pending verification failed (continuing with server flag):",e?.message)}this.hasPendingRequest&&(this.pendingRequestInfo=r.data.pending_request,this.showPendingRequestModal=!0,r.data.pending_request)}else this.hasPendingRequest=!1}else console.error("Failed to check pending requests:",r.data.message),this.hasPendingRequest=!1}catch(t){if(console.error("Error checking pending requests:",t),"AbortError"===t.name||"ECONNABORTED"===t.code)console.warn("‚ö†Ô∏è Pending requests check timed out - allowing form submission");else{if(401===t.response?.status)return void console.warn("‚ö†Ô∏è Authentication error during pending requests check");console.warn("‚ö†Ô∏è Network error during pending requests check - allowing form submission")}this.hasPendingRequest=!1}finally{this.isCheckingPendingRequests=!1}},viewPendingRequest(){this.pendingRequestInfo&&this.pendingRequestInfo.request_url?this.$router.push(this.pendingRequestInfo.request_url):this.$router.push("/request-status")},closePendingRequestModal(){this.showPendingRequestModal=!1,this.$router.push("/user-dashboard")},normalizePhoneNumber(e){if(!e)return"";let t=String(e).trim().replace(/\s|-/g,"");return t.startsWith("+255")?t:t.startsWith("255")?"+"+t:t.startsWith("0")?"+255"+t.slice(1):t},async checkDeviceAvailability(e){try{const t=await Ge.A.get(`/booking-service/devices/${e}/availability`);t.data.success?(this.deviceAvailabilityInfo=t.data.data,this.showAvailabilityWarning=!t.data.data.available&&t.data.data.can_request,t.data.data):console.error("Failed to check device availability:",t.data.message)}catch(t){console.error("Error checking device availability:",t),this.deviceAvailabilityInfo=null,this.showAvailabilityWarning=!1}},populateBorrowerName(){try{if(this.authStore.isAuthenticated&&this.authStore.user){const e=this.authStore.user.name||this.authStore.userName;if(e&&!this.formData.borrowerName)this.formData.borrowerName=e;else if(!e){console.warn("‚ö†Ô∏è User name not available in auth store");const e=localStorage.getItem("user_data");if(e){const t=JSON.parse(e);t.name&&(this.formData.borrowerName=t.name,t.name)}}}else console.warn("‚ö†Ô∏è User not authenticated or user data not available"),this.$router.push("/login")}catch(e){console.error("‚ùå Error populating borrower name:",e)}},populatePhoneNumber(){try{if(this.authStore.isAuthenticated&&this.authStore.user){const e=this.authStore.user.phone||this.authStore.user.phone_number;if(e&&!this.formData.phoneNumber)this.formData.phoneNumber=this.normalizePhoneNumber(e);else if(!e){const e=localStorage.getItem("user_data");if(e){const t=JSON.parse(e),a=t.phone||t.phone_number;a&&(this.formData.phoneNumber=this.normalizePhoneNumber(a))}}}}catch(e){console.error("‚ùå Error populating phone number:",e)}},populateDepartment(){try{if(this.authStore.isAuthenticated&&this.authStore.user){const t=this.authStore.user.department_id,a=this.authStore.user.department;if(this.formData.department,this.departments.length,t&&!this.formData.department){const e=this.departments.find(e=>e.id==t);e?(this.formData.department=parseInt(t),e.name):console.warn("‚ö†Ô∏è User department ID not found in available departments:",t)}else if(a&&a.id&&!this.formData.department){const e=this.departments.find(e=>e.id==a.id);e?(this.formData.department=parseInt(a.id),a.id,a.name||e.name):console.warn("‚ö†Ô∏è User department object ID not found in available departments:",a.id)}else if(!t&&!a){const t=localStorage.getItem("user_data");if(t)try{const e=JSON.parse(t),a=e.department_id||e.department?.id;if(a){const e=this.departments.find(e=>e.id==a);e?(this.formData.department=parseInt(a),e.name):console.warn("‚ö†Ô∏è Stored department ID not found in available departments:",a)}}catch(e){console.error("‚ùå Error parsing stored user data:",e)}}this.formData.department?(this.errors.department="",this.validateDepartment()):console.warn("‚ö†Ô∏è Could not auto-populate department - user may need to select manually")}else console.warn("‚ö†Ô∏è User not authenticated or user data not available for department population")}catch(t){console.error("‚ùå Error populating department:",t)}},initializeValidation(){this.validateBookingDate(),this.validateDeviceType(),this.validateDepartment(),this.validateReturnDateTime(),this.validateReason()},mapDeviceToType(e){const t=["projector","tv_remote","hdmi_cable","monitor","cpu","keyboard","pc","others"];if(e.device_code&&t.includes(e.device_code.toLowerCase()))return e.device_code,e.device_code.toLowerCase();if(e.device_code){const t=e.device_code.toLowerCase();if("hdmi"===t)return"hdmi_cable"}return this.mapDeviceNameToType(e.device_name)},mapDeviceNameToType(e){const t=e.toLowerCase();return t.includes("projector")?"projector":t.includes("monitor")?"monitor":t.includes("cpu")?"cpu":t.includes("keyboard")?"keyboard":t.includes("pc")||t.includes("computer")?"pc":t.includes("tv")&&t.includes("remote")?"tv_remote":t.includes("hdmi")?"hdmi_cable":t.includes("laptop")||t.includes("notebook")?"pc":t.includes("screen")||t.includes("display")?"monitor":t.includes("remote")&&!t.includes("hdmi")?"tv_remote":t.includes("cable")&&!t.includes("hdmi")?"hdmi_cable":t.includes("tv")||t.includes("television")?"tv_remote":t.includes("desktop")?"pc":t.includes("project")?"projector":(console.warn('Device name not recognized, defaulting to "others" (device_inventory_id will be used by backend):',{deviceName:e,deviceNameLower:t,suggestedFix:"Consider updating the device mapping logic or device_code in inventory"}),"others")},async loadDepartments(){try{const e=await Ye.A.getDepartments();e.success&&e.data&&e.data.data?this.departments=e.data.data:(console.error("Failed to load departments:",e),this.departments=[{id:1,name:"Administration"},{id:2,name:"ICT Department"},{id:3,name:"Finance"},{id:4,name:"Human Resources"},{id:5,name:"Nursing"},{id:6,name:"Laboratory"},{id:7,name:"Radiology"}])}catch(e){console.error("Error loading departments:",e),this.departments=[{id:1,name:"Administration"},{id:2,name:"ICT Department"},{id:3,name:"Finance"},{id:4,name:"Human Resources"},{id:5,name:"Nursing"},{id:6,name:"Laboratory"},{id:7,name:"Radiology"}]}},async loadAvailableDevices(){this.isLoadingDevices=!0;try{console.time("Loading available devices");const e=await Je.A.getAvailableDevices();console.timeEnd("Loading available devices"),e.success&&e.data&&e.data.data?(this.availableDevices=e.data.data,this.availableDevices.length):(console.error("Failed to load available devices:",e),this.availableDevices=[])}catch(e){console.error("Error loading available devices:",e),this.availableDevices=[]}finally{this.isLoadingDevices=!1}},handleDeviceTypeChange(){const e=this.formData.deviceInventoryIds||[],t=Array.isArray(e)?e:[e].filter(Boolean),a=t.filter(e=>"others"!==e),r=t.includes("others");this.selectedDevicesCount=a.length,this.showCustomDeviceField=r;const s=a.length>0?a[0]:r?"others":"";if(this.formData.deviceInventoryId=s,s&&"others"!==s){this.formData.customDevice="";const e=this.availableDevices.find(e=>String(e.id)===String(s));e?(this.selectedDeviceInfo={id:e.id,name:e.device_name,code:e.device_code},this.formData.deviceType=this.mapDeviceToType(e)):(this.formData.deviceType="",this.selectedDeviceInfo=null)}else r?(this.formData.deviceType="others",this.selectedDeviceInfo=null):(this.formData.deviceType="",this.selectedDeviceInfo=null);this.validateDeviceType(),s&&"others"!==s?this.checkDeviceAvailability(s):(this.deviceAvailabilityInfo=null,this.showAvailabilityWarning=!1)},validateDeviceType(){const e=this.formData.deviceInventoryIds||[],t=Array.isArray(e)?e.filter(e=>"others"!==e):this.formData.deviceInventoryId?[this.formData.deviceInventoryId]:[],a=Array.isArray(e)&&e.includes("others"),r=this.formData.deviceInventoryId||(t.length>0?t[0]:a?"others":"");if(r||a)if(r&&"others"!==r&&!this.formData.deviceType)this.errors.deviceType="Device type validation error";else{const e=["projector","tv_remote","hdmi_cable","monitor","cpu","keyboard","pc","others"];if(this.formData.deviceType&&!e.includes(this.formData.deviceType))this.errors.deviceType="Invalid device type selected";else if(this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId){const e=this.availableDevices.find(e=>e.id==this.formData.deviceInventoryId);this.errors.deviceType=e?"":"Selected device not found in inventory"}else this.errors.deviceType=""}else this.errors.deviceType="Device type is required"},handleReturnTimeChange(e){e.target.value,this.formData.returnTime=e.target.value,this.errors.returnTime&&(this.errors.returnTime="")},handleReturnTimeClick(e){e.target.focus()},handleReasonInput(){this.errors.reason&&this.formData.reason.trim().length>=10&&(this.errors.reason=""),this.validateReason()},validateBookingDate(){if(this.formData.bookingDate){const e=(new Date).toISOString().split("T")[0];this.formData.bookingDate<e?this.errors.bookingDate="Booking date cannot be in the past":this.errors.bookingDate=""}else this.errors.bookingDate="Booking date is required"},validateDepartment(){this.formData.department?this.errors.department="":this.errors.department="Department is required"},validateCustomDevice(){"others"===this.formData.deviceInventoryId&&(this.formData.customDevice.trim()?this.errors.customDevice="":this.errors.customDevice="Please specify the device")},validatePhoneNumber(){this.formData.phoneNumber&&this.formData.phoneNumber.trim()?this.errors.phoneNumber="":this.errors.phoneNumber="Phone number not available in your account. Please contact admin to update your profile."},validateReturnDateTime(){if(!this.returnDateTimeModel)return this.errors.collectionDate="Return date and time is required",void(this.errors.returnTime="");this.formData.bookingDate&&this.formData.collectionDate<this.formData.bookingDate?this.errors.collectionDate="Return date cannot be before booking date":this.errors.collectionDate="",this.formData.returnTime?this.errors.returnTime="":this.errors.returnTime="Return time is required"},validateReason(){this.formData.reason.trim()?this.formData.reason.trim().length<10?this.errors.reason="Reason must be at least 10 characters":this.errors.reason="":this.errors.reason="Reason for borrowing is required"},handleConditionBeforeChange(){"something_not_good"!==this.formData.conditionBefore&&(this.formData.conditionBeforeIssues="")},handleConditionReturnedChange(){"compromised"!==this.formData.conditionReturned&&(this.formData.conditionReturnedIssues="")},computeDocumentId(){const e=this.authStore?.user?.id||0;return 91e7+Number(e)},async loadSignatures(){try{const e=this.computeDocumentId(),t=await tt["default"].list(e);this.signatures=Array.isArray(t.data)?t.data:t;const a=this.authStore?.user?.id;this.hasUserSigned=!!(this.signatures||[]).find(e=>e.user_id===a)}catch(e){this.signatures=[],this.hasUserSigned=!1}},async signDocument(){try{const e="booking_service";await tt["default"].sign(e),await this.loadSignatures()}catch(e){alert("Failed to sign document. Please try again.")}},validateForm(){this.errors={},this.formData.bookingDate||(this.errors.bookingDate="Booking date is required"),this.formData.borrowerName.trim()||(this.errors.borrowerName="Borrower name is required");const e=this.formData.deviceInventoryIds||[],t=Array.isArray(e)?e.filter(e=>"others"!==e):this.formData.deviceInventoryId?[this.formData.deviceInventoryId]:[],a=Array.isArray(e)&&e.includes("others");0!==t.length||a||(this.errors.deviceType="Device type is required"),this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId&&!this.formData.deviceType&&(this.errors.deviceType="Device type validation error");const r=["projector","tv_remote","hdmi_cable","monitor","cpu","keyboard","pc","others"];if(this.formData.deviceType&&!r.includes(this.formData.deviceType)&&(this.errors.deviceType="Invalid device type selected"),"others"!==this.formData.deviceInventoryId||this.formData.customDevice.trim()||(this.errors.customDevice="Please specify the device"),this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId){const e=this.availableDevices.find(e=>e.id==this.formData.deviceInventoryId);e||(this.errors.deviceType="Selected device not found in inventory")}this.formData.reason.trim()?this.formData.reason.trim().length<10&&(this.errors.reason="Reason must be at least 10 characters"):this.errors.reason="Reason for borrowing is required",this.formData.department||(this.errors.department="Department is required"),this.returnDateTimeModel||(this.errors.collectionDate="Return date and time is required"),this.formData.returnTime||(this.errors.returnTime="Return time is required"),this.validatePhoneNumber(),this.hasUserSigned||(this.errors.digital_signature="Please sign the document before submitting.");const s=Object.keys(this.errors).filter(e=>this.errors[e]&&this.errors[e].trim());return 0===s.length},async submitBooking(){this.isSubmitting=!0;try{if(!this.validateForm()){const e=Object.keys(this.errors);e.length,this.isSubmitting=!1,this.scrollToFirstError();const t=e.length;return void alert(`Please fill in all required fields. ${t} ${1===t?"field":"fields"} need(s) attention.`)}try{if(await this.checkPendingRequests(),this.hasPendingRequest)return alert("You have a pending booking request. Please wait for it to be processed before submitting a new request."),void(this.isSubmitting=!1)}catch(e){console.warn("‚ö†Ô∏è Could not verify pending requests, proceeding with submission:",e.message)}const t={booking_date:this.formData.bookingDate,borrower_name:this.formData.borrowerName,device_type:this.formData.deviceType,department:this.formData.department,phone_number:this.normalizePhoneNumber(this.formData.phoneNumber),return_date:this.formData.collectionDate,return_time:this.formData.returnTime,reason:this.formData.reason},a=this.formData.deviceInventoryIds||[],r=Array.isArray(a)?a.filter(e=>"others"!==e):this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId?[this.formData.deviceInventoryId]:[],s=Array.isArray(a)&&a.includes("others");this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId?t.device_inventory_id=this.formData.deviceInventoryId:r.length>0&&(t.device_inventory_id=r[0]),r.length>0&&(t.device_inventory_ids=r),s&&this.formData.customDevice&&(t.custom_device=this.formData.customDevice),this.formData.borrowerName,this.formData.deviceType,this.formData.deviceInventoryId,this.formData.department,this.hasUserSigned;const o=await Ye.A.submitBooking(t);if(o.success)o.data,await this.linkUserDetailsToICTApproval(o.data),this.formData.deviceInventoryId,this.selectedDeviceInfo,this.formData.deviceType,o.data.availability_info&&(this.deviceAvailabilityInfo=o.data.availability_info),this.resetForm(),this.$router.push({path:"/request-status",query:{success:"true",type:"Device Booking Request",id:"BOOK-"+Date.now()}});else if(console.error("API Error:",o),o.errors&&Object.keys(o.errors).length>0){this.errors={},Object.keys(o.errors).forEach(e=>{const t=o.errors[e];Array.isArray(t)&&t.length>0&&(this.errors[e]=t[0])});const e=Object.values(o.errors).flat();alert(e[0]||"Validation failed")}else alert(o.message||"Failed to submit booking")}catch(e){console.error("Error in submitBooking:",e),alert("An unexpected error occurred. Please try again.")}finally{this.isSubmitting=!1}},resetForm(){this.formData={bookingDate:"",borrowerName:"",deviceInventoryId:"",deviceInventoryIds:[],deviceType:"",customDevice:"",reason:"",department:"",collectionDate:"",returnTime:"",phoneNumber:"",conditionBefore:"",conditionBeforeIssues:"",conditionReturned:"",conditionReturnedIssues:"",status:""},this.selectedDeviceInfo=null,this.signatures=[],this.hasUserSigned=!1},getDeviceDisplayName(){if(this.selectedDeviceInfo,this.formData.deviceInventoryId,this.formData.deviceType,this.formData.customDevice,this.availableDevices.length,this.selectedDeviceInfo&&this.selectedDeviceInfo.name)return this.selectedDeviceInfo.name,this.selectedDeviceInfo.name;if(this.formData.deviceInventoryId&&"others"!==this.formData.deviceInventoryId){const e=this.availableDevices.find(e=>e.id==this.formData.deviceInventoryId);return e?(e.device_name,e.device_name):(console.warn("Device not found in available devices list:",this.formData.deviceInventoryId),`Device ID: ${this.formData.deviceInventoryId}`)}if("others"===this.formData.deviceInventoryId)return this.formData.customDevice||"Other Device";const e={projector:"Projector",tv_remote:"TV Remote",hdmi_cable:"HDMI Cable",monitor:"Monitor",cpu:"CPU",keyboard:"Keyboard",pc:"PC"};return this.formData.deviceType&&e[this.formData.deviceType]?e[this.formData.deviceType]:(console.warn("Could not determine device name:",{deviceInventoryId:this.formData.deviceInventoryId,deviceType:this.formData.deviceType,customDevice:this.formData.customDevice}),"Unknown Device")},formatDisplayDate(e){if(!e)return"Not specified";try{const t=new Date(e);return t.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(t){return e}},closeSuccessModal(){this.showSuccessModal=!1,this.resetForm(),this.$router.push({path:"/request-status",query:{success:"true",type:"Device Booking Request",id:"BOOK-"+Date.now()}})},goBack(){this.$router.push("/user-dashboard")},async linkUserDetailsToICTApproval(e){try{const t=this.authStore.user?.id||this.authStore.userId;if(!t)return void console.warn("‚ö†Ô∏è User ID not available for auto-capture");const a=e.id||e.booking_id;if(!a)return void console.warn("‚ö†Ô∏è Booking ID not available for auto-capture");this.formData.borrowerName,this.formData.department;const r=await et.linkUserDetailsToBooking(a,t);r.success||console.warn("‚ö†Ô∏è Failed to link user details to ICT approval system:",r.message)}catch(t){console.error("‚ùå Error linking user details to ICT approval system:",t)}},scrollToFirstError(){const e=Object.keys(this.errors)[0];if(e){const t={bookingDate:"bookingDate",borrowerName:"borrowerName",deviceType:"deviceInventoryId",customDevice:"customDevice",reason:"reason",department:"department",collectionDate:"collectionDate",returnTime:"returnTime",phoneNumber:"phoneNumber",signature:"signatureInput"},a=t[e]||e,r=document.querySelector(`[name="${a}"], #${a}, [v-model*="${a}"]`);r&&(r.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{r.focus()},500))}}}},st=a(1241);const ot=(0,st.A)(rt,[["render",ze],["__scopeId","data-v-4b217841"]]);var it=ot}}]);
//# sourceMappingURL=7338.150cafdb.js.map