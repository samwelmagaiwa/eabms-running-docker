{"version":3,"file":"js/5830.d74d6721.js","mappings":"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","sources":["webpack://frontend/./src/composables/useAuth.js","webpack://frontend/./src/components/NotFound.vue","webpack://frontend/./src/components/NotFound.vue?13e4"],"sourcesContent":["import { computed } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { useAuthStore } from '@/stores/auth'\nimport { ROLES, getDefaultDashboard } from '../utils/permissions'\n\n/**\n * Auth composable that provides authentication functionality\n * using Pinia auth store and Vue Router\n */\nexport function useAuth() {\n  const router = useRouter()\n  const authStore = useAuthStore()\n\n  // Computed properties from Pinia store\n  const user = computed(() => authStore.user)\n  const token = computed(() => authStore.token)\n  const isAuthenticated = computed(() => authStore.isAuthenticated)\n  const userPermissions = computed(() => authStore.userPermissions)\n  const userRole = computed(() => authStore.userRole)\n  const userRoles = computed(() => authStore.userRoles)\n  const isLoading = computed(() => authStore.isLoading)\n  const error = computed(() => authStore.error)\n  const isAdmin = computed(() => authStore.isAdmin)\n  const isStaff = computed(() => authStore.isStaff)\n  const isApprover = computed(() => authStore.isApprover)\n  const userName = computed(() => user.value?.name || 'User')\n\n  /**\n   * Login user with credentials\n   * @param {Object} credentials - { email, password }\n   * @returns {Promise<Object>} - Login result\n   */\n  const login = async (credentials) => {\n    try {\n      const { authService } = await import('@/services/authService')\n      const result = await authService.login(credentials)\n\n      if (result.success) {\n        const { user, token } = result.data\n\n        // Set Pinia auth data\n        authStore.setAuthData({ user, token })\n\n        // Determine redirect path\n        let redirectPath = getDefaultDashboard(authStore.userRole) || '/user-dashboard'\n        if (user?.needs_onboarding && authStore.userRole !== 'admin') {\n          redirectPath = '/onboarding'\n        }\n        const redirectTo = router.currentRoute.value.query.redirect\n        if (redirectTo && typeof redirectTo === 'string') {\n          redirectPath = redirectTo\n        }\n\n        await router.push(redirectPath)\n        return { success: true, user }\n      } else {\n        // Handle failed login - prefer specific field errors (e.g. password min length)\n        // then fall back to backend message like \"Invalid email or password.\"\n        let errorMessage = result.message || 'Login failed'\n\n        if (result.errors && typeof result.errors === 'object') {\n          const fieldOrder = ['email', 'password']\n          for (const field of fieldOrder) {\n            const fieldErrors = result.errors[field]\n            if (Array.isArray(fieldErrors) && fieldErrors.length > 0) {\n              errorMessage = fieldErrors[0]\n              break\n            }\n          }\n        }\n\n        console.error('❌ Login failed:', errorMessage)\n        authStore.setError(errorMessage)\n        return {\n          success: false,\n          message: errorMessage\n        }\n      }\n    } catch (error) {\n      console.error('❌ Login error in composable:', error)\n      authStore.setError(error.message || 'Login failed')\n      return {\n        success: false,\n        message: error.message || 'Login failed'\n      }\n    }\n  }\n\n  /**\n   * Logout current user\n   * @returns {Promise<Object>} - Logout result\n   */\n  const logout = async () => {\n    try {\n      const { authService } = await import('@/services/authService')\n      await authService.logout()\n      authStore.clearAuth()\n      await router.push('/login')\n      return { success: true }\n    } catch (error) {\n      authStore.clearAuth()\n      await router.push('/login')\n      return { success: true }\n    }\n  }\n\n  /**\n   * Logout from all sessions\n   * @returns {Promise<Object>} - Logout all result\n   */\n  const logoutAll = async () => {\n    try {\n      const { authService } = await import('@/services/authService')\n      const result = await authService.logoutAll()\n      authStore.clearAuth()\n      await router.push('/login')\n      return result.success ? result : { success: true }\n    } catch (error) {\n      authStore.clearAuth()\n      await router.push('/login')\n      return { success: true }\n    }\n  }\n\n  /**\n   * Update user data\n   * @param {Object} userData - Updated user data\n   */\n  const updateUser = (userData) => {\n    authStore.updateUser(userData)\n  }\n\n  /**\n   * Clear authentication error\n   */\n  const clearError = () => {\n    authStore.clearError()\n  }\n\n  /**\n   * Check if user has specific permission\n   * @param {string} permission - Permission to check\n   * @returns {boolean} - Whether user has permission\n   */\n  const hasPermission = (permission) => {\n    return authStore.hasPermission(permission)\n  }\n\n  /**\n   * Check if user has any of the specified roles\n   * @param {string|Array} roles - Role(s) to check\n   * @returns {boolean} - Whether user has any of the roles\n   */\n  const hasRole = (roles) => {\n    return authStore.hasRole(roles)\n  }\n\n  /**\n   * Check if user can access a specific route\n   * @param {Object} route - Route object with meta.roles\n   * @returns {boolean} - Whether user can access route\n   */\n  const canAccessRoute = (route) => {\n    if (!route.meta?.roles) return true\n    return hasRole(route.meta.roles)\n  }\n\n  /**\n   * Require specific role(s) - throws error if user doesn't have required role\n   * @param {string|Array} requiredRoles - Required role(s)\n   * @throws {Error} - If user doesn't have required role\n   */\n  const requireRole = (requiredRoles) => {\n    if (!hasRole(requiredRoles)) {\n      const roleList = Array.isArray(requiredRoles) ? requiredRoles.join(', ') : requiredRoles\n      throw new Error(`Access denied. Required role(s): ${roleList}`)\n    }\n  }\n\n  /**\n   * Get display name for a role\n   * @param {string} role - Role to get display name for\n   * @returns {string} - Display name for the role\n   */\n  const getRoleDisplayName = (role) => {\n    if (!role) return 'User'\n\n    const roleNames = {\n      [ROLES.ADMIN]: 'Administrator',\n      [ROLES.DIVISIONAL_DIRECTOR]: 'Divisional Director',\n      [ROLES.HEAD_OF_DEPARTMENT]: 'Head of Department',\n      [ROLES.ICT_DIRECTOR]: 'ICT Director',\n      [ROLES.HEAD_OF_IT]: 'Head of IT',\n      [ROLES.STAFF]: 'D. IN MEDICINE',\n      [ROLES.ICT_OFFICER]: 'ICT Officer',\n      [ROLES.SECRETARY_ICT]: 'Secretary ICT'\n    }\n    return roleNames[role] || role\n  }\n\n  return {\n    // State\n    user,\n    userName,\n    token,\n    isAuthenticated,\n    userPermissions,\n    userRole,\n    userRoles,\n    isLoading,\n    error,\n    isAdmin,\n    isStaff,\n    isApprover,\n\n    // Actions\n    login,\n    logout,\n    logoutAll,\n    updateUser,\n    clearError,\n\n    // Utilities\n    hasPermission,\n    hasRole,\n    canAccessRoute,\n    requireRole,\n    getRoleDisplayName,\n\n    // Constants\n    ROLES\n  }\n}\n\nexport default useAuth\n","<template>\n  <div class=\"min-h-screen bg-blue-900 flex items-center justify-center p-4\">\n    <div class=\"w-full max-w-2xl\">\n      <div class=\"bg-blue-800/40 border border-blue-400/40 rounded-2xl p-8 text-center shadow-2xl\">\n        <div class=\"mb-4\">\n          <i class=\"fas fa-exclamation-triangle text-5xl text-yellow-400\"></i>\n        </div>\n        <h1 class=\"text-3xl md:text-4xl font-extrabold text-white mb-2\">Unable to Load Page</h1>\n        <p class=\"text-blue-200 text-base md:text-lg mb-6\">\n          The requested page could not be found. It may have been moved or the URL is incorrect.\n        </p>\n        <div class=\"flex flex-wrap gap-3 justify-center\">\n          <button\n            @click=\"goBack\"\n            class=\"px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-semibold\"\n          >\n            <i class=\"fas fa-undo mr-2\"></i>\n            Retry/Back\n          </button>\n          <button\n            @click=\"goHome\"\n            class=\"px-5 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg font-semibold\"\n          >\n            <i class=\"fas fa-home mr-2\"></i>\n            Back to Dashboard\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { useRouter } from 'vue-router'\n  import { useAuth } from '@/composables/useAuth'\n  import { getDefaultDashboard } from '@/utils/permissions'\n\n  export default {\n    name: 'NotFound',\n    setup() {\n      const router = useRouter()\n      const { userRole } = useAuth()\n\n      const goBack = () => {\n        if (window.history.length > 1) {\n          router.go(-1)\n        } else {\n          goHome()\n        }\n      }\n\n      const goHome = () => {\n        const defaultDashboard = getDefaultDashboard(userRole.value)\n        if (defaultDashboard) {\n          router.push(defaultDashboard)\n        } else {\n          router.push('/')\n        }\n      }\n\n      return {\n        goBack,\n        goHome\n      }\n    }\n  }\n</script>\n","import { render } from \"./NotFound.vue?vue&type=template&id=7c93441e\"\nimport script from \"./NotFound.vue?vue&type=script&lang=js\"\nexport * from \"./NotFound.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["useAuth","router","useRouter","authStore","useAuthStore","user","computed","token","isAuthenticated","userPermissions","userRole","userRoles","isLoading","error","isAdmin","isStaff","isApprover","userName","value","name","login","async","authService","result","credentials","success","data","setAuthData","redirectPath","getDefaultDashboard","needs_onboarding","redirectTo","currentRoute","query","redirect","push","errorMessage","message","errors","fieldOrder","field","fieldErrors","Array","isArray","length","console","setError","logout","clearAuth","logoutAll","updateUser","userData","clearError","hasPermission","permission","hasRole","roles","canAccessRoute","route","meta","requireRole","requiredRoles","roleList","join","Error","getRoleDisplayName","role","roleNames","ROLES","ADMIN","DIVISIONAL_DIRECTOR","HEAD_OF_DEPARTMENT","ICT_DIRECTOR","HEAD_OF_IT","STAFF","ICT_OFFICER","SECRETARY_ICT","class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","onClick","_cache","args","$setup","goBack","goHome","setup","window","history","go","defaultDashboard","__exports__","render"],"sourceRoot":""}